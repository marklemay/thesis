#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\begin_preamble
\usepackage{xcolor}
\usepackage{tikz-cd}
\tikzcdset{%
    triple line/.code={\tikzset{%
        double equal sign distance, % replace by double distance = 'measure' 
        double=\pgfkeysvalueof{/tikz/commutative diagrams/background color}}},
    quadruple line/.code={\tikzset{%
        double equal sign distance, % replace by double distance = 'measure'
        double=\pgfkeysvalueof{/tikz/commutative diagrams/background color}}},
    Rrightarrow/.code={\tikzcdset{triple line}\pgfsetarrows{tikzcd implies cap-tikzcd implies}},
    RRightarrow/.code={\tikzcdset{quadruple line}\pgfsetarrows{tikzcd implies cap-tikzcd implies}}
}    
\newcommand*{\tarrow}[2][]{\arrow[Rrightarrow, #1]{#2}\arrow[dash, shorten >= 0.5pt, #1]{#2}}
\newcommand*{\qarrow}[2][]{\arrow[RRightarrow, #1]{#2}\arrow[equal, double distance = 0.25pt, shorten >= 1.28pt, #1]{#2}}
\end_preamble
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize letterpaper
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 2cm
\topmargin 2cm
\rightmargin 2cm
\bottommargin 2cm
\headheight 2cm
\headsep 2cm
\footskip 2cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 2
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Chapter 2 (draft)
\end_layout

\begin_layout Part
Surface language
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%% TODO notes
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% overview, why
\end_layout

\end_inset


\end_layout

\begin_layout Standard
In an ideal world programmers would write perfect programs whose correctness
 is fully proven.
 The 
\series bold
surface language
\series default
 presented in this chapter allows for this ideal, but difficult, workflow.
 Hopefully and the machinery of later chapters will be transparent to the
 programers that use the full system.
 They should only need to think about the surface language.
 Everything presented in later chapters is designed to reinforce an understandin
g of the surface type system.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% overview, What
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The surface language is a minimal dependent type system.
 It will serve both as foundation for further chapters and a self contained
 technical introduction to dependent types.
 As much as possible, the syntax use's standard modern notation 
\begin_inset Foot
status open

\begin_layout Plain Layout
several alternative syntax exist in the literature.
 In this document the typed polymorphic identity function be written as
 
\begin_inset Formula $\lambda-\,x\Rightarrow x\ :\,\left(X:\star\right)\rightarrow X\rightarrow X$
\end_inset

.
 In 
\begin_inset CommandInset citation
LatexCommand cite
key "10.1016/0890-5401(88)90005-3"
literal "false"

\end_inset

 it might be written 
\begin_inset Formula $\left(\lambda X:\star\right)\left(\lambda x:X\right)x\ :\,\left[X:\star\right]\left[x:X\right]X$
\end_inset


\end_layout

\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout

%TODO , Martin Loff/Hoff (TODO PI notation) 
\end_layout

\end_inset

.
 The semantics are intended to be as simple as possible and compatible with
 other well studied intentional dependent type theories.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% overview, What
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The surface language deviates from a standard dependent type theory to include
 features to ease programming at the expense of logical correctness.
 Specifically the language allows general recursion, since general recursion
 is useful for general purpose functional programming.
 Type-in-type is also supported since it simplifies the system for programmers,
 and makes the meta-theory slightly easier.
 Despite this, type soundness is a achievable and a practical type checking
 algorithm is given.
\end_layout

\begin_layout Standard
Though similar systems have been studied over the last few decades this
 chapter aims to give a self contained presentation, along with many examples.
 The surface language has been an excellent platform to conduct research
 into full spectrum dependent type theory, and hopefully this exposition
 will be helpful introduction for other researchers.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% name the lang
\end_layout

\end_inset


\end_layout

\begin_layout Section
Surface Language Syntax
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% What syntax
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The syntax for the Surface Language is in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:surface-pre-syntax"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The syntax supports: variables, type annotations, a single type universe,
 dependent function types, dependent recursive functions, and function applicati
ons.
 Type annotations are written with two colons to differentiate it from the
 formal typing judgments that will appear more frequently in this text,
 in the implemented language a user of the programming language would use
 a single colon.
 Location data 
\begin_inset Formula $\ensuremath{\ell}$
\end_inset

 is marked at every position where a type error might occur.
 
\end_layout

\begin_layout Standard
There is no destination between types and terms in the syntax
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
terms and types are usually separated, except in the syntax of full-spectrum
 dependent type systems where separating them would require many redundant
 rules
\end_layout

\end_inset

, both are referred to as expressions.
 However, capital metavariables are used in positions that are intended
 as types, and lowercase metavariables are used when an expression is intended
 to be a term, for instance in annotation syntax.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% Metavariables that intend to quantify equivalent terms will be noted with
 primes or subsripts, 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% Metavariables that type other metavairbles will often use the same letter
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: recursive f?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="none" valignment="top" usebox="none" special="l">
\begin_inset Text

\begin_layout Plain Layout
type contexts,
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lozenge$
\end_inset

 | 
\begin_inset Formula $\Gamma,x:M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="none" valignment="top" usebox="none" special="l">
\begin_inset Text

\begin_layout Plain Layout
expressions,
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m,n,M,N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m::_{\ensuremath{\ell}}M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
annotation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
type universe
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:M_{\ensuremath{\ell}}\right)\rightarrow N_{\ensuremath{\ell'}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function type
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m_{\ensuremath{\ell}}\,n$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
application
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Surface Language Syntax
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-pre-syntax"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Several abbreviations are convenient when dealing with a language like this.
 These are listed in 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:surface-pre-syntax-abrev"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="5">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:M\right)\rightarrow N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
written
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $M\rightarrow N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
when 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x\notin fv\left(N\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
written
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda x\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
when 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $f\notin fv\left(m\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $...\,x\Rightarrow\lambda y\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
written
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $...\,x\,y\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
written
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
when 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x\notin fv\left(m\right)$
\end_inset

 when 
\begin_inset Formula $x$
\end_inset

 binds 
\begin_inset Formula $m$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
where 
\begin_inset Formula $fv$
\end_inset

 is a function that returns the set of free variables in an expression
\begin_inset Caption Standard

\begin_layout Plain Layout
Surface Language Abbreviations
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-pre-syntax-abrev"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Examples
\end_layout

\begin_layout Standard
The surface system is extremely expressive.
 Several example surface language constructions can be found in 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:surface-exemples"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 I abuse turnstile notion slightly so that examples can be indexed by other
 expressions that obey type rules.
 For instance, we can say 
\begin_inset Formula $refl_{2_{c}:\mathbb{N}_{c}}\ :\ 2_{c}\doteq_{\mathbb{N}_{c}}2_{c}$
\end_inset

 since 
\begin_inset Formula $\mathbb{N}_{c}:\star$
\end_inset

 and 
\begin_inset Formula $2_{c}:\mathbb{N}_{c}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="22" columns="5">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash\perp_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\left(X:\star\right)\rightarrow X$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Void, 
\begin_inset Quotes eld
\end_inset

empty
\begin_inset Quotes erd
\end_inset

 type, logical false
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash Unit_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\left(X:\star\right)\rightarrow X\rightarrow X$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Unit, logical true
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash tt_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\coloneqq\lambda-\,x\Rightarrow x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:Unit_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
trivial proposition, polymorphic identity
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash\mathbb{B}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\coloneqq\left(X:\star\right)\rightarrow X\rightarrow X\rightarrow X$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
booleans
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash true_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\coloneqq\lambda-\,then\,-\Rightarrow then$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\mathbb{B}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
boolean true
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash false_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\coloneqq\lambda-\,-\,else\Rightarrow else$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\mathbb{B}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
boolean false
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x:\mathbb{B}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash!_{c}x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\coloneqq x\,\mathbb{B}_{c}\,false_{c}\,true_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\mathbb{B}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
boolean not
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x:\mathbb{B}_{c},y:\mathbb{B}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash x\,\&_{c}\,y$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\coloneqq x\,\mathbb{B}_{c}\,y\,false_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\mathbb{B}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
boolean and
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\left(X:\star\right)\rightarrow(X\rightarrow X)\rightarrow X\rightarrow X$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
natural numbers
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash0_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\lambda-\,-\,z\Rightarrow z$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash1_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\lambda-\,s\,z\Rightarrow s\,z$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash2_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\lambda-\,s\,z\Rightarrow s\left(s\,z\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash n_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\lambda-\,s\,z\Rightarrow s^{n}\,z$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x:\mathbb{N}_{c},y:\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash x+_{c}y$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\lambda X\,s\,z\Rightarrow x\,X\,s\,\left(y\,X\,s\,z\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X:\star,Y:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash X\times_{c}Y$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\left(Z:\star\right)\rightarrow(X\rightarrow Y\rightarrow Z)\rightarrow Z$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pair, logical and
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X:\star,Y:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash Either_{c}\,X\,Y$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\left(Z:\star\right)\rightarrow(X\rightarrow Z)\rightarrow(Y\rightarrow Z)\rightarrow Z$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
either, logical or
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash\lnot_{c}X$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq X\rightarrow\perp_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
logical negation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x:\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash Even_{c}\,x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\mathbb{N}_{c}\,\star\,\left(\lambda x\Rightarrow\lnot_{c}x\right)\,Unit_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x$
\end_inset

 is an even number
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X:\star,Y:X\rightarrow\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash\exists_{c}x:X.Y\,x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\left(C:\star\right)\rightarrow\left((x:X)\rightarrow Y\,x\rightarrow C\right)\rightarrow C$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
dependent pair, logical exists
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X:\star,x_{1}:X,x_{2}:X$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash x_{1}\doteq_{X}x_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\left(C:\left(X\rightarrow\star\right)\right)\rightarrow C\,x_{1}\rightarrow C\,x_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Leibniz equality
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X:\star,x:X$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash refl_{x:X}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\lambda-\,cx\Rightarrow cx$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:x\doteq_{X}x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
reflexivity
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X:\star,x_{1}:X,x_{2}:X$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash sym_{x_{1},x_{2}:X}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\lambda p\,C\Rightarrow p\left(\lambda x\Rightarrow C\,x\rightarrow C\,x_{1}\right)\,\left(\lambda x\Rightarrow x\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:x_{1}\doteq_{X}x_{2}\rightarrow x_{2}\doteq_{X}x_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
symmetry
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: suc, pred as an example of an unpleasant encoding, also citation
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: trans, cong
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: list, vec, singleton
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: TODo footnote on Leibniz equality for alt encoding 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: apure abouse of notation allows quantifiaction from function types
 or lambda or a combintation
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Example Surface Language Programs
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-exemples"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Church encodings
\end_layout

\begin_layout Standard
Data types are expressible using Church encodings, (in the style of System
 F).
 Church encodings embed the elimination principle of a data type into continuati
ons
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: not exactly right, not just elimination, recursion is also involved
\end_layout

\end_inset

.
 For instance Boolean data is eliminated against true and false, 2 tags
 with no additional data.
 This can also be recognized as the familiar if-then-else construct.
 So 
\begin_inset Formula $\mathbb{B}_{c}$
\end_inset

 encodes the possibility of choice between 2 elements, 
\begin_inset Formula $true_{c}$
\end_inset

 picks the 
\begin_inset Quotes eld
\end_inset

then
\begin_inset Quotes erd
\end_inset

 branch, and 
\begin_inset Formula $false_{c}$
\end_inset

 picks the 
\begin_inset Quotes eld
\end_inset

else
\begin_inset Quotes erd
\end_inset

 branch.
\end_layout

\begin_layout Standard
Natural numbers
\begin_inset Foot
status open

\begin_layout Plain Layout
called 
\begin_inset Quotes eld
\end_inset

church numerals
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset

 are encodable with 2 tags, 
\begin_inset Formula $0$
\end_inset

 and successor, where successor also contains the result of the preceding
 number.
 So 
\begin_inset Formula $\mathbb{N}_{c}$
\end_inset

 encodes the handling of those two choices, 
\begin_inset Formula $(X\rightarrow X)$
\end_inset

 handles the recursive result of the prior number in the successor case,
 and the 
\begin_inset Formula $X$
\end_inset

 argument specifies how to handle the base case of 
\begin_inset Formula $0$
\end_inset

.
 This can be viewed as a simple looping construct with temporary storage.
\end_layout

\begin_layout Standard
Parameterized data types such as pairs and the 
\begin_inset Formula $Either$
\end_inset

 type can also be encoded in this scheme.
 A pair type can be used in any way the two terms it contains can, so the
 definition states that a pair is at least as good as the curried input
 to a function.
 The 
\begin_inset Formula $Either$
\end_inset

 type is handled if both possibilities are handled, which is exactly expressed
 by it's definition.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: church encoding citation
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% not necisarily convineint
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Church encodings provide a theoretically light weight way of working with
 data in minimal lambda calculus, however they are very inconvenient to
 work with.
 For instance, the predecessor function on natural numbers is not straight
 forward.
 To make the system easier for programmers, data types will be added in
 chapter 4.
\end_layout

\begin_layout Subsection
Predicate encodings
\end_layout

\begin_layout Standard
In general we associate the truth value of a proposition with the inhabitation
 of a type.
 So, 
\begin_inset Formula $\perp_{c}$
\end_inset

, the 
\begin_inset Quotes eld
\end_inset

empty
\begin_inset Quotes erd
\end_inset

 type, can be considered as a false proposition.
 While 
\begin_inset Formula $Unit_{c}$
\end_inset

 can be considered a trivially true logical proposition.
\end_layout

\begin_layout Standard
Several of the church encoded data types we have seen can also be interpreted
 as logical predicates.
 For instance, the tuple type can be considered as logical and, 
\begin_inset Formula $X\times_{c}Y$
\end_inset

 can be inhabited exactly when both 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are inhabited.
 The
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
 
\begin_inset Formula $Either$
\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 type can be considered as logical or, 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit

\begin_inset Formula $Either_{c}\,X\,Y$
\end_inset

 can be inhabited exactly when either 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $X$
\end_inset

 or 
\begin_inset Formula $Y$
\end_inset

 is inhabited.
\end_layout

\begin_layout Standard
With dependent types, more interesting logical predicates can be encoded.
 For instance, we can characterize when a number is Even with 
\begin_inset Formula $Even_{c}\,x$
\end_inset

.
 We can show that 
\begin_inset Formula $2$
\end_inset

 is even by showing that 
\begin_inset Formula $Even_{c}\,2_{c}$
\end_inset

 is inhabited with with the term 
\begin_inset Formula $\lambda s\Rightarrow s\,tt_{c}$
\end_inset

 .
\end_layout

\begin_layout Standard
Other predicates are encodable in the style of Calculus of Constructions
\begin_inset CommandInset citation
LatexCommand cite
key "10.1016/0890-5401(88)90005-3"
literal "false"

\end_inset

 .
 For instance, we can encode the existential as 
\begin_inset Formula $\exists_{c}$
\end_inset

, then if we want to show 
\begin_inset Formula $\exists_{c}x:\mathbb{N}_{c}.\,Even_{c}\,x$
\end_inset

 we need to find a suitable inhabitant of that type.
 
\begin_inset Formula $0$
\end_inset

is clearly an even number, so our inhabitant could be 
\begin_inset Formula $\lambda f\Rightarrow f\,0_{c}\,tt_{c}$
\end_inset

.
 Note that the existential degenerates into the tuple if 
\begin_inset Formula $Y$
\end_inset

 does not depend on the first element.
 
\end_layout

\begin_layout Standard
One of the most potent and interesting propositions is the proposition of
 equality.
 
\begin_inset Formula $\doteq$
\end_inset

 is referred to as Leibniz equality since two terms are equal when they
 behave the same on all 
\begin_inset Quotes eld
\end_inset

observations
\begin_inset Quotes erd
\end_inset


\begin_inset Foot
status collapsed

\begin_layout Plain Layout
The identification of indiscernibles is called 
\begin_inset Quotes eld
\end_inset

Leibniz law
\begin_inset Quotes erd
\end_inset

 in philosophy.
 Leibniz assumed a metaphysical notion of identification of 
\begin_inset Quotes eld
\end_inset

substance
\begin_inset Quotes erd
\end_inset

s, not a mathematical notion of equality.
\end_layout

\end_inset

.
 We can prove 
\begin_inset Formula $\doteq$
\end_inset

 is an equivalence within the system be proving it is reflexive, symmetric,
 and transitive.
 Additionally we can prove congruence.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: 
\begin_inset Quotes eld
\end_inset

Leibniz asserted the identity of indiscernibles: two objects are equal if
 and only if they satisfy the same properties (Leibniz, 1686)
\begin_inset Quotes erd
\end_inset

 https://homepages.inf.ed.ac.uk/wadler/papers/leibniz/leibniz.pdf
\end_layout

\begin_layout Plain Layout

% section 9 ish, sort of asmed tobe true  Leibniz, G.
 (1686) Discourse on metaphysics.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: some simple non reflexive proof, though this is really hard without
 proper induction principles
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Large Eliminations
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: doulbe check large elimination def (write it here)
\end_layout

\begin_layout Plain Layout

% consistent with the notes here: https://github.com/RobertHarper/hott-notes/blob
/5339576f55a4b7f5d04734370a5117491c44b1fe/notes_week5.tex#L155
\end_layout

\begin_layout Plain Layout

% would like better explanaition
\end_layout

\end_inset


\end_layout

\begin_layout Standard
It is useful for a type to depend specifically on a term, this is called
 
\series bold
large elimination
\series default
.
 Large elimination can be simulated with type-in-type.
 
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $toLogic$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\coloneqq\lambda b\Rightarrow b\,\star\,Unit_{c}\,\perp_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbb{B}_{c}\rightarrow\star$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $isPos$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\lambda n\Rightarrow n\,\star\,(\lambda-\Rightarrow Unit_{c})\,\perp_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbb{N}_{c}\rightarrow\star$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
For instance,
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $toLogic$
\end_inset

 can convert a 
\begin_inset Formula $\mathbb{B}_{c}$
\end_inset

 term into it's corresponding logical type, 
\begin_inset Formula $toLogic\,true_{c}\equiv Unit_{c}$
\end_inset

 while 
\begin_inset Formula $toLogic\,false_{c}\equiv\perp_{c}$
\end_inset

 .
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
The expression
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $isPos$
\end_inset

 has similar behavior, going to 
\begin_inset Formula $\perp_{c}$
\end_inset

 at 
\begin_inset Formula $0_{c}$
\end_inset

 and 
\begin_inset Formula $Unit_{c}$
\end_inset

 otherwise.
\end_layout

\begin_layout Standard
Note that such functions are not possible in the Calculus of Constructions.
\end_layout

\begin_layout Subsubsection
Inequalities
\end_layout

\begin_layout Standard
Large eliminations can be used to prove inequalities that can be hard or
 impossible to express in other minimal dependent type theories such as
 the Calculus of Constructions.
 For instance,
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\lambda pr\Rightarrow pr\,\left(\lambda x\Rightarrow x\right)\,\perp_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lnot_{c}\star\doteq_{\star}\perp_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
the type universe is distinct from Logical False
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\lambda pr\Rightarrow pr\,\left(\lambda x\Rightarrow x\right)\,tt_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lnot_{c}Unit_{c}\doteq_{\star}\perp_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Logical True is distinct from Logical False
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda pr\Rightarrow pr\,toLogic\,tt_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lnot true_{c}\doteq_{\mathbb{B}_{c}}false_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
boolean true and false are distinct
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda pr\Rightarrow pr\,isPos\,tt_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lnot1_{c}\doteq_{\mathbb{N}_{c}}0_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 and 0 are distinct
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: 1st not sensible in CC
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: 2 possiblely in CC?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Note that a proof of 
\begin_inset Formula $\lnot1_{c}\doteq_{\mathbb{N}_{c}}0_{c}$
\end_inset

 is not possible in the Calculus of Constructions
\begin_inset CommandInset citation
LatexCommand cite
key "10.2307/2274575"
literal "false"

\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
Martin Hofmann excellently motivates the reasoning in 
\begin_inset CommandInset citation
LatexCommand cite
key "hofmann1997syntax"
literal "false"

\end_inset

Exercises 2.5, 2.6, 3.7, 3.25, 3.26, 3.43, 3.44
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: citation is actually for an MLTT, bleh
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: cite origional and cleaned up in M.
 Hoffman
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Recursion
\end_layout

\begin_layout Standard
Additionally, the syntax of functions builds in unrestricted recursion.
 Though not always necessary, recursion can be very helpful for writing
 programs.
 For instance, here is (an inefficient) function that calculates Fibonacci
 numbers.
\end_layout

\begin_layout Standard
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow case_{c}\,x\,0_{c}\left(\lambda px\Rightarrow case_{c}\,px\,1_{c}\left(\lambda-\Rightarrow f\left(x-_{c}1\right)+_{c}f\left(x-_{c}2\right)\right)\right)$
\end_inset


\end_layout

\begin_layout Standard
Assuming appropriate definitions for 
\begin_inset Formula $case_{c}$
\end_inset

, 
\begin_inset Formula $-_{c}$
\end_inset

.
\end_layout

\begin_layout Standard
Recursion can also be used to simulate induction, and this will be heavily
 relied on when data types are added in chapter 4.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: GCD, recursive types
\end_layout

\end_inset


\end_layout

\begin_layout Section
Surface Language Type Assignment System
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{x:M\in\Gamma}{\Gamma\vdash x\,:\,M}\,\textrm{ty-var}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\Gamma\vdash m\,:\,M}{\Gamma\vdash m::M\,:\,M}\,\textrm{ty-::}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{{\color{gray}\ }}{\Gamma\vdash\star\,:\,\star}\,\textrm{ty-}\star
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\Gamma\vdash M\,:\,\star\quad\Gamma,x:M\vdash N\,:\,\star}{\Gamma\vdash\left(x:M\right)\rightarrow N\,:\,\star}\,\textrm{ty-fun-ty}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\Gamma\vdash m\,:\,\left(x:N\right)\rightarrow M\quad\Gamma\vdash n\,:\,N}{\Gamma\vdash m\,n\,:\,M\left[x\coloneqq n\right]}\,\textrm{ty-fun-app}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m\,:\,M}{\Gamma\vdash\mathsf{fun}\,f\,x\Rightarrow m\,:\,\left(x:N\right)\rightarrow M}\,\textrm{ty-fun}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\Gamma\vdash m\,:\,M\quad M\equiv M'}{\Gamma\vdash m\,:\,M'}\,\textrm{ty-conv}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: Note the location needs explanation
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Surface Language Type Assignment System
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-TAS"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The rules of the type assignment system are listed in 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:surface-TAS"
plural "false"
caps "false"
noprefix "false"

\end_inset


\begin_inset Foot
status collapsed

\begin_layout Plain Layout
There is some question about how much typing information should be coupled
 to the judgment, forcing contexts to be well formed eliminates nonsense
 situation like 
\begin_inset Formula $x:1_{c}\vdash...$
\end_inset

 by construction, but requires more fork when forming judgments that can
 be distracting.
 The proofs in this section can be done without forcing the context to be
 well formed, the additional constraints are omitted.
\end_layout

\end_inset

.
 Variables get their type from the typing context.
 Type annotations reflect a correct typing derivation in the 
\begin_inset Formula $\textrm{ty-::}$
\end_inset

 rule.
 Type-in-type is recognized by the 
\begin_inset Formula $\textrm{ty-}\star$
\end_inset

 rule.
 The 
\begin_inset Formula $\textrm{ty-fun-ty}$
\end_inset

 rule forms dependent function types.
 The 
\begin_inset Formula $\textrm{ty-fun-app}$
\end_inset

 rule shows how to type function application, by substituting the argument
 term directly into the dependent function type.
 Functions are typed with a variable for recursive calls along with a variable
 for their argument 
\begin_inset Formula $\textrm{ty-fun}$
\end_inset

.
 Finally, 
\begin_inset Formula $\textrm{ty-conv}$
\end_inset

 shows which types are 
\series bold
convertible
\series default
 to each other.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% meta-theory type soundness
\end_layout

\end_inset

 From the programming language perspective the most important property of
 a type system is 
\series bold
type soundness
\series default

\begin_inset Foot
status open

\begin_layout Plain Layout
also called 
\begin_inset Quotes eld
\end_inset

type safety
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset

.
 Type soundness is often motivated with the slogan, 
\begin_inset Quotes eld
\end_inset

well typed programs don't get stuck
\begin_inset Quotes erd
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "MILNER1978348"
literal "false"

\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
in Milner's original paper, he used 
\begin_inset Quotes eld
\end_inset

wrong
\begin_inset Quotes erd
\end_inset

 instead of stuck
\end_layout

\end_inset

.
 Given the syntax of the surface language, their is potential for a program
 to 
\begin_inset Quotes eld
\end_inset

get stuck
\begin_inset Quotes erd
\end_inset

 when an argument is applied to a non-function constructor.
 For example, 
\begin_inset Formula $\star\ 1_{c}$
\end_inset

 would be stuck since 
\begin_inset Formula $\star$
\end_inset

 is not a function, so it cannot compute when given the argument 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $1_{c}$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
.
 A good type system will make such unreasonable programs impossible.
\end_layout

\begin_layout Standard
Type soundness can be shown with a progress and preservation
\begin_inset Foot
status open

\begin_layout Plain Layout
also called 
\begin_inset Quotes eld
\end_inset

Subject Reduction
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset

 style proof
\begin_inset CommandInset citation
LatexCommand cite
key "WRIGHT199438"
literal "false"

\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
Though first published in 
\begin_inset CommandInset citation
LatexCommand cite
key "WRIGHT199438"
literal "false"

\end_inset

 their progress lemma is a bit different form modern presentations.
 Most relevant textbooks outline forms of this proof for non-dependent type
 systems.
 For instance, part 2 of 
\begin_inset CommandInset citation
LatexCommand cite
key "pierce2002types"
literal "false"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand cite
key "KOKKE2020102440"
literal "false"

\end_inset

, the Chapala book
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: TAPL cites Harper as a co-originator of progress-preservation.
  Maybe just email him?  it might be also good to gice him for intractability.
  might want to review his book first/comenentary
\end_layout

\end_inset


\end_layout

\end_inset

.
 The preservation lemma shows that typing information is invariant over
 evaluation.
 While the progress lemma shows that a single step of evaluation for a well
 typed term in an empty context will not 
\begin_inset Quotes eld
\end_inset

get stuck
\begin_inset Quotes erd
\end_inset

.
 By iterating these lemmas together, it is possible to show that the type
 system prevents a term from evaluating to the class of bad behavior described
 above.
 This type of proof hinges on a suitable definition of the 
\begin_inset Formula $\equiv$
\end_inset

 relation.
\end_layout

\begin_layout Standard
The 
\begin_inset Formula $\equiv$
\end_inset

 relation characterizes when terms are 
\begin_inset Quotes eld
\end_inset

obviously
\begin_inset Quotes erd
\end_inset

 equal, or 
\begin_inset Quotes eld
\end_inset

automatically
\begin_inset Quotes erd
\end_inset

 equal.
 Because the 
\begin_inset Formula $\equiv$
\end_inset

 relation is usually based on the definition of computation, it is called
 
\series bold
definitional equality
\series default

\begin_inset Foot
status collapsed

\begin_layout Plain Layout
also called 
\begin_inset Quotes eld
\end_inset

judgmental equality
\begin_inset Quotes erd
\end_inset

 since it is defined via judgment
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

%TODO is that actually why?
\end_layout

\end_inset

.
 Usually it is desirable to make the definitional equality relation as large
 as possible, though we will not do that in this chapter.
 Definitional equality will be revisited in the next chapter.
\end_layout

\begin_layout Standard
In a progress and preservation style proof the 
\begin_inset Formula $\equiv$
\end_inset

 should be
\end_layout

\begin_layout Itemize
reflexive, 
\begin_inset Formula $m\equiv m$
\end_inset

 
\end_layout

\begin_layout Itemize
symmetric, if 
\begin_inset Formula $m\equiv m'$
\end_inset

 then 
\begin_inset Formula $m'\equiv m$
\end_inset

 
\end_layout

\begin_layout Itemize
transitive, if 
\begin_inset Formula $m\equiv m'$
\end_inset

 and 
\begin_inset Formula $m'\equiv m''$
\end_inset

 then 
\begin_inset Formula $m\equiv m''$
\end_inset

 
\end_layout

\begin_layout Itemize
closed under substitutions and evaluation, for instance if 
\begin_inset Formula $m\equiv m'$
\end_inset

 and 
\begin_inset Formula $n\equiv n'$
\end_inset

 then 
\begin_inset Formula $m\left[x\coloneqq n\right]\equiv m'\left[x\coloneqq n'\right]$
\end_inset

 
\end_layout

\begin_layout Itemize
Distinguishes type constructors, for instance 
\begin_inset Formula $\star\cancel{\equiv}\left(x:N\right)\rightarrow M$
\end_inset

 
\end_layout

\begin_layout Standard
A particularly simple definition of 
\begin_inset Formula $\equiv$
\end_inset

 is equating any terms that share a reduct via a system of parallel reductions
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{m\Rrightarrow_{\ast}\,n\quad m'\Rrightarrow_{\ast}\,n}{m\equiv m'}\,\equiv\textrm{-Def}
\]

\end_inset


\end_layout

\begin_layout Standard
this relation is
\end_layout

\begin_layout Itemize
reflexive by definition
\end_layout

\begin_layout Itemize
symmetric automatically
\end_layout

\begin_layout Itemize
transitive if 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 is confluent
\end_layout

\begin_layout Itemize
closed under substitution if 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 is closed under substitution, closed under evaluation automatically
\end_layout

\begin_layout Itemize
Distinguishes type constructors, if they are stable under reduction.
 For instance 
\begin_inset Formula $\left(x:N\right)\rightarrow M\Rrightarrow\left(x:N'\right)\rightarrow M'$
\end_inset

, and 
\begin_inset Formula $\star\Rrightarrow\star$
\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{m\Rrightarrow m'\quad n\Rrightarrow n'}{\left(\mathsf{fun}\,f\,x\Rightarrow m\right)n\Rrightarrow m'\left[f\coloneqq\mathsf{fun}\,f\,x\Rightarrow m',x\coloneqq n'\right]}\,\textrm{\Rrightarrow-fun-app-red}
\]

\end_inset


\begin_inset Formula 
\[
\frac{m\Rrightarrow m'}{m::M\Rrightarrow m'}\,\textrm{\Rrightarrow-::-red}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\,}{x\Rrightarrow x}\,\textrm{\Rrightarrow-var}
\]

\end_inset


\begin_inset Formula 
\[
\frac{m\Rrightarrow m'\quad M\Rrightarrow M'}{m::M\Rrightarrow m'::M'}\,\textrm{\Rrightarrow-::}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\,}{\star\Rrightarrow\star}\,\textrm{\Rrightarrow-}\star
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{M\Rrightarrow M'\quad N\Rrightarrow N'}{\left(x:M\right)\rightarrow N\Rrightarrow\left(x:M'\right)\rightarrow N'}\,\textrm{\Rrightarrow-fun-ty}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{m\Rrightarrow m'}{\mathsf{fun}\,f\,x\Rightarrow m\,\Rrightarrow\,\mathsf{fun}\,f\,x\Rightarrow m'}\,\textrm{\Rrightarrow-fun}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{m\Rrightarrow m'\quad n\Rrightarrow n'}{m\,n\Rrightarrow m'\,n'}\,\textrm{\Rrightarrow-fun-app}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\,}{m\Rrightarrow_{\ast}m}\,\textrm{\Rrightarrow_{\ast}-refl}
\]

\end_inset


\begin_inset Formula 
\[
\frac{m\Rrightarrow_{\ast}m'\quad m'\Rrightarrow m''}{m\Rrightarrow_{\ast}m''}\,\textrm{\Rrightarrow_{\ast}-trans}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Surface Language Parallel Reductions
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-reduction"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Parallel reductions are defined to make confluence easy to prove, by allowing
 the simultaneous evaluation of any available reduction.
 The system of parallel reductions is in 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:surface-reduction"
plural "false"
caps "false"
noprefix "false"

\end_inset

 The only interesting rules are 
\begin_inset Formula $\textrm{\Rrightarrow-fun-app-red}$
\end_inset

 and 
\begin_inset Formula $\textrm{\Rrightarrow-::-red}$
\end_inset

 since they preform reductions.
 The other rules are entirely structural.
 Repeating a parallel step zero or more times is written 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

.
\end_layout

\begin_layout Standard
While this is a simple presentation of
\series bold
 
\series default
definitional equality, others variants of the relation are possible.
 For instance it is possible to extend the relation with contextual information,
 type information, explicit proofs of equality as in Extensional Type Theory,
 uncomputable relations as in 
\begin_inset CommandInset citation
LatexCommand cite
key "jia2010dependent"
literal "false"

\end_inset

.
 
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO a little too scatterd so consider revising
\end_layout

\end_inset

 It is also common to assume the properties of 
\begin_inset Formula $\equiv$
\end_inset

 hold without proof.
\end_layout

\begin_layout Subsection
Definitional Equality
\end_layout

\begin_layout Subsubsection
\begin_inset Formula $\Rrightarrow$
\end_inset

, 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

, 
\begin_inset Formula $\equiv$
\end_inset

 are reflexive
\end_layout

\begin_layout Standard
The following rule is admissible,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\,}{m\Rrightarrow\,m}\,\textrm{\Rrightarrow-refl}
\]

\end_inset


\end_layout

\begin_layout Standard
by induction on the syntax of 
\begin_inset Formula $m$
\end_inset


\end_layout

\begin_layout Standard
Recall that 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 is reflexive by definition so
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\,}{m\equiv m}\,\textrm{\equiv-refl}
\]

\end_inset


\end_layout

\begin_layout Standard
is admissible.
\end_layout

\begin_layout Subsubsection
\begin_inset Formula $\Rrightarrow$
\end_inset

, 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

, 
\begin_inset Formula $\equiv$
\end_inset

 are closed under substitutions.
\end_layout

\begin_layout Standard
The following rule is admissible for every substitution 
\begin_inset Formula $\sigma$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO define substitutions, what properties are needed over substitutions?
 
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO is this lemma needed or is it jsut to accomodate stupid binding stuff
 in coq 
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{m\Rrightarrow m'}{m\left[\sigma\right]\Rrightarrow m'\left[\sigma\right]}\,\textrm{\Rrightarrow-sub-\sigma}
\]

\end_inset


\end_layout

\begin_layout Standard
by induction on the 
\begin_inset Formula $\Rrightarrow$
\end_inset

 relation, using 
\begin_inset Formula $\textrm{\Rrightarrow-refl}$
\end_inset

 in the 
\begin_inset Formula $\textrm{\Rrightarrow-var}$
\end_inset

 case.
\end_layout

\begin_layout Standard
The following rule is admissible where 
\begin_inset Formula $\sigma$
\end_inset

, 
\begin_inset Formula $\tau$
\end_inset

 is a substitution where for every 
\begin_inset Formula $x$
\end_inset

, 
\begin_inset Formula $\sigma\left(x\right)\Rrightarrow\tau\left(x\right)$
\end_inset

, written 
\begin_inset Formula $\sigma\Rrightarrow\tau$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{m\Rrightarrow m'\quad\sigma\Rrightarrow\tau}{m\left[\sigma\right]\Rrightarrow m'\left[\tau\right]}\,\textrm{\Rrightarrow-sub}
\]

\end_inset


\end_layout

\begin_layout Standard
by induction on the 
\begin_inset Formula $\Rrightarrow$
\end_inset

 relation.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{m\Rrightarrow_{\ast}m'\quad\sigma\Rrightarrow\tau}{m\left[\sigma\right]\Rrightarrow_{\ast}\,m'\left[\tau\right]}\,\textrm{\Rrightarrow_{\ast}-sub}
\]

\end_inset


\end_layout

\begin_layout Standard
is admissible by induction on the 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 relation.
 And follows that 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{m\equiv m'\quad\sigma\Rrightarrow\tau}{m\left[\sigma\right]\equiv m'\left[\tau\right]}\,\textrm{\equiv-sub}
\]

\end_inset


\end_layout

\begin_layout Standard
is admissible.
\end_layout

\begin_layout Standard
The following corollary is admissible
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{n\Rrightarrow_{\ast}n'}{m\left[x\coloneqq n\right]\equiv m\left[x\coloneqq n'\right]}
\]

\end_inset


\end_layout

\begin_layout Standard
since
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m\Rrightarrow_{\ast}m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow_{\ast}-refl}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m\left[x\coloneqq n\right]\Rrightarrow_{\ast}m\left[x\coloneqq n'\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by repeated 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\textrm{\Rrightarrow_{\ast}-sub}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m\left[x\coloneqq n'\right]\Rrightarrow_{\ast}m\left[x\coloneqq n'\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow_{\ast}-refl}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m\left[x\coloneqq n\right]\equiv m\left[x\coloneqq n'\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\equiv\textrm{-Def}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Subsubsection
\begin_inset Formula $\Rrightarrow$
\end_inset

, 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 is confluent, 
\begin_inset Formula $\equiv$
\end_inset

 is transitive
\end_layout

\begin_layout Standard
A relation 
\begin_inset Formula $R$
\end_inset

 is 
\series bold
confluent
\series default

\begin_inset Foot
status open

\begin_layout Plain Layout
also called 
\begin_inset Quotes eld
\end_inset

Church-Rosser
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset

 when, For all 
\begin_inset Formula $m,n,n'$
\end_inset

, if
\begin_inset Formula $mRn$
\end_inset

 and 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\:mRn'$
\end_inset

 then their exists
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
 
\begin_inset Formula $n''$
\end_inset

 such that 
\begin_inset Formula $nRn''$
\end_inset

 and 
\begin_inset Formula $n'Rn''$
\end_inset

.
 If a relation is confluent, in a sense, specific paths don't matter since
 you can alway reach the same destinations.
\end_layout

\begin_layout Standard
Since we defined our normalization by parallel reductions we can show confluence
 following the proof in 
\begin_inset CommandInset citation
LatexCommand cite
key "TAKAHASHI1995120"
literal "false"

\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
also well presented in 
\begin_inset CommandInset citation
LatexCommand cite
key "KOKKE2020102440"
literal "false"

\end_inset


\end_layout

\end_inset

.
 First, define a function 
\begin_inset Formula $max$
\end_inset

 that takes the maximum possible parallel step, such that if 
\begin_inset Formula $m\Rrightarrow\,m'$
\end_inset

 then 
\begin_inset Formula $m'\Rrightarrow\,max\left(m\right)$
\end_inset

 and 
\begin_inset Formula $m\Rrightarrow\,max\left(m\right)$
\end_inset

.
 This is referred to as the triangle property (a diagram is presented in
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:shape-diagrams"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="5">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $max($
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\mathsf{fun}\,f\,x\Rightarrow m\right)\,n$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $)=$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $max\left(m\right)\left[f\coloneqq\mathsf{fun}\,f\,x\Rightarrow max\left(m\right),x\coloneqq max\left(n\right)\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
otherwise
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $max($
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $)=$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $max($
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m::M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $)=$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $max\left(m\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $max($
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $)=$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $max($
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:M\right)\rightarrow N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $)=$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:max\left(M\right)\right)\rightarrow max\left(N\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $max($
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $)=$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow max\left(m\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $max($
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m\,n$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $)=$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $max\left(m\right)\,max\left(n\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO for example
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
Triangle Property
\end_layout

\begin_layout Plain Layout
\begin_inset Formula $\ensuremath{\forall{\color{red}m},{\color{red}m'}.\:{\color{red}m\Rrightarrow m'}\:\rightarrow\:{\color{red}m'}{\color{blue}\Rrightarrow max\left(m\right)}}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzcd}
\end_layout

\begin_layout Plain Layout


\backslash
mathbin{
\backslash
color{red}m} 
\backslash
tarrow[red]{r} 
\backslash
arrow[lightgray]{d} & 
\backslash
mathbin{
\backslash
color{red}m'} 
\backslash
tarrow[blue]{ld} 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
mathbin{
\backslash
color{blue}max(m)}                  &              
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzcd}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
Diamond Property
\end_layout

\begin_layout Plain Layout
\begin_inset Formula $\forall{\color{red}m},{\color{red}m'},{\color{red}m''}.\:{\color{red}m\Rrightarrow m'}\:\wedge\:{\color{red}m\Rrightarrow m''}\:\rightarrow\:{\color{red}m'}{\color{blue}\Rrightarrow max\left(m\right)}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzcd}
\end_layout

\begin_layout Plain Layout

               & {
\backslash
color{red}m} 
\backslash
tarrow[red]{rd} 
\backslash
tarrow[red]{ld} 
\backslash
arrow[lightgray]{dd} &                
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

{
\backslash
color{red}m'} 
\backslash
tarrow[blue]{rd} &                                       & {
\backslash
color{red}m''} 
\backslash
tarrow[blue]{ld} 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

               & {
\backslash
color{blue}max(m)}                                &               
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzcd}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
Confluence
\end_layout

\begin_layout Plain Layout
\begin_inset Formula $\forall{\color{red}m},{\color{red}n},{\color{red}n'}.\:{\color{red}m\Rrightarrow_{\ast}n}\:\wedge\:{\color{red}m\Rrightarrow_{\ast}n'}\:\rightarrow\:\exists{\color{blue}n'''}.\:{\color{red}n}{\color{blue}\Rrightarrow_{\ast}{\color{blue}n'''}}\:\wedge\:{\color{red}n'}{\color{blue}\Rrightarrow{\color{blue}n'''}}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzcd}
\end_layout

\begin_layout Plain Layout

% TODO look into proper subscripting of arrow heads
\end_layout

\begin_layout Plain Layout

              & {
\backslash
color{red}m} 
\backslash
tarrow[red]{rd}[label={[pos=1,inner sep=0,outer sep=0]0:${
\backslash
ast}$}]{} 
\backslash
tarrow[red]{ld}[label={[pos=1,inner sep=0,outer sep=0]0:${
\backslash
ast}$}]{} &              
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

{
\backslash
color{red}n'}  
\backslash
tarrow[blue]{rd}[label={[pos=1,inner sep=0,outer sep=0]0:${
\backslash
ast}$}]{} &                         & {
\backslash
color{red}n''} 
\backslash
tarrow[blue]{ld}[label={[pos=1,inner sep=0,outer sep=0]0:${
\backslash
ast}$}]{} 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

              & {
\backslash
color{blue}{
\backslash
color{blue}n'''}}                      &                              
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzcd}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Rewriting Diagrams
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:shape-diagrams"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
If 
\begin_inset Formula $m\Rrightarrow\,m'$
\end_inset

 then 
\begin_inset Formula $m'\Rrightarrow max\left(m\right)$
\end_inset

 .
\end_layout

\begin_layout Standard
by induction on the derivation 
\begin_inset Formula $m\Rrightarrow\,m'$
\end_inset

 , with the only interesting cases are where a reduction is not taken
\end_layout

\begin_layout Itemize
in the case of 
\begin_inset Formula $\textrm{\Rrightarrow-::}$
\end_inset

 , 
\begin_inset Formula $m'\Rrightarrow max\left(m\right)$
\end_inset

 by 
\begin_inset Formula $\textrm{\Rrightarrow-::-red}$
\end_inset


\end_layout

\begin_layout Itemize
in the case of 
\begin_inset Formula $\textrm{\Rrightarrow-fun-app}$
\end_inset

 , 
\begin_inset Formula $m'\Rrightarrow max\left(m\right)$
\end_inset

 by 
\begin_inset Formula $\textrm{\Rrightarrow-fun-app-red}$
\end_inset

 
\end_layout

\begin_layout Standard
It follows that, if 
\begin_inset Formula $m\Rrightarrow\,m'$
\end_inset

, 
\begin_inset Formula $m\Rrightarrow\,m''$
\end_inset

, implies 
\begin_inset Formula $m'\Rrightarrow\,max\left(m\right)$
\end_inset

 ,
\begin_inset Formula $m''\Rrightarrow\,max\left(m\right)$
\end_inset

 (referred to as the diamond property).
 Since the 
\begin_inset Formula $max\left(m\right)=max\left(m\right)$
\end_inset

 .
 
\end_layout

\begin_layout Standard
The diamond property implies the confluence of 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 , by repeated application of the diamond property.
\end_layout

\begin_layout Standard
It follows that 
\begin_inset Formula $\equiv$
\end_inset

 is transitive.
 Since if 
\begin_inset Formula $m\equiv m'$
\end_inset

 and 
\begin_inset Formula $m'\equiv m''$
\end_inset

 then by definition for some 
\begin_inset Formula $n$
\end_inset

, 
\begin_inset Formula $n'$
\end_inset

, 
\begin_inset Formula $m\Rrightarrow_{\ast}n$
\end_inset

 , 
\begin_inset Formula $m'\Rrightarrow_{\ast}n$
\end_inset

 and 
\begin_inset Formula $m'\Rrightarrow_{\ast}n'$
\end_inset

 , 
\begin_inset Formula $m''\Rrightarrow_{\ast}n'$
\end_inset

.
 If 
\begin_inset Formula $m'\Rrightarrow_{\ast}n$
\end_inset

 and 
\begin_inset Formula $m'\Rrightarrow_{\ast}n'$
\end_inset

.
 Then by confluence there exists some 
\begin_inset Formula $p$
\end_inset

such that 
\begin_inset Formula $n\Rrightarrow_{\ast}p$
\end_inset

 and 
\begin_inset Formula $n'\Rrightarrow_{\ast}p$
\end_inset

 .
 By transitivity 
\begin_inset Formula $m\Rrightarrow_{\ast}p$
\end_inset

 and 
\begin_inset Formula $m''\Rrightarrow_{\ast}p$
\end_inset

 .
 So by definition 
\begin_inset Formula $m\equiv m''$
\end_inset

.
 
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO clean up, diagram
\end_layout

\end_inset

 
\end_layout

\begin_layout Subsubsection
Stability
\end_layout

\begin_layout Standard
\begin_inset Formula $\forall N,M,P.\left(x:N\right)\rightarrow M\Rrightarrow_{\ast}P\:\Rightarrow\:\exists N',M'.P=\left(x:N'\right)\rightarrow M'\land N\Rrightarrow_{\ast}N'\land M\Rrightarrow_{\ast}M'$
\end_inset


\end_layout

\begin_layout Standard
by induction on 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow_{\ast}-refl}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P=\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N\Rrightarrow_{\ast}N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow_{\ast}-refl}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $M\Rrightarrow_{\ast}M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow_{\ast}-refl}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow_{\ast}-trans}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:N\right)\rightarrow M\Rrightarrow_{\ast}P'$
\end_inset

, 
\begin_inset Formula $P'\Rrightarrow P''$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P'=\left(x:N'\right)\rightarrow M'$
\end_inset

, 
\begin_inset Formula $N\Rrightarrow_{\ast}N'$
\end_inset

, 
\begin_inset Formula $M\Rrightarrow_{\ast}M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction with 
\begin_inset Formula $\left(x:N\right)\rightarrow M\Rrightarrow_{\ast}P'$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P''=\left(x:N''\right)\rightarrow M''$
\end_inset

, 
\begin_inset Formula $N'\Rrightarrow N''$
\end_inset

, 
\begin_inset Formula $M'\Rrightarrow M''$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by inspection, only the 
\begin_inset Formula $\textrm{\Rrightarrow-fun-ty}$
\end_inset

 rule is possible
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N\Rrightarrow_{\ast}N''$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow_{\ast}-trans}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $M\Rrightarrow_{\ast}M''$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow_{\ast}-trans}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
Therefore the following rule is admissible
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\left(x:N\right)\rightarrow M\equiv\left(x:N'\right)\rightarrow M'}{N\equiv N'\quad M\equiv M'}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:N\right)\rightarrow M\Rrightarrow_{\ast}P,\quad\left(x:N'\right)\rightarrow M'\Rrightarrow_{\ast}P$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by expending the definition of 
\begin_inset Formula $\equiv$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P=\left(x:N''\right)\rightarrow M''$
\end_inset

, 
\begin_inset Formula $N\Rrightarrow_{\ast}N''$
\end_inset

, 
\begin_inset Formula $M\Rrightarrow_{\ast}M''$
\end_inset

, 
\begin_inset Formula $N'\Rrightarrow_{\ast}N''$
\end_inset

, 
\begin_inset Formula $M'\Rrightarrow_{\ast}M''$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by the lemma above
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N\equiv N'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by the definition of 
\begin_inset Formula $\equiv$
\end_inset

 with 
\begin_inset Formula $N\Rrightarrow_{\ast}N''$
\end_inset

, 
\begin_inset Formula $N'\Rrightarrow_{\ast}N''$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $M\equiv M'{\color{gray}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by the definition of 
\begin_inset Formula $\equiv$
\end_inset

 with 
\begin_inset Formula $M\Rrightarrow_{\ast}M''$
\end_inset

, 
\begin_inset Formula $M'\Rrightarrow_{\ast}M''$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Subsection
Preservation
\end_layout

\begin_layout Standard
A fundamental property of a type systems is that evaluation preserves type
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Similar proofs for dependent type systems can be found in Chapter 3 of 
\begin_inset CommandInset citation
LatexCommand cite
key "luo1994computation"
literal "false"

\end_inset

, Section 3.1 of 
\begin_inset CommandInset citation
LatexCommand cite
key "10.1007/3-540-45413-6_27"
literal "false"

\end_inset

(including eta expansion in an implicit system), and in the appendix of
 
\begin_inset CommandInset citation
LatexCommand cite
key "sjoberg2012irrelevance"
literal "false"

\end_inset


\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
We need a number of technical lemmas before we can prove that 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 preserves types.
 Proofs are almost always on induction by typing derivations, this allows
 the context to 
\begin_inset Quotes eld
\end_inset

grow
\begin_inset Quotes erd
\end_inset

 with recursive calls while still being well founded by the tree structure
 of the derivation.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% unneeded: In many cases lemmas will produce derivations that are equal
 or smaller in height to one of the derivations used in their input, so
 that inductions can be preformed on the output of the lemma while still
 being well founded.
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Context Weakening
\end_layout

\begin_layout Standard
The following rule is admissible
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\Gamma\vdash n:N}{\Gamma,\Gamma'\vdash n:N}
\]

\end_inset


\end_layout

\begin_layout Standard
by induction on typing derivations
\end_layout

\begin_layout Subsubsection
Substitution Preservation
\end_layout

\begin_layout Standard
The following rule is admissible
\begin_inset Foot
status open

\begin_layout Plain Layout
This lemma is sufficient for our informal account of variable substitution
 and binding.
 A fully formal account will be sensitive to the specific binding strategy,
 and may need to prove this lemma as a corollary from simultaneous substitutions
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\Gamma\vdash n:N\quad\Gamma,x:N,\Gamma'\vdash m:M}{\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash m\left[x\coloneqq n\right]:M\left[x\coloneqq n\right]}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%TODO would be H subscript instead of H' according to unposted style guide
\end_layout

\end_inset


\end_layout

\begin_layout Standard
by induction on typing derivations
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="35" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-}\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,x:N,\Gamma'\vdash\star\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash\star\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-}\star$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-var}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $y:M\in\Gamma,x:N,\Gamma'$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
if 
\begin_inset Formula $y:M\in\Gamma$
\end_inset

,
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash y:M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-var}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash y:M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by weakening 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash y\left[x\coloneqq n\right]:M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x\notin fv\left(y\right)$
\end_inset

,
\begin_inset Formula $x\notin fv\left(M\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
if 
\begin_inset Formula $y=x$
\end_inset

,
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash y:N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash y:N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by weakening 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N=M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $y=x$
\end_inset

, and context lookup is unique
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash y:M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x\notin fv\left(y\right)$
\end_inset

,
\begin_inset Formula $x\notin fv\left(M\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
if 
\begin_inset Formula $y\in\Gamma'$
\end_inset

,
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $y:M\in\Gamma,x:N,\Gamma'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $y:M\left[x\coloneqq n\right]\in\Gamma,\Gamma'\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash y:M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-var}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-::}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,x:N,\Gamma'\vdash m:M$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash m\left[x\coloneqq n\right]:M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash m\left[x\coloneqq n\right]::M\left[x\coloneqq n\right]\,:\,M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-::}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-ty}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,x:N,\Gamma'\vdash M\,:\,\star$
\end_inset

, 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\Gamma,x:N,\Gamma',x:M\vdash N\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash M\left[x\coloneqq n\right]\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right],y:M\left[x\coloneqq n\right]\vdash N\left[x\coloneqq n\right]\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash\left(y:M\left[x\coloneqq n\right]\right)\rightarrow N\left[x\coloneqq n\right]\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-ty}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,x:N,\Gamma',f:\left(x:N\right)\rightarrow M,x:N\vdash m\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right],f:\left(y:N\left[x\coloneqq n\right]\right)\rightarrow M\left[x\coloneqq n\right],y:N\left[x\coloneqq n\right]\vdash m\left[x\coloneqq n\right]\,:\,M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash\mathsf{fun}\,f\,x\Rightarrow m\left[x\coloneqq n\right]\,:\,\left(x:N\left[x\coloneqq n\right]\right)\rightarrow M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-app}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,x:N,\Gamma'\vdash m\,:\,\left(x:P\right)\rightarrow M$
\end_inset

, 
\begin_inset Formula $\Gamma,x:N,\Gamma'\vdash p\,:\,P$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash p\left[x\coloneqq n\right]\,:\,P\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash m\left[x\coloneqq n\right]\,:\,\left(y:P\left[x\coloneqq n\right]\right)\rightarrow M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash m\left[x\coloneqq n\right]\,p\left[x\coloneqq n\right]\,:\,M\left[x\coloneqq n\right]\left[y\coloneqq p\left[x\coloneqq n\right]\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-app}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash m\left[x\coloneqq n\right]\,p\left[x\coloneqq n\right]\,:\,M\left[y\coloneqq p,x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,x:N,\Gamma'\vdash m:M$
\end_inset

, 
\begin_inset Formula $M\equiv M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash m\left[x\coloneqq n\right]:M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $M\Rrightarrow_{\ast}M''$
\end_inset

, 
\begin_inset Formula $M'\Rrightarrow_{\ast}M''$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by 
\begin_inset Formula $\equiv\textrm{-Def}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $M\left[x\coloneqq n\right]\Rrightarrow_{\ast}M''\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 closed under substitution
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $M'\left[x\coloneqq n\right]\Rrightarrow_{\ast}M''\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 closed under substitution
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $M\left[x\coloneqq n\right]\equiv M'\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\equiv\textrm{-Def}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash m\left[x\coloneqq n\right]:M'\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Subsubsection
Context Preservation
\end_layout

\begin_layout Standard
When contexts are convertible, typing judgments still hold.
 We extend the notion of definitional equality to contexts in 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:surface-Context-Equiv"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\ }{\lozenge\equiv\lozenge}\,\textrm{\equiv-ctx-empty}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\Gamma\equiv\Gamma'\quad M\equiv M'}{\Gamma,x:M\equiv\Gamma',x:M'}\,\textrm{\equiv-ctx-ext}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Contextual Equivalence
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-Context-Equiv"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
the following rule is admissible
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\Gamma\vdash n:N\quad\Gamma\equiv\Gamma'}{\Gamma'\vdash n:N}
\]

\end_inset


\end_layout

\begin_layout Standard
by induction over typing derivations
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="27" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-}\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash\star\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash\star\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-}\star$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-var}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x:M\in\Gamma$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x:M'\in\Gamma'$
\end_inset

, 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $M\equiv M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by 
\begin_inset Formula $\Gamma\equiv\Gamma'$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash x:M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-var}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $M'\equiv M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by symmetry
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash x:M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m\,:\,M$
\end_inset

, 
\begin_inset Formula $M\equiv M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash m\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash m\,:\,M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-::}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m::M\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash m\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash m::M\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-::}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-ty}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash M\,:\,\star$
\end_inset

, 
\begin_inset Formula $\Gamma,x:M\vdash N\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash M\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,x:M\equiv\Gamma',x:M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\equiv-ctx-ext}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma',x:M\vdash N\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction with 
\begin_inset Formula $\Gamma,x:M\vdash N\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash\left(x:M\right)\rightarrow N\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-ty}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,f:\left(x:N\right)\rightarrow M\equiv\Gamma',f:\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\equiv-ctx-ext}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,f:\left(x:N\right)\rightarrow M,x:N\equiv\Gamma',f:\left(x:N\right)\rightarrow M,x:N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\equiv-ctx-ext}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\Gamma',f:\left(x:N\right)\rightarrow M,x:N\vdash m\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction with 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash\mathsf{fun}\,f\,x\Rightarrow m\,:\,\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-app}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m\,:\,\left(x:N\right)\rightarrow M$
\end_inset

, 
\begin_inset Formula $\Gamma\vdash n\,:\,N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash m\,:\,\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash n\,:\,N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash m\,n\,:\,M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-app}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Subsubsection
Inversion
\end_layout

\begin_layout Standard
In the preservation proof we will need to reason backwards about the typing
 judgments implied by a typing derivation of term syntax.
 However this induction does not go through directly, and must be weakened
 up to definitional equality.
\end_layout

\begin_layout Standard
Thus we can show this more general rule
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\Gamma\vdash\mathsf{fun}\,f\,x\Rightarrow m\,:\,P\quad P\equiv\left(x:N\right)\rightarrow M}{\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m:M}
\]

\end_inset


\end_layout

\begin_layout Standard
is admissible.
 By induction on typing derivations,
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,f:\left(x:N'\right)\rightarrow M',x:N'\vdash m\,:\,M'$
\end_inset

, 
\begin_inset Formula $\left(x:N'\right)\rightarrow M'\equiv\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N'\equiv N,\quad M'\equiv M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by stability of fun-ty
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,f:\left(x:N'\right)\rightarrow M',x:N'\equiv\Gamma,f:\left(x:N\right)\rightarrow M,x:N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by reflexivity of 
\begin_inset Formula $\equiv$
\end_inset

 , extended with previous equalities
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m\,:\,M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by preservation of contexts
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m:M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash\mathsf{fun}\,f\,x\Rightarrow m\,:\,P'$
\end_inset

, 
\begin_inset Formula $P'\equiv P$
\end_inset

, 
\begin_inset Formula $P\equiv\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P'\equiv\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by transitivity
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m:M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
other rules
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
impossible
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
the term position has the form 
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
This allows us to conclude the more strait-forward corollary 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\Gamma\vdash\mathsf{fun}\,f\,x\Rightarrow m\,:\,\left(x:N\right)\rightarrow M}{\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m:M}
\]

\end_inset


\end_layout

\begin_layout Standard
by noting that 
\begin_inset Formula $\left(x:N\right)\rightarrow M\equiv\left(x:N\right)\rightarrow M$
\end_inset

, by reflexivity 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%TODO: Note that the result of this lemma will always produce derivations
 of equal or smaller hight to the input typing derivation.
\end_layout

\begin_layout Plain Layout

% unneeded
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
\begin_inset Formula $\Rrightarrow$
\end_inset

-Preservation 
\end_layout

\begin_layout Standard
The following rule is admissible
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\Gamma\vdash m:M\quad m\Rrightarrow m'}{\Gamma\vdash m':M}
\]

\end_inset


\end_layout

\begin_layout Standard
by induction on the typing derivation 
\begin_inset Formula $\Gamma\vdash m:M$
\end_inset

, specializing on 
\begin_inset Formula $m\Rrightarrow m'$
\end_inset

,
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%TODO first 2 steps don't exactly match the scheme
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="43" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-}\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow-}\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash\star\,:\,\star$
\end_inset

, 
\begin_inset Formula $\star\Rrightarrow\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
follows directly
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-var}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow-var}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash x\,:\,M$
\end_inset

, 
\begin_inset Formula $x\Rrightarrow x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
follows directly
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\Gamma\vdash m\,:\,M$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
,
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $M\equiv M'$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
all 
\begin_inset Formula $\Rrightarrow$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m\Rrightarrow m'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\Gamma\vdash m'\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m'\,:\,M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-::}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow-::-red}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m\Rrightarrow m'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m'\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow-::}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m\Rrightarrow m'$
\end_inset

, 
\begin_inset Formula $M\Rrightarrow M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m'\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $M\equiv M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by promoting 
\begin_inset Formula $M\Rrightarrow M'$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m'\,:\,M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m'::M':\,M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-::}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $M'\equiv M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by symmetry
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m'::M':\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-ty}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash M\,:\,\star$
\end_inset

, 
\begin_inset Formula $\Gamma,x:M\vdash N\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow-fun-ty}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N\Rrightarrow N'$
\end_inset

, 
\begin_inset Formula $M\Rrightarrow M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash M'\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,x:M\vdash N'\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $M\equiv M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by promoting 
\begin_inset Formula $M\Rrightarrow M'$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,x:M\equiv\Gamma,x:M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by reflexivity of 
\begin_inset Formula $\equiv$
\end_inset

 , extended with 
\begin_inset Formula $M\equiv M'$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,x:M'\vdash N'\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by preservation of contexts
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash\left(x:M'\right)\rightarrow N'\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-ty}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow-fun}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m\Rrightarrow m'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m'\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash\mathsf{fun}\,f\,x\Rightarrow m'\,:\,\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-app}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash n\,:\,N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow-fun-app-red}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash\mathsf{fun}\,f\,x\Rightarrow m\,:\,\left(x:N\right)\rightarrow M$
\end_inset

, 
\begin_inset Formula $m\Rrightarrow m'$
\end_inset

, 
\begin_inset Formula $n\Rrightarrow n'$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow m\Rrightarrow\mathsf{fun}\,f\,x\Rightarrow m'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow-fun}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash\mathsf{fun}\,f\,x\Rightarrow m'\,:\,\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by fun-inversion
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\Gamma\vdash n'\,:\,N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m'\left[f\coloneqq\mathsf{fun}\,f\,x\Rightarrow m',x\coloneqq n'\right]:M\left[x\coloneqq n'\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by typed substitutions (
\begin_inset Formula $f$
\end_inset

 is not free in 
\begin_inset Formula $M$
\end_inset

)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $M\left[x\coloneqq n'\right]\equiv M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by substitution by steps, 
\begin_inset Formula $\equiv$
\end_inset

 symmetry
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m'\left[f\coloneqq\mathsf{fun}\,f\,x\Rightarrow m',x\coloneqq n'\right]:M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow-fun-app}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m\,:\,\left(x:N\right)\rightarrow M$
\end_inset

, 
\begin_inset Formula $m\Rrightarrow m'$
\end_inset

, 
\begin_inset Formula $n\Rrightarrow n'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m'\,:\,\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash n'\,:\,N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m'\,n':\,M\left[x\coloneqq n'\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-app}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $M\left[x\coloneqq n'\right]\equiv M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by substitution by steps, 
\begin_inset Formula $\equiv$
\end_inset

 symmetry
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m'\,n':\,M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Subsection
Progress
\end_layout

\begin_layout Standard
The second key lemma is to show preservation, computation is 
\begin_inset Quotes eld
\end_inset

finished
\begin_inset Quotes erd
\end_inset

 or that a further step can be taken.
 For non-dependently typed programming languages, these steps are easy to
 characterize, but for dependent types there are issues.
 If we characterize computation with the 
\begin_inset Formula $\Rrightarrow$
\end_inset

 relation, the progress lemma holds in a meaningless way since we can always
 take a reflexive step.
 Thus we need a more realistic computation relation, ideally one that is
 not reflexive, is deterministic and that is a sub relation of 
\begin_inset Formula $\Rrightarrow_{*}$
\end_inset

.
 We can choose a Call-by-value relation since this meets all the properties
 required, and is a standard execution strategy, that reflects actual implementa
tions.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="none" valignment="top" usebox="none" special="l">
\begin_inset Text

\begin_layout Plain Layout
values,
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
v
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\star$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:M\right)\rightarrow N$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Surface Language Value Syntax
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-value-syntax"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Values are characterized by the sub-grammar in 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:surface-value-syntax"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 As usual, functions with any body are values.
 Additionally the Type universe is a value, and function types 
\begin_inset Foot
status open

\begin_layout Plain Layout
evaluated to whnf
\end_layout

\end_inset

 are values.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\,}{\left(\mathsf{fun}\,f\,x\Rightarrow m\right)v\rightsquigarrow m\left[f\coloneqq\mathsf{fun}\,f\,x\Rightarrow m,x\coloneqq v\right]}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{m\rightsquigarrow m'}{m\,n\rightsquigarrow m'\,n}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{n\rightsquigarrow n'}{v\,n\rightsquigarrow v\,n'}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{m\rightsquigarrow m'}{m::M\rightsquigarrow m'::M}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\,}{v::M\rightsquigarrow v}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: Note the location data makes this dangerous
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Surface Language Call-by-Value reductions
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-reduction-step"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
A call-by-value relation is defined in 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:surface-reduction-step"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The reductions are standard for a call-by-value lambda calculus, except
 that type annotations are only removed from values.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO explicitly define stuck, transition from scare quats
\end_layout

\end_inset


\end_layout

\begin_layout Standard
the following rule is admissible
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{m\rightsquigarrow m'}{m\Rrightarrow m'}
\]

\end_inset


\end_layout

\begin_layout Standard
Thus 
\begin_inset Formula $\rightsquigarrow$
\end_inset

 also preserves types.
\end_layout

\begin_layout Subsubsection
Canonical forms
\end_layout

\begin_layout Standard
We will need a technical lemma that determines the form of a value of function
 type in an empty context
\end_layout

\begin_layout Standard
If 
\begin_inset Formula $\vdash v\,:\,P$
\end_inset

 and 
\begin_inset Formula $P\equiv\left(x:N\right)\rightarrow M$
\end_inset

 then 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $v=\mathsf{fun}\,f\,x\Rightarrow m$
\end_inset

.
\end_layout

\begin_layout Standard
by induction on the typing derivation
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash\mathsf{fun}\,f\,x\Rightarrow m\,:\,\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
follows immediately
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash v\,:\,P$
\end_inset

, 
\begin_inset Formula $\vdash v\,:\,P'$
\end_inset

, 
\begin_inset Formula $P\equiv P'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P'\equiv\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by transitivity, symmetry
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $v=\mathsf{fun}\,f\,x\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-}\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash\star\,:\,\star$
\end_inset

, 
\begin_inset Formula $\star\equiv\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\star\cancel{\equiv}\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by the stability of 
\begin_inset Formula $\equiv$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-ty}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash\left(x:M\right)\rightarrow N\,:\,\star$
\end_inset

, 
\begin_inset Formula $\star\equiv\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\star\cancel{\equiv}\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by the stability of 
\begin_inset Formula $\equiv$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
other rules
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
impossible
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
since they do not type values
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
as a corollary,
\end_layout

\begin_layout Standard
If 
\begin_inset Formula $\vdash v\,:\,\left(x:N\right)\rightarrow M$
\end_inset

 then 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $v=\mathsf{fun}\,f\,x\Rightarrow m$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%TODO not that by only considering values, we can aviod the problematic
 application case
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Progress
\end_layout

\begin_layout Standard
Finally we can prove
\end_layout

\begin_layout Standard
If 
\begin_inset Formula $\vdash m\,:\,M$
\end_inset

 then 
\begin_inset Formula $m$
\end_inset

 is a value or there exists 
\begin_inset Formula $m'$
\end_inset

 such that 
\begin_inset Formula $m\rightsquigarrow m'$
\end_inset


\end_layout

\begin_layout Standard
As usual this follows form induction on the typing derivation
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="20" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-}\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash\star\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\star$
\end_inset

is a value
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-var}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash x\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
impossible in an empty context
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash m:M'$
\end_inset

, 
\begin_inset Formula $M'\equiv M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m$
\end_inset

 is a value or there exists 
\begin_inset Formula $m'$
\end_inset

 such that 
\begin_inset Formula $m\rightsquigarrow m'$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction on 
\begin_inset Formula $\vdash m\,:\,M'$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-::}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash m::M\,:\,M$
\end_inset

, 
\begin_inset Formula $\vdash m\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m$
\end_inset

 is a value or there exists 
\begin_inset Formula $m'$
\end_inset

 such that 
\begin_inset Formula $m\rightsquigarrow m'$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
if 
\begin_inset Formula $m$
\end_inset

 is a value, 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $m::M\rightsquigarrow m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
if 
\begin_inset Formula $m\rightsquigarrow m'$
\end_inset

, 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $m::M\rightsquigarrow m'::M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-ty}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash\left(x:M\right)\rightarrow N\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:M\right)\rightarrow N$
\end_inset

 is a value
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash\mathsf{fun}\,f\,x\Rightarrow m\,:\,\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow m$
\end_inset

 is a value
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-app}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash m\,:\,\left(x:N\right)\rightarrow M$
\end_inset

, 
\begin_inset Formula $\Gamma\vdash n\,:\,N$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m$
\end_inset

 is a value or there exists 
\begin_inset Formula $m'$
\end_inset

 such that 
\begin_inset Formula $m\rightsquigarrow m'$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n$
\end_inset

 is a value or there exists 
\begin_inset Formula $n'$
\end_inset

 such that 
\begin_inset Formula $n\rightsquigarrow n'$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
if 
\begin_inset Formula $m\rightsquigarrow m'$
\end_inset

, 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m\,n\rightsquigarrow m'\,n$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
if 
\begin_inset Formula $m$
\end_inset

 is a value, 
\begin_inset Formula $n\rightsquigarrow n'$
\end_inset

, 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m\,n\rightsquigarrow m\,n'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
if 
\begin_inset Formula $m$
\end_inset

 is a value, 
\begin_inset Formula $n$
\end_inset

 is a value, 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m=\mathsf{fun}\,f\,x\Rightarrow p$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by canonical forms of functions
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\mathsf{fun}\,f\,x\Rightarrow p\right)n\rightsquigarrow p\left[f\coloneqq\mathsf{fun}\,f\,x\Rightarrow p,x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
Progress via call-by-value can be seen as a specific sub-strategy of 
\begin_inset Formula $\Rrightarrow$
\end_inset

.
 An interpreter is always free to take any 
\begin_inset Formula $\Rrightarrow$
\end_inset

, but if it is unclear which 
\begin_inset Formula $\Rrightarrow$
\end_inset

 to take, either it is a value and no further steps are required, or can
 fall back on 
\begin_inset Formula $\rightsquigarrow$
\end_inset

 until the the outermost constructor has completed.
\end_layout

\begin_layout Subsection
Type Soundness
\end_layout

\begin_layout Standard
The language has type soundness, well typed terms will never 
\begin_inset Quotes eld
\end_inset

get stuck
\begin_inset Quotes erd
\end_inset

 in the surface language.
 This follows by iterating the progress and preservation lemmas.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: TODO be explicit about the disconnect between type computation via
 par, and term level cbv
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: other properties, such as regularity?
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: other lemmas not needed for this proof, par max is par, inversions
 
\end_layout

\end_inset

 
\end_layout

\begin_layout Subsection
Type checking is impractical
\end_layout

\begin_layout Standard
This type system is inherently non-local.
 No type annotations are ever required to form a derivation.
 That means it would be up to a type checking algorithm to guess the types
 of intermediate terms.
 For instance, 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\lambda f\Rightarrow & \,\\
... & f\,1_{c}\,true_{c}\\
... & f\,0_{c}\,1_{c}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
what should be deduced for the type of 
\begin_inset Formula $f$
\end_inset

? One possibility is 
\begin_inset Formula $f:\left(n:\mathbb{N}\right)\rightarrow n\,\star\,\left(\lambda-\Rightarrow\mathbb{N}_{c}\right)\,\mathbb{B}_{c}\rightarrow...$
\end_inset

.
 But there are infinitely other possibilities.
 Worse, if there is an error, it may be impossible to localize.
 To make a practical type checker we need to insist that the user include
 some type annotations.
\end_layout

\begin_layout Section
Bi-directional Surface Language
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% Annotate all the vars
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
There are many possible way to localize the type checking process.
 We could ask that all variable be annotated at binders.
 This is ideal from a theoretical perspective since it matches how type
 contexts are built up.
\end_layout

\begin_layout Standard
However note that, our proof of 
\begin_inset Formula $\lnot1_{c}\doteq_{\mathbb{N}_{c}}0_{c}$
\end_inset

 will look like
\end_layout

\begin_layout Standard
\begin_inset Formula $\lambda pr:1_{c}\doteq_{\mathbb{N}_{c}}0_{c}\Rightarrow pr\,\left(\lambda n:\left(C:\left(\mathbb{N}_{c}\rightarrow\star\right)\right)\rightarrow C\,1_{c}\rightarrow C\,0_{c}\Rightarrow n\,\star\,(\lambda-:\star\Rightarrow Unit_{c})\,\perp_{c}\right)\,tt_{c}:\lnot1_{c}\doteq_{\mathbb{N}_{c}}0_{c}$
\end_inset


\end_layout

\begin_layout Standard
Annotating every binding site requires a lot of redundant information.
 Luckily there's a better way, bidirectional type checking.
\end_layout

\begin_layout Subsection
Bidirectional type checking
\end_layout

\begin_layout Standard

\series bold
Bidirectional type checking
\series default
 is a popular form of lightweight type inference, which strikes a good compromis
e between the required type annotations and the simplicity of the theory,
 allowing for localized errors 
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
\begin_inset CommandInset citation
LatexCommand cite
key "christiansen2013bidirectional"
literal "false"

\end_inset

 is a good tutorial, 
\begin_inset CommandInset citation
LatexCommand cite
key "10.1145/3450952"
literal "false"

\end_inset

 is a survey of the technique
\end_layout

\end_inset

.
 In the usual bidirectional bidirectional typing scheme annotations are
 only required at the top-level, or around a lambda that is directly applied
 to an argument
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
more generally when an elimination reduction is possible
\end_layout

\end_inset

.
 Since programers rarely write functions that are immediately evaluated,
 this style of type checking usually only needs top level functions to be
 annotated
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Even in Haskell, with full Hindley-Milner type inference, top level type
 annotations are encouraged.
\end_layout

\end_inset

.
 In fact, every example in 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:surface-exemples"
plural "false"
caps "false"
noprefix "false"

\end_inset

 has enough annotations to type check bidirectionally without further informatio
n.
 
\end_layout

\begin_layout Standard
This is accomplished by breaking the typing judgments into two inter connected
 judgments: 
\end_layout

\begin_layout Itemize

\series bold
Type Inference
\series default
 where type information propagates out of a term, 
\begin_inset Formula $\overrightarrow{\,:\,}$
\end_inset

 in our notation.
 
\end_layout

\begin_layout Itemize

\series bold
Type Checking
\series default
 judgments where a term is checked against a type, 
\begin_inset Formula $\overleftarrow{\,:\,}$
\end_inset

 in our notation.
 
\end_layout

\begin_layout Standard
This allows typing information to flow from the outside in for type checking
 judgments and inside out for the type inference judgments.
 When an inference meets a check, a conversion verifies that the types are
 definitionally equal.
 This has the advantage of precisely limiting where conversion rule can
 be used, since conversion checking is usually the least efficient part
 of dependent type checking.
\end_layout

\begin_layout Standard
This enforced flow results in a system that localizes type errors.
 If a type was inferred, it was unique from the term, so it can be used
 freely.
 Checking judgments force terms that could have multiple typings in the
 previous system to have at most one type.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{x:M\in\Gamma}{\Gamma\vdash x\overrightarrow{\,:\,}M}\operatorname{\overrightarrow{ty}-var}
\]

\end_inset


\begin_inset Formula 
\[
\frac{\,}{\Gamma\vdash\star\overrightarrow{\,:\,}\star}\operatorname{\overrightarrow{ty}-\star}
\]

\end_inset


\begin_inset Formula 
\[
\frac{\Gamma\vdash m\overleftarrow{\,:\,}M}{\Gamma\vdash m::M\overrightarrow{\,:\,}M}\operatorname{\overrightarrow{ty}-::}
\]

\end_inset


\begin_inset Formula 
\[
\frac{\Gamma\vdash M\overleftarrow{\,:\,}\star\quad\Gamma,x:M\vdash N\overleftarrow{\,:\,}\star}{\Gamma\vdash\left(x:M\right)\rightarrow N\overrightarrow{\,:\,}\star}\operatorname{\overrightarrow{ty}-fun-ty}
\]

\end_inset


\begin_inset Formula 
\[
\frac{\Gamma\vdash m\overrightarrow{\,:\,}\left(x:N\right)\rightarrow M\quad\Gamma\vdash n\overleftarrow{\,:\,}N}{\Gamma\vdash m\,n\overrightarrow{\,:\,}M\left[x\coloneqq n\right]}\operatorname{\overrightarrow{ty}-fun-app}
\]

\end_inset


\begin_inset Formula 
\[
\frac{\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m\overleftarrow{\,:\,}M}{\Gamma\vdash\mathsf{fun}\,f\,x\Rightarrow m\overleftarrow{\,:\,}\left(x:N\right)\rightarrow M}\operatorname{\overleftarrow{ty}-\mathsf{fun}}
\]

\end_inset


\begin_inset Formula 
\[
\frac{\Gamma\vdash m\overrightarrow{\,:\,}M\quad M\equiv M'}{\Gamma\vdash m\overleftarrow{\,:\,}M'}\operatorname{\overleftarrow{ty}-conv}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Surface Language Bidirectional Typing Rules
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-bityping-rules"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% review the typing rule 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The surface language supports bidirectional type-checking over the pre-syntax
 with the rules in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:surface-bityping-rules"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 These rules are the same as before except that typing direction is now
 explicit in the judgment.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% For example...
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
The bidirectional System is Type Sound
\end_layout

\begin_layout Standard
It is possible to prove bidirectional type systems are type sound directly
\begin_inset CommandInset citation
LatexCommand cite
key "nanevski2005dependent"
literal "false"

\end_inset

.
 But it would be difficult for the system described here since type annotations
 evaluate away, making preservation difficult.
 Alternatively we can show that a bidirectional typing judgment implies
 a type assignment system typing judgment.
\end_layout

\begin_layout Itemize
if 
\begin_inset Formula $\Gamma\vdash m\overrightarrow{\,:\,}M$
\end_inset

 then 
\begin_inset Formula $\Gamma\vdash m\,:\,M$
\end_inset


\end_layout

\begin_layout Itemize
if 
\begin_inset Formula $\Gamma\vdash m\overleftarrow{\,:\,}M$
\end_inset

 then 
\begin_inset Formula $\Gamma\vdash m\,:\,M$
\end_inset


\end_layout

\begin_layout Standard
by mutual induction on the bidirectional typing derivations.
 
\end_layout

\begin_layout Standard
Therefore the bidirectional system is also type sound.
\end_layout

\begin_layout Subsection
The Bidirectional System is Conservative
\end_layout

\begin_layout Standard
Additionally we can show that the bidirectional system does not preclude
 any computation available in the type assignment system.
 Formally
\end_layout

\begin_layout Itemize
if 
\begin_inset Formula $\Gamma\vdash m\,:\,M$
\end_inset

 then 
\begin_inset Formula $\Gamma\vdash m'\overrightarrow{\,:\,}M$
\end_inset

 , 
\begin_inset Formula $\Gamma\vdash m'\overleftarrow{\,:\,}M$
\end_inset

, and 
\begin_inset Formula $m\equiv m'$
\end_inset


\end_layout

\begin_layout Standard
by induction on the typing derivation, adding annotations at each step that
 are convertible with the original 
\begin_inset Formula $m$
\end_inset


\end_layout

\begin_layout Section
Absent Logical Properties
\end_layout

\begin_layout Standard
When type systems are considered as a logic, it is desirable that
\end_layout

\begin_layout Itemize
There exists an empty type that is uninhabited in the empty context, so
 the system is 
\series bold
logically sound
\series default

\begin_inset Foot
status open

\begin_layout Plain Layout
also called 
\begin_inset Quotes eld
\end_inset

consistent
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset

.
\end_layout

\begin_layout Itemize
Type checking is decidable.
\end_layout

\begin_layout Standard
The surface system has neither of these properties
\begin_inset Foot
status open

\begin_layout Plain Layout
These properties are usually shown be showing that the computation that
 generates conversion is normalizing.
 A proof for a more logical system can be found in Chapter 4
\begin_inset CommandInset citation
LatexCommand cite
key "luo1994computation"
literal "false"

\end_inset

 
\end_layout

\end_inset

.
 
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: aparently that note from Chris Casinghino is dead http://prosecco.gforge.i
nria.fr/personal/hritcu/temp/snforcc.pdf
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Logical Unsoundness
\end_layout

\begin_layout Standard
The surface language is logically unsound, every type is inhabited.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: proper example formatting
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Every Type is Inhabited (by recursion)
\end_layout

\begin_layout Standard
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow f\,x\qquad:\perp_{c}$
\end_inset


\end_layout

\begin_layout Subsubsection
Every Type is Inhabited (by Type-in-type)
\end_layout

\begin_layout Standard
It is possible to encode Girard's paradox, producing another source of logical
 unsoundness.
 A subtle form of recursive behavior can be built out of Gerard's paradox
\begin_inset CommandInset citation
LatexCommand cite
key "Reinhold89typecheckingis"
literal "false"

\end_inset

, but this behavior is no worse then the unrestricted recursion already
 allowed.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: cite stuff (see https://stackoverflow.com/questions/18178999/do-agda-prog
rams-necessarily-terminate), 
\end_layout

\begin_layout Plain Layout

% of course this hapens in Girard's french thesis
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% I am unaware of anyone accidentally deriving a falsehood from type-in-type.
 
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Logical Unsoundness
\end_layout

\begin_layout Standard
Operationally, logical unsoundness will present in the system as non-termination.
 However non-termination seems not to matter for programming languages practice
 in practice.
 For instance, in ML the type 
\begin_inset Formula $\mathtt{f:Int->Int}$
\end_inset

 does not imply the termination of 
\begin_inset Formula $\mathtt{f\,2}$
\end_inset

.
 While unproductive non-termination is always a bug, it seems an easy bug
 to detect and fix when it occurs.
 In mainstream languages, types help to communicate the intent of termination,
 even though termination is not guaranteed by the type system.
 Importantly, no desirable computation is prevented in order to preserve
 logical soundness.
 There will never be a way to include all the terminating computations and
 exclude all the nonterminating computations.
 A tradeoff must be made, and programmers likely care more about having
 all possible computations then preventing non-termination.
 Therefore, logical unsoundness seems suitable for a dependently typed programmi
ng language.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: add ref to inequalities
\end_layout

\end_inset


\end_layout

\begin_layout Standard
While the surface language supports proofs, not every term typed in the
 surface language is a proof.
 Terms can still be called proofs as long as the safety of recursion and
 type-in-type are checked externally.
 In this sense, the listed example inequalities are proofs, as they make
 no use of general recursion (so all recursions are well founded) and universes
 are used in a safe way (universe hierarchies could be assigned).
 In an advanced implementation, an automated process could supply warnings
 when constructs are used in potentially unsafe ways.
 Traditional software testing can be used to discover if there are actual
 proof bugs.
 Even though the type system is not logically sound, type checking still
 eliminates a large class of possible mistakes.
 While it is possible to make a subtle error, it is easier to make an error
 in a paper and pencil proofs, or in typeset latex.
\end_layout

\begin_layout Standard
Finally by separating non-termination concerns from the core of the theory
 this architecture is resilient to change.
 If the termination checker is updated in Coq, there is some chance older
 proof scripts will no longer type check.
 With the architecture proposed here, code will always have the same static
 and dynamic behavior, though some warnings might appear or disappear.
\end_layout

\begin_layout Subsection
Type Checking is Undecidable
\end_layout

\begin_layout Standard
Given a thunk 
\begin_inset Formula $f:Unit$
\end_inset

 defined in PCF, it can be encoded into the surface system as a thunk 
\begin_inset Formula $f':Unit_{c}$
\end_inset

 , such that if 
\begin_inset Formula $f$
\end_inset

 reduces to the canonical 
\begin_inset Formula $Unit$
\end_inset

 then 
\begin_inset Formula $f'\Rrightarrow_{\ast}\lambda A.\lambda a.a$
\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Formula $\vdash\star:f'\,\star\,\star$
\end_inset

 type-checks by conversion exactly when 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $f$
\end_inset

 halts.
\end_layout

\begin_layout Standard
If there is a procedure to decide type checking we can decide exactly when
 any PCF function halts.
 Since checking if a PCF function halts is undecidable, type checking here
 is undecidable.
\end_layout

\begin_layout Standard
Again this the root of the problem is related to the non-termination that
 results by allowing Turing complete computations, which are apparently
 necessary for a realistic programing language.
\end_layout

\begin_layout Standard
Luckily undecidability of type checking is not as bad as it sounds for several
 reasons.
 First, the pathological terms that cause non-terminating conversion are
 rarely created on purpose.
 In the bidirectional system, conversion checks will only happen at limited
 positions, ant it is possible to use a counter to warn or give errors at
 code positions that do not convert because normalization takes too long.
 Heuristic methods of conversion chcking seem to work well enough in practice
 even without a counter.
 It is also possible to embed proofs of conversion directly into the syntax
 as in
\begin_inset CommandInset citation
LatexCommand cite
key "sjoberg2012irrelevance"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
Many dependent type systems, such as Agda, Coq, and Lean, aspire to decidable
 type checking.
 However these systems allow extremely fast growing functions to be encoded
 (such as Ackerman's function).
 A fast growing function can generate a very large index that can be used
 to check some concrete but unpredictable property, (how many Turing machines
 whose code is smaller then 
\begin_inset Formula $n$
\end_inset

 halt in 
\begin_inset Formula $n$
\end_inset

 steps?).
 When this kind of computation is lifted to the type level, type checking
 is computationally infeasible, to say the least.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO extract example
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% cite this blog https://existentialtype.wordpress.com/2014/03/20/old-neglected-th
eorems-are-still-theorems/
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO make sure I'm not missing any langs, C#...?
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
Many mainstream programming languages have undecidable type checking.
 If a language admits a Turing complete macro or preprocessor system that
 can modify typing, this would make type checking undecidable (this makes
 the type system of C, C++
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
apparently even the grammar of C++ is undecidable
\end_layout

\end_inset

, Scala, and Rust undecidable).
 Unless type features are considered very carefully, they can often create
 undecidable type checking (Java generics, C++ templates, Scala implicit
 parameters
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
without a maximum search depth
\end_layout

\end_inset

 and OCaml modules, make type checking undecidable in those languages respective
ly).
 Haskell may be the most popular statically typed language with decidable
 type checking (though GHC compiler flags that make type checking undecidable
 are popular).
 Even the Hindley-Milner type checking algorithm that underlies Haskell
 and ML, has a worst case double exponential complexity, which under normal
 circumstances would be considered intractable.
\end_layout

\begin_layout Standard
In practice these theoretical concerns are not born out since programers
 are not giving the compiler 
\begin_inset Quotes eld
\end_inset

worst case
\begin_inset Quotes erd
\end_inset

 code.
 Even if they did all that can happen is the type checking will time-out
 in the compilation process.
 When this happens programmers can fix their code, modify or remove macros,
 or add typing annotations.
 Programers in conventional languages are already entrusted with almost
 unlimited power to cause harm, programs regularly delete files, read and
 modify sensitive information, and send emails (some of these are even possible
 from within the language's macro systems).
 Relatively speaking, undecidable type checking is not the biggest concern.
\end_layout

\begin_layout Standard
Finally, for the system descried in this thesis, users are expected to use
 the elaboration procedure defined in the next chapter that will bypass
 the type checking described here.
 That elaboration procedures is also undecidable, but only for extremely
 pathological terms.
\end_layout

\begin_layout Section
Related work
\end_layout

\begin_layout Subsection
Bad logics, ok programming languages?
\end_layout

\begin_layout Standard
Unsound logical systems that work as programming languages go back to at
 least Church's lambda calculus which was originally intended to be part
 of a foundation for mathematics
\begin_inset Foot
status open

\begin_layout Plain Layout
\begin_inset Quotes eld
\end_inset

There may, indeed, be other applications of the system than its use as a
 logic.
\begin_inset Quotes erd
\end_inset

 [Church, 1932, p.349, A Set of Postulates for the Foundation of Logic]
\end_layout

\end_inset

.
 In the 1970s, Martin-Löf proposed a system with type-in-type that was shown
 logically unsound by Girard (as described in the introduction in 
\begin_inset CommandInset citation
LatexCommand cite
key "Martin-Lof-1972"
literal "false"

\end_inset

).
 In the 1980s, Cardelli explored the domain semantics of a system with general
 recursive dependent functions and type-in-type, and produced more good
 examples 
\begin_inset CommandInset citation
LatexCommand cite
key "cardelli1986polymorphic"
literal "false"

\end_inset

.
 
\end_layout

\begin_layout Standard
The first progress and preservation style proof of type soundness for a
 language with general recursive dependent functions and type-in-type that
 I am aware of comes form the Trellys Project 
\begin_inset CommandInset citation
LatexCommand cite
key "sjoberg2012irrelevance"
literal "false"

\end_inset

.
 At the time their language had several additional features not included
 in the surface language.
 Additionally, the surface language uses a simpler notion of definitional
 equality resulting in a simpler proof of type soundness.
 Later work in the Trellys Project
\begin_inset CommandInset citation
LatexCommand cite
key "casinghino2014combining,casinghino2014combiningthesis"
literal "false"

\end_inset

 used modalities to separate terminating and non-terminating fragments of
 the language, to allow both general recursion and logically sound reasoning
\begin_inset ERT
status open

\begin_layout Plain Layout

%, though the annotation burden seems high in retrospect
\end_layout

\end_inset

 .
 In general, the surface language has been deeply informed by the Trellys
 project
\begin_inset CommandInset citation
LatexCommand cite
key "sjoberg2012irrelevance"
literal "false"

\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "casinghino2014combining,casinghino2014combiningthesis"
literal "false"

\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "sjoberg2015programming"
literal "false"

\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "sjoberg2015dependently"
literal "false"

\end_inset

 and the Zombie language
\begin_inset Foot
status open

\begin_layout Plain Layout
https://github.com/sweirich/trellys
\end_layout

\end_inset

 it produced.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO type in type as a well wknown shortcut, videos of Andraj, Conner
 MB saying it 
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Implementations
\end_layout

\begin_layout Standard
Several programming language implementations support this combination of
 features (though none prove type soundness).
 Pebble
\begin_inset CommandInset citation
LatexCommand cite
key "10.1007/3-540-13346-1_1"
literal "false"

\end_inset

 was a very early language with dependent types, though conversion did not
 associate alpha equivalent types 
\begin_inset Foot
status open

\begin_layout Plain Layout
according to 
\begin_inset CommandInset citation
LatexCommand cite
key "Reinhold89typecheckingis"
literal "false"

\end_inset


\end_layout

\end_inset

.
 Coquand implemented an early bidirectional algorithm to type-check a language
 with type-in-type
\begin_inset CommandInset citation
LatexCommand cite
key "COQUAND1996167"
literal "false"

\end_inset

.
 Cayenne 
\begin_inset CommandInset citation
LatexCommand cite
key "10.1145/289423.289451"
literal "false"

\end_inset

 is a Haskell like language that combines dependent types with type-in-type
 and non-termination.
 Agda supports general recursion and type-in-type with compiler flags.
 Idris supports similar 
\begin_inset Quotes eld
\end_inset

unsafe
\begin_inset Quotes erd
\end_inset

 features.
\end_layout

\begin_layout Subsection
Other Dependent Type Systems
\end_layout

\begin_layout Standard
There are many flavors of dependent type systems that are similar in spirt
 to the language presented here, but maintain logical soundness at the expense
 of computation.
 
\end_layout

\begin_layout Standard
The Calculus of Constructions (CC, CoC)
\begin_inset CommandInset citation
LatexCommand cite
key "10.1016/0890-5401(88)90005-3"
literal "false"

\end_inset

 is one of the first minimal dependent type systems.
 It contains shockingly few rules, but can express a wide variety of constructio
ns via parametric encodings.
 The systems does not allow type in type, instead type
\begin_inset Foot
status open

\begin_layout Plain Layout
sometimes called 
\begin_inset Quotes eld
\end_inset

prop
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset

 lives in a larger universe 
\begin_inset Formula $\star:\Square$
\end_inset

, where 
\begin_inset Formula $\Square$
\end_inset

 is not considered a type.
 Even though the Calculus of Constructions does not allow type-in-type is
 it is still 
\series bold
impredicative 
\series default
in the sense that function types can quantify over 
\begin_inset Formula $\star$
\end_inset

 while still being in 
\begin_inset Formula $\star$
\end_inset

.
 For instance, the polymorphic identity 
\begin_inset Formula $(X:\star)\rightarrow X\rightarrow X$
\end_inset

 has type 
\begin_inset Formula $\star$
\end_inset

 so the polymorphic identity can be applied to itself.
 From the perspective of the surface language this impredictivity is modest,
 but still causes issues in the presence of classical logical assumptions.
 Many of the examples form this chapter are adapted from examples that were
 first worked out for the Calculus of Constructions.
\end_layout

\begin_layout Standard
Several other systems were developed that directly extended or modify the
 Calculus of Constructions.
 The Extended Calculus of Constructions (ECC)
\begin_inset CommandInset citation
LatexCommand cite
key "luo1990extended,luo1994computation"
literal "false"

\end_inset

, extends the calculus of constructions with a predicative hierarchy of
 universes and dependent pair types.
 The Implicit Calculus of Constructions (ICC)
\begin_inset CommandInset citation
LatexCommand cite
key "10.1007/3-540-45413-6_27,10.1007/978-3-540-78499-9_26"
literal "false"

\end_inset

 presents an extrinsic typing system
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Sometimes called 
\begin_inset Quotes eld
\end_inset

Curry-style
\begin_inset Quotes erd
\end_inset

, in contrast to intrinsic systems which are sometimes called 
\begin_inset Quotes eld
\end_inset

Church-style
\begin_inset Quotes erd
\end_inset

.
\end_layout

\end_inset

, unlike the Type Assignment System presented in this chapter, the Implicit
 Calculus of Constructions allows implicit qualification over terms in addition
 to explicit quantification over terms (also a hierarchy of universes, and
 a universe of 
\begin_inset Quotes eld
\end_inset

sets
\begin_inset Quotes erd
\end_inset

).
 Other extensions to the Calculus of Constructions that are primarily concerned
 with data (UCC, CIC) will be reviewed in chapter 4.
\end_layout

\begin_layout Standard
The lambda cube is a system for relating 8 interesting typed lambda caluli
 in relation to each other.
 Presuming terms should always depend on terms, there are 3 additional dimension
s of dependency: term depending on types, types dependent on types, and
 types depending on terms.
 The simply typed lambda calculus has only term dependency.
 System F additionally allows Types to depend on types.
 The Calculus of Constructions has all forms of dependency
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Recommended reading Chapter 14 
\begin_inset CommandInset citation
LatexCommand cite
key "sorensen2006lectures"
literal "false"

\end_inset


\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO bresumably Barndrct was the first one to put it in a cube
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Pure Type Systems (PTS)
\begin_inset Foot
status open

\begin_layout Plain Layout
previously called 
\begin_inset Quotes eld
\end_inset

Generalized Type Systems
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset

 generalize the lambda cube to allow any number of type universe with any
 forms of dependency.
 Notably this includes the system with one type universe where type-in-type.
 Universe hierarchies can also be embedded in a PTS.
 The system described in this chapter is almost a PTS, except that it contains
 unrestricted recursion and the method of type annotation is different.
 All pure type systems such as System F and the Calculus of Constructions
 have corresponding terms in the the Surface Language, by renaming their
 type universes into the surface language type universe.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO citations for PTS: (Terlouw, 1989; Berardi, 1988; Barendregt, 1991,
 1992; Jutting, McKinna, and Pollack, 1994; McKinna and Pollack, 1993; Pollack,
 1994).
 Acording to TAPL
\end_layout

\end_inset


\end_layout

\begin_layout Standard
As previously mentioned Martin Lof Type Theory (MTLL) 
\begin_inset CommandInset citation
LatexCommand cite
key "Martin-Lof-1972"
literal "false"

\end_inset

 is one of the oldest frameworks for dependent type systems.
 MTLL is designed to be open, so that new constructs can be added with the
 appropriate introduction, elimination, and typing rules.
 The base system comes with a predicative hierarchy of universes, and at
 least dependently typed functions and a propositional equality type.
 The system has two flavors characterized by it's handling of definitional
 equality.
 If types are only identified by convertibility (as ever system described
 so far) it is called Intentional Type Theory (ITT).
 If the system allows proofs of equality to associate types, it is called
 Extensional Type Theory.
 Since MTLL is open ended the Calculus of Constructions can be added to
 it as a subsystem
\begin_inset CommandInset citation
LatexCommand cite
key "aspinall2004dependent,hofmann1997extensional"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO go back to Russle?
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO sloving universe constraints
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% avoid data heavey presentations (LIKE UTT, CIC) until CH4
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO read through the inro of https://link.springer.com/book/10.1007/978-1-4471-0
963-1#toc when was it published? what is the relation to his thesis? Is
 chapter 1 https://www.tcs.ifi.lmu.de/mitarbeiter/martin-hofmann/pdfs/syntaxandseman
ticsof-dependenttypes.pdf worth skiming theough eiterh way 
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintCited"
bibfiles "/Users/stephaniesavir/thesis/bibliography/dtest"
options "alpha"

\end_inset


\end_layout

\begin_layout Section
TODO
\end_layout

\begin_layout Itemize
include references from https://www.lix.polytechnique.fr/~vsiles/papers/PTSATR.pdf
\end_layout

\begin_layout Itemize
discuss 
\end_layout

\begin_deeper
\begin_layout Itemize
g : (f : nat -> bool) -> (fpr : (x :Nat -> IsEven x -> f x = Bool) -> Bool
\end_layout

\begin_layout Itemize
g f _ = f 2
\end_layout

\end_deeper
\begin_layout Itemize
in the presence of non terminating proof functions
\end_layout

\begin_deeper
\begin_layout Itemize
g : (n : Nat) -> (fpn : (x : IsEven n) -> Bool
\end_layout

\begin_layout Itemize
g f _ = f 2
\end_layout

\end_deeper
\begin_layout Itemize
example of non-terminating functions being equal
\end_layout

\begin_layout Itemize
caveat about unsupported features
\end_layout

\begin_layout Itemize
go through previous stack overflow questions to remindmyself about past
 confusion.
\end_layout

\begin_layout Itemize
make usre implementation is smooth around this
\end_layout

\begin_layout Itemize
write up style guide
\end_layout

\begin_layout Itemize
NuPRl bar types 
\begin_inset Quotes eld
\end_inset

Constable and Smith had papers at LICS around 1987 or so, leading to both
 Smith’s and Crary’s theses on the topic
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Section
unused
\end_layout

\begin_layout Standard
Triangle Property
\end_layout

\begin_layout Standard
\begin_inset Formula $\ensuremath{\forall{\color{red}m},{\color{red}m'}.\:{\color{red}m\Rrightarrow m'}\:\rightarrow\:{\color{red}m}{\color{blue}\Rrightarrow max\left(m\right)}\:\wedge\:{\color{red}m'}{\color{blue}\Rrightarrow max\left(m\right)}}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzcd}
\end_layout

\begin_layout Plain Layout


\backslash
mathbin{
\backslash
color{red}m} 
\backslash
tarrow[red]{r} 
\backslash
tarrow[blue]{d} & 
\backslash
mathbin{
\backslash
color{red}m'} 
\backslash
tarrow[blue]{ld} 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
mathbin{
\backslash
color{blue}max(m)}                  &              
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzcd}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $\forall{\color{red}m},{\color{red}m'},{\color{red}n}.\:{\color{red}m\Rrightarrow m'}\:\wedge\:{\color{red}m\Rrightarrow_{\ast}n}\:\rightarrow\:\exists{\color{blue}n'}.\:{\color{red}m'}{\color{blue}\Rrightarrow_{\ast}n'}\:\wedge\:{\color{red}n}{\color{blue}\Rrightarrow n'}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzcd}
\end_layout

\begin_layout Plain Layout

% TODO look into proper subscripting of arrow heads
\end_layout

\begin_layout Plain Layout

              & {
\backslash
color{red}m} 
\backslash
tarrow[red]{rd}[label={[pos=1,inner sep=0,outer sep=0]0:${
\backslash
ast}$}]{} 
\backslash
tarrow[red]{ld} &              
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

{
\backslash
color{red}m'}  
\backslash
tarrow[blue]{rd}[label={[pos=1,inner sep=0,outer sep=0]0:${
\backslash
ast}$}]{} &                         & {
\backslash
color{red}m} 
\backslash
tarrow[blue]{ld} 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

              & {
\backslash
color{blue}m'}                      &                              
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzcd}
\end_layout

\end_inset


\end_layout

\end_body
\end_document
