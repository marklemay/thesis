#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\begin_preamble
\usepackage{xcolor}
\usepackage{tikz-cd}
\tikzcdset{%
    triple line/.code={\tikzset{%
        double equal sign distance, % replace by double distance = 'measure' 
        double=\pgfkeysvalueof{/tikz/commutative diagrams/background color}}},
    quadruple line/.code={\tikzset{%
        double equal sign distance, % replace by double distance = 'measure'
        double=\pgfkeysvalueof{/tikz/commutative diagrams/background color}}},
    Rrightarrow/.code={\tikzcdset{triple line}\pgfsetarrows{tikzcd implies cap-tikzcd implies}},
    RRightarrow/.code={\tikzcdset{quadruple line}\pgfsetarrows{tikzcd implies cap-tikzcd implies}}
}    
\newcommand*{\tarrow}[2][]{\arrow[Rrightarrow, #1]{#2}\arrow[dash, shorten >= 0.5pt, #1]{#2}}
\newcommand*{\qarrow}[2][]{\arrow[RRightarrow, #1]{#2}\arrow[equal, double distance = 0.25pt, shorten >= 1.28pt, #1]{#2}}
\end_preamble
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize letterpaper
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 1cm
\topmargin 1cm
\rightmargin 1cm
\bottommargin 1cm
\headheight 1cm
\headsep 1cm
\footskip 1cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 2
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Chapter 2 (draft)
\end_layout

\begin_layout Part
Surface language
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%% TODO notes
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%% don't love this intro
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% overview, why
\end_layout

\end_inset


\end_layout

\begin_layout Standard
In an ideal world programmers would write perfect code whose correctness
 is perfectly proven.
 The 
\series bold
Surface Language
\series default
 models this ideal, but difficult, system.
 Programmers should 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

"
\end_layout

\end_inset

think
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

"
\end_layout

\end_inset

 in the surface language, and the machinery of later sections should reinforce
 an understanding of the surface type system, while being transparent to
 the programmer.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% overview, What
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The surface language presented in this chapter is a minimal dependent type
 system.
 It will serve both as foundation for further chapters.
 As much as possible, the syntax use's standard modern notation 
\begin_inset Foot
status open

\begin_layout Plain Layout
several alternative syntax exist in the literature, (TODO weird french bracket
 notation) , Martin hoffmen (TODO PI notation) 
\end_layout

\end_inset

.
 The semantics are intended to be as simple as possible and compatible with
 other well studied intentional dependent type theories 
\begin_inset Foot
status open

\begin_layout Plain Layout
most terms in this chapter could be translated into the calculus of construction
s, or other pure type systems, (TODO actually test that these could all
 be plugged into agda with approrite flags)
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% overview, What
\end_layout

\end_inset


\end_layout

\begin_layout Standard
I deviate from a standard dependent type theory to include features to ease
 programming at the expense of correctness.
 Specifically the language allows general recursion, since general recursion
 is useful for general purpose functional programming.
 type-in-type is also supported since it simplifies the system for programmers,
 and makes the meta-theory easier when logical soundness has been abandoned.
 Despite this, type soundness is a achievable and a practical type checking
 algorithm is given.
\end_layout

\begin_layout Standard
Though similar systems have been studied over the last few decades this
 chapter aims to give a self contained presentation, along with many examples.
 The surface language has been an excellent platform to conduct research
 into full spectrum dependent type theory, and hopefully this exposition
 will be helpful introduction for other researchers.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% name the lang
\end_layout

\end_inset


\end_layout

\begin_layout Section
Formal Surface Language
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% What syntax
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The syntax is in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:surface-pre-syntax"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 There is no syntactic destination between types and terms, as is common
 in full-spectrum systems.
 However, I will follow the convention that capital letters are used in
 positions that are intended as types, and lowercase letters are used when
 the expression may be a term.
 Location data 
\begin_inset Formula $\ensuremath{\ell}$
\end_inset

 is marked at every position where a type error might occur.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: examples?need to say about the relative association of m and M?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: recursive f?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="16" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="none" valignment="top" usebox="none" special="l">
\begin_inset Text

\begin_layout Plain Layout
source labels,
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\ensuremath{\ell}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
...
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $.$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
no source label
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="none" valignment="top" usebox="none" special="l">
\begin_inset Text

\begin_layout Plain Layout
type contexts,
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lozenge$
\end_inset

 | 
\begin_inset Formula $\Gamma,x:M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="none" valignment="top" usebox="none" special="l">
\begin_inset Text

\begin_layout Plain Layout
expressions,
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m,n,M,N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m::_{\ensuremath{\ell}}M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
annotation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
type universe
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:M_{\ensuremath{\ell}}\right)\rightarrow N_{\ensuremath{\ell'}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function type
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m_{\ensuremath{\ell}}\,n$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
application
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="none" valignment="top" usebox="none" special="l">
\begin_inset Text

\begin_layout Plain Layout
values,
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
v
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x$
\end_inset

 | 
\begin_inset Formula $\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:M_{\ensuremath{\ell}}\right)\rightarrow N_{\ensuremath{\ell'}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Surface Language Pre-Syntax
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-pre-syntax"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: This is almost a pure type system
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="5">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:M\right)\rightarrow N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
written
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $M\rightarrow N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
when 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x\notin fv\left(N\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
written
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda x\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
when 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $f\notin fv\left(m\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda x\Rightarrow\lambda y\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
written
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda x\,y\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
written
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
when 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x\notin fv\left(m\right)$
\end_inset

 when 
\begin_inset Formula $x$
\end_inset

 binds 
\begin_inset Formula $m$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m::_{\ensuremath{\ell}}M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
written
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m::M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
when 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\ensuremath{\ell}$
\end_inset

 is irrelevant
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:M_{\ensuremath{\ell}}\right)\rightarrow N_{\ensuremath{\ell'}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
written
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:M\right)\rightarrow N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
when 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\ensuremath{\ell}$
\end_inset

, 
\begin_inset Formula $\ensuremath{\ell}'$
\end_inset

 are irrelevant
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m_{\ensuremath{\ell}}\,n$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
written
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m_{\ensuremath{}}\,n$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
when 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\ensuremath{\ell}$
\end_inset

 is irrelevant
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: proper underscoring
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Surface Language Abbreviations
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-pre-syntax-abrev"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Examples
\end_layout

\begin_layout Standard
The surface system is extremely expressive.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="18" columns="8">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\perp_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:\star\right)\rightarrow x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Void, empty type, logical False
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Unit_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(A:\star\right)\rightarrow A\rightarrow A$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Unit, logical True
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $tt_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\lambda-\,a\Rightarrow a$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Unit_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
trivial proposition, polymorphic identity
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbb{B}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\left(A:\star\right)\rightarrow A\rightarrow A\rightarrow A$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
booleans
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $true_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\lambda-\,then\,-\Rightarrow then$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbb{B}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
boolean true
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $false_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\lambda-\,-\,else\Rightarrow else$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbb{B}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
boolean false
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x:\mathbb{B}_{c},y:\mathbb{B}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x\,\&_{c}\,y$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\lambda A\Rightarrow x\,A\,\left(y\,A\right)\,\left(false_{c}\,A\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbb{B}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
boolean and
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x:\mathbb{B}_{c},y:\mathbb{B}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x\,\&_{c}\,y$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\lambda A\,then\,else\Rightarrow x\,\mathbb{B}_{c}\,y\,else$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
BAD boolean and
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(A:\star\right)\rightarrow(A\rightarrow A)\rightarrow A\rightarrow A$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
natural numbers
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda-\,-\,z\Rightarrow z$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda-\,s\,z\Rightarrow s\,z$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda-\,s\,z\Rightarrow s\left(s\,z\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda-\,s\,z\Rightarrow s^{n}\,z$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x:\mathbb{N}_{c},y:\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x+_{c}y$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda A\,s\,z\Rightarrow x\,A\,s\,\left(y\,A\,s\,z\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lnot_{c}X$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x\rightarrow\perp_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
logical negation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X:\star,x_{1}:X,x_{2}:X$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x_{1}\doteq_{X}x_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(C:\left(X\rightarrow\star\right)\right)\rightarrow C\,x_{1}\rightarrow C\,x_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Leibniz equality
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X:\star,x:X$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $refl_{x:X}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda-\,cx\Rightarrow cx$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x\doteq_{X}x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: remove bad versions
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: boolean not?
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: suc, pred as an example of an unpleasant encoding, also citation
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: symetry, trans
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: list, vec, singleton
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: check in agda
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: 3 eq assignment?
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: TODo footnote on Leibniz equality for alt encoding 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: apure abouse of notation allows quantifiaction from function types
 or lambda or a combintation
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Surface Language Constructions
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-constructions"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Church encodings
\end_layout

\begin_layout Standard
Data types are expressible using Church encodings, (in the style of System
 F).
 Church encodings embed the elimination principle of data into continuations.
 So for instance Booleans data is eliminated against true and false, 2 tags
 with no additional data.
 This is more recognizable as an if-then-else construct.
 So 
\begin_inset Formula $\mathbb{B}_{c}$
\end_inset

 encodes the possibility of choices, 
\begin_inset Formula $true_{c}$
\end_inset

 picks the first branch, and 
\begin_inset Formula $false_{c}$
\end_inset

 picks the false branch.
\end_layout

\begin_layout Standard
Natural numbers are encodable against 2 tags, 0 and s, where s also contains
 one smaller number.
 So 
\begin_inset Formula $\mathbb{N}_{c}$
\end_inset

 encodes the possibility of choices, 
\begin_inset Formula $(A\rightarrow A)$
\end_inset

 decides how to recursively handle the prior number in the s case, and the
 2nd argument specifies how to handle the false branch.
 This can be viewed as a simple looping construct with temporary storage.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: church encoding citation
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: why church encoding?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: not necisarily convineint
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Predicate encodings
\end_layout

\begin_layout Standard
With dependent types, logical predicates can be encoded (in the style of
 Calculus of Constructions).
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: ...
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Leibniz equality
\end_layout

\begin_layout Standard
One of the most potent and interesting propositions is the proposition of
 equality.
 Phrased as here, it is often called Leibniz equality since 2 terms are
 equal when they behave the same on all propositions and this identification
 of indiscernibles is called 
\begin_inset Quotes eld
\end_inset

Leibniz law
\begin_inset Quotes erd
\end_inset

 in philosophy
\begin_inset Foot
status open

\begin_layout Plain Layout
Leibniz assumed a metaphysical notion of identification of 
\begin_inset Quotes eld
\end_inset

substance
\begin_inset Quotes erd
\end_inset

s, not a mathematical notion of equality.
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: 
\begin_inset Quotes eld
\end_inset

Leibniz asserted the identity of indiscernibles: two objects are equal if
 and only if they satisfy the same properties (Leibniz, 1686)
\begin_inset Quotes erd
\end_inset

 https://homepages.inf.ed.ac.uk/wadler/papers/leibniz/leibniz.pdf
\end_layout

\begin_layout Plain Layout

% section 9 ish, sort of asmed tobe true 
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Large Eliminations
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: doulbe check large elimination def (write it here)
\end_layout

\begin_layout Plain Layout

% consistent with the notes here: https://github.com/RobertHarper/hott-notes/blob
/5339576f55a4b7f5d04734370a5117491c44b1fe/notes_week5.tex#L155
\end_layout

\begin_layout Plain Layout

% would like better explanaition
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Quotes eld
\end_inset

Large eliminations
\begin_inset Quotes erd
\end_inset

 can be simulated with type-in-type.
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\lambda b\Rightarrow b\,\star\,Unit_{c}\,\perp_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbb{B}_{c}\rightarrow\star$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda n\Rightarrow n\,\star\,(\lambda-\Rightarrow Unit_{c})\,\perp_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbb{N}_{c}\rightarrow\star$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
Note that such functions are not possible in the Calculus of Constructions,
 and is used to motivate the extension to the Calculus of Inductive Construction
s.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: citation for CIC?
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Inequalities
\end_layout

\begin_layout Standard
Large eliminations can be used to prove inequalities that can be hard or
 impossible to express in other minimal dependent type theories such as
 the calculus of constructions.
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\lambda pr\Rightarrow pr\,\left(\lambda x\Rightarrow x\right)\,\perp_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lnot_{c}\star\doteq_{\star}\perp_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
the type universe is distinct from Logical False
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\lambda pr\Rightarrow pr\,\left(\lambda x\Rightarrow x\right)\,tt_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lnot_{c}Unit_{c}\doteq_{\star}\perp_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Logical True is distinct from Logical False
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda pr\Rightarrow pr\,\left(\lambda b\Rightarrow b\,\star\,Unit_{c}\,\perp_{c}\right)\,tt_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lnot true_{c}\doteq_{\mathbb{B}_{c}}false_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda pr\Rightarrow pr\,\left(\lambda n\Rightarrow n\,\star\,(\lambda-\Rightarrow Unit_{c})\,\perp_{c}\right)\,tt_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lnot1_{c}\doteq_{\mathbb{N}_{c}}0_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: 1st not sensible in CC
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: 2 possiblely in CC?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Note that a proof of 
\begin_inset Formula $\lnot1_{c}\doteq_{\mathbb{N}_{c}}0_{c}$
\end_inset

 is not possible in the Calculus of Constructions
\begin_inset CommandInset citation
LatexCommand cite
key "10.2307/2274575"
literal "false"

\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
Martin Hofmann gives a more semantic proof in ...
 and excellently motivates the reasoning in 
\begin_inset CommandInset citation
LatexCommand cite
key "hofmann1997syntax"
literal "false"

\end_inset

(incorrect citation) Exercises 2.5, 2.6, 3.7, 3.25, 3.26, 3.43, 3.44
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: citation is actually for an MLTT, bleh
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: cite origional and cleaned up in M.
 Hoffman
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Recursion
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: GCD, recursive types
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
\begin_inset Formula $\left(x:\mathbb{N}_{c}\right)\rightarrow0_{c}\,+_{c}\,x=_{\mathbb{N}_{c}}x\,+_{c}\,0_{c}$
\end_inset

 (by recursion)
\end_layout

\begin_layout Standard
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow x\,\left(0_{c}\,+_{c}\,x=_{\mathbb{N}_{c}}x\,+_{c}\,0_{c}\right)\,f\,\left(refl_{0_{c}:\mathbb{N}_{c}}\right)\qquad:\left(x:\mathbb{N}_{c}\right)\rightarrow0_{c}\,+_{c}\,x=_{\mathbb{N}_{c}}x\,+_{c}\,0_{c}$
\end_inset


\end_layout

\begin_layout Standard
TODO: check and discuss, structural recursion
\end_layout

\begin_layout Subsection
logical unsoundness and Nontermination
\end_layout

\begin_layout Standard
The surface language is 
\begin_inset Quotes eld
\end_inset

logically unsound
\begin_inset Quotes erd
\end_inset

, every type is inhabited.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: proper example formatting
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Every type is inhabited (by recursion)
\end_layout

\begin_layout Standard
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow f\,x\qquad:\perp_{c}$
\end_inset


\end_layout

\begin_layout Subsubsection
Every type is inhabited (by Type-in-type)
\end_layout

\begin_layout Standard
It is possible to encode Gerard's paradox, producing another source of logical
 unsoundness.
 A subtle form of recursive behavior can be built out of Gerard's paradox
\begin_inset CommandInset citation
LatexCommand cite
key "Reinhold89typecheckingis"
literal "false"

\end_inset

, but this behavior is no worse then the unrestricted recursion already
 allowed.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: cite stuff (see https://stackoverflow.com/questions/18178999/do-agda-prog
rams-necessarily-terminate)
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
logical unsoundness
\end_layout

\begin_layout Standard
While the surface language supports proofs, not every term typed in the
 surface language is a proof.
\end_layout

\begin_layout Standard
Logical soundness seems not to matter in programming practice.
 For instance, in ML the type 
\begin_inset Formula $\mathtt{f:Int->Int}$
\end_inset

 does not imply the termination of 
\begin_inset Formula $\mathtt{f\,2}$
\end_inset

.
 While unproductive non-termination is always a bug, it seems an easy bug
 to detect and fix when it occurs.
 In mainstream languages, types help to communicate the intent of termination,
 even though termination is not guaranteed by the type system.
 Importantly, no desirable computation is prevented in order to preserve
 logical soundness.
 By the haling problem there will never be a way to include all the terminating
 computations and exclude all the nonterminating computations.
 Therefore, logical unsoundness seems suitable for a dependently typed programmi
ng language.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: talk about alternatives.
  cite proofs of nontermination
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The most popular ....
 Forcing logical soundness incurs a real cost...
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: could still preform checks
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Terms can still be called proofs as long as the safety of recursion and
 type-in-type are monitored externally.
 In this sense the inequalities listed are proofs, they make no use of general
 recursion and match implementations from CIC such that universe hierarchies
 could be assigned.
 External means can still verify the desired properties, an automated process
 could supply warnings when unsafe constructs are used, traditional software
 testing can be used to discover proof bugs.
 Even though the system is not logically sound, neither are informal paper
 and pencil proofs.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: add ref to inequalities
\end_layout

\end_inset


\end_layout

\begin_layout Standard
This architecture is resilient to change.
 Where a change in the termination checking code of Coq might cause a proof
 script to no longer run, here the code will always behave in the same way.
\end_layout

\begin_layout Subsection
Further examples
\end_layout

\begin_layout Standard
There are more examples in 
\begin_inset CommandInset citation
LatexCommand cite
key "cardelli1986polymorphic"
literal "false"

\end_inset

 where Cardelli has studied a similar system.
 All Pure Type Systems
\begin_inset Foot
status open

\begin_layout Plain Layout
previously called 
\begin_inset Quotes eld
\end_inset

Generalized type systems
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset

 can translate into the Surface Language by accumulating their type universes
 into the surface type universe.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: other sources of examples
\end_layout

\end_inset


\end_layout

\begin_layout Section
Surface Language Type Assignment System
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\Gamma\vdash\quad x:M\in\Gamma}{\Gamma\vdash x\,:\,M}\,\textrm{ty-var}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\Gamma\vdash m\,:\,M\quad\Gamma\vdash M\,:\,\star}{\Gamma\vdash m::_{\ell}M\,:\,M}\,\textrm{ty-::}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\Gamma\vdash}{\Gamma\vdash\star\,:\,\star}\,\textrm{ty-}\star
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\Gamma\vdash M\,:\,\star\quad\Gamma,x:M\vdash N\,:\,\star}{\Gamma\vdash\left(x:M\right)\rightarrow N\,:\,\star}\,\textrm{ty-fun-ty}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\Gamma\vdash m\,:\,\left(x:N\right)\rightarrow M\quad\Gamma\vdash n\,:\,N}{\Gamma\vdash m\,n\,:\,M\left[x\coloneqq n\right]}\,\textrm{ty-fun-app}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m\,:\,M}{\Gamma\vdash\mathsf{fun}\,f\,x\Rightarrow m\,:\,\left(x:N\right)\rightarrow M}\,\textrm{ty-fun}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\Gamma\vdash m\,:\,M\quad M\equiv M'}{\Gamma\vdash m\,:\,M'}\,\textrm{ty-conv}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: Note the location needs explanation
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: make names match red names, write up style guide
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Surface Language Type Assignment System
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-reduction-TAS"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% meta-theory type soundness
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

 The type assignment system is type sound, 
\begin_inset Quotes eld
\end_inset

well typed programs don't get stuck
\begin_inset Quotes erd
\end_inset

.
 This can be shown with a progress and preservation style proof, with a
 suitable definition of the 
\begin_inset Formula $\equiv$
\end_inset

 relation.
\begin_inset ERT
status open

\begin_layout Plain Layout

% cite mattias?
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

The progress/preservation style proof requires 
\begin_inset Formula $\equiv$
\end_inset

 be
\end_layout

\begin_layout Itemize
reflexive
\end_layout

\begin_layout Itemize
symmetric
\end_layout

\begin_layout Itemize
transitive
\end_layout

\begin_layout Itemize
closed under (well typed) substitution 
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO closed under conjigation
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
preserves typing
\end_layout

\begin_layout Itemize
\begin_inset Formula $\star\cancel{\equiv}\left(x:N\right)\rightarrow M$
\end_inset

 does not associate type constructors
\end_layout

\begin_layout Standard
it further helps if 
\begin_inset Formula $\equiv$
\end_inset

 is 
\end_layout

\begin_layout Itemize
closed under normalization
\end_layout

\begin_layout Standard
A particularly simple definition of 
\begin_inset Formula $\equiv$
\end_inset

 is equating any terms that share a reduct via a system of parallel reductions
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{m\Rrightarrow_{\ast}\,n\quad m'\Rrightarrow_{\ast}\,n}{m\equiv m'}\,\equiv\textrm{-Def}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO incorrect do to source lableing, assume that all source locations
 are equal
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
reflexive by defintion
\end_layout

\begin_layout Itemize
symmetric automatically
\end_layout

\begin_layout Itemize
transitive if 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 is confluent
\end_layout

\begin_layout Itemize
closed under substitution if 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 is closed under substitution 
\end_layout

\begin_layout Itemize
preserves types, if 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 preserves types
\end_layout

\begin_layout Itemize
\begin_inset Formula $\star\cancel{\equiv}\left(x:N\right)\rightarrow M$
\end_inset

 does not associate type constructors since 
\begin_inset Formula $\left(x:N\right)\rightarrow M\cancel{\Rrightarrow_{\ast}}\star$
\end_inset

 
\end_layout

\begin_layout Itemize
closed under normalization automatically
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\,}{x\Rrightarrow x}\,\textrm{\Rrightarrow-var}
\]

\end_inset


\begin_inset Formula 
\[
\frac{m\Rrightarrow m'}{m::_{\ensuremath{\ell}}M\Rrightarrow m'}\,\textrm{\Rrightarrow-::-red}
\]

\end_inset


\begin_inset Formula 
\[
\frac{m\Rrightarrow m'\quad M\Rrightarrow M'}{m::_{\ensuremath{\ell}}M\Rrightarrow m'::_{\ensuremath{\ensuremath{\ell}'}}M'}\,\textrm{\Rrightarrow-::}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\,}{\star\Rrightarrow\star}\,\textrm{\Rrightarrow-}\star
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{M\Rrightarrow M'\quad N\Rrightarrow N'}{\left(x:M_{\ell}\right)\rightarrow N_{\ell'}\Rrightarrow\left(x:M'_{\ensuremath{\ell}''}\right)\rightarrow N'_{\ensuremath{\ell}'''}}\,\textrm{\Rrightarrow-fun-ty}
\]

\end_inset


\begin_inset Formula 
\[
\frac{m\Rrightarrow m'\quad n\Rrightarrow n'}{\left(\mathsf{fun}\,f\,x\Rightarrow m\right)_{\ell}n\Rrightarrow m'\left[f\coloneqq\mathsf{fun}\,f\,x\Rightarrow m',x\coloneqq n'\right]}\,\textrm{\Rrightarrow-fun-app-red}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{m\Rrightarrow m'}{\mathsf{fun}\,f\,x\Rightarrow m\,\Rrightarrow\,\mathsf{fun}\,f\,x\Rightarrow m'}\,\textrm{\Rrightarrow-fun}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{m\Rrightarrow m'\quad n\Rrightarrow n'}{m_{\ell}\,n\Rrightarrow m'_{\ell'}\,n'}\,\textrm{\Rrightarrow-fun-app}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: Note the location data makes this dangerous
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Surface Language Parallel Reductions
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-reduction"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\,}{m\Rrightarrow_{\ast}m}\,\textrm{\Rrightarrow_{\ast}-refl}
\]

\end_inset


\begin_inset Formula 
\[
\frac{m\Rrightarrow_{\ast}m'\;m'\Rrightarrow m''}{m\Rrightarrow_{\ast}m''}\,\textrm{\Rrightarrow_{\ast}-trans}
\]

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Transitive-Reflexive-Closure
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-reduction-1"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Parallel reductions are defined to make those properties easier to prove.
 
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO why?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
While this is a simple definition of equality and reduction, others choices
 are possible, for instance it is possible to extend the relation with contextua
l information, type information, or even explicit proofs of equality as
 in ITT.
 
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO a little too scatterd so consider revising
\end_layout

\end_inset

 It is also common in the literature to assume the properties of 
\begin_inset Formula $\equiv$
\end_inset

 hold without proof.
\end_layout

\begin_layout Subsection
Equality
\end_layout

\begin_layout Subsubsection
\begin_inset Formula $\Rrightarrow$
\end_inset

, 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

, 
\begin_inset Formula $\equiv$
\end_inset

 are reflexive
\end_layout

\begin_layout Standard
The following rule is admissible,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{m}{m\Rrightarrow\,m}\,\textrm{\Rrightarrow-refl}
\]

\end_inset


\end_layout

\begin_layout Standard
by induction on the syntax of 
\begin_inset Formula $m$
\end_inset


\end_layout

\begin_layout Standard
Recall that 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 is reflexive by definition so
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{m}{m\equiv m}\,\textrm{\equiv-refl}
\]

\end_inset


\end_layout

\begin_layout Standard
is admissible.
\end_layout

\begin_layout Subsubsection
\begin_inset Formula $\Rrightarrow$
\end_inset

, 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

, 
\begin_inset Formula $\equiv$
\end_inset

 are closed under substitutions.
\end_layout

\begin_layout Standard
The following rule is admissible for every substitution 
\begin_inset Formula $\sigma$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO define substitutions, what properties are needed over substitutions?
 
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO is this lemma needed or is it jsut to accomodate stupid binding stuff
 in coq 
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{m\Rrightarrow m'}{m\left[\sigma\right]\Rrightarrow m'\left[\sigma\right]}\,\textrm{\Rrightarrow-sub-\sigma}
\]

\end_inset


\end_layout

\begin_layout Standard
by induction on the 
\begin_inset Formula $\Rrightarrow$
\end_inset

 relation, using 
\begin_inset Formula $\textrm{\Rrightarrow-refl}$
\end_inset

 in the 
\begin_inset Formula $\textrm{\Rrightarrow-var}$
\end_inset

 case.
\end_layout

\begin_layout Standard
The following rule is admissible where 
\begin_inset Formula $\sigma$
\end_inset

, 
\begin_inset Formula $\tau$
\end_inset

 is a substitution where for every 
\begin_inset Formula $x$
\end_inset

, 
\begin_inset Formula $\sigma\left(x\right)\Rrightarrow\tau\left(x\right)$
\end_inset

, written 
\begin_inset Formula $\sigma\Rrightarrow\tau$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{m\Rrightarrow m'\quad\sigma\Rrightarrow\tau}{m\left[\sigma\right]\Rrightarrow m'\left[\tau\right]}\,\textrm{\Rrightarrow-sub}
\]

\end_inset


\end_layout

\begin_layout Standard
by induction on the 
\begin_inset Formula $\Rrightarrow$
\end_inset

 relation.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{m\Rrightarrow_{\ast}m'\quad\sigma\Rrightarrow\tau}{m\left[\sigma\right]\Rrightarrow_{\ast}\,m'\left[\tau\right]}\,\textrm{\Rrightarrow_{\ast}-sub}
\]

\end_inset


\end_layout

\begin_layout Standard
is admissible by induction on the 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 relation.
 And follows that 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{m\equiv m'\quad\sigma\Rrightarrow\tau}{m\left[\sigma\right]\equiv m'\left[\tau\right]}\,\textrm{\equiv-sub}
\]

\end_inset


\end_layout

\begin_layout Standard
is admissible.
\end_layout

\begin_layout Subsubsection
\begin_inset Formula $\Rrightarrow$
\end_inset

, 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 is confluent, 
\begin_inset Formula $\equiv$
\end_inset

 is transitive
\end_layout

\begin_layout Standard
Confluent
\begin_inset Foot
status open

\begin_layout Plain Layout
also 
\begin_inset Quotes eld
\end_inset

Church-Rosser
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
By defining normalization with parallel reductions we can show confluence
 using the methods shown in 
\begin_inset CommandInset citation
LatexCommand cite
key "TAKAHASHI1995120"
literal "false"

\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
also well presented in 
\begin_inset CommandInset citation
LatexCommand cite
key "KOKKE2020102440"
literal "false"

\end_inset


\end_layout

\end_inset

.
 First define a function 
\begin_inset Formula $max$
\end_inset

 that takes the maximum possible parallel step, such that if 
\begin_inset Formula $m\Rrightarrow\,m'$
\end_inset

 then 
\begin_inset Formula $m'\Rrightarrow\,max\left(m\right)$
\end_inset

 and 
\begin_inset Formula $m\Rrightarrow\,max\left(m\right)$
\end_inset

, referred to as the triangle property.
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="5">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $max($
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\mathsf{fun}\,f\,x\Rightarrow m\right)_{\ensuremath{\ell}}\,n$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $)=$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $max\left(m\right)\left[f\coloneqq\mathsf{fun}\,f\,x\Rightarrow max\left(m\right),x\coloneqq max\left(n\right)\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
otherwise
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $max($
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $)=$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $max($
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m::_{\ensuremath{\ell}}M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $)=$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $max\left(m\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $max($
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $)=$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $max($
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:M_{\ensuremath{\ell}}\right)\rightarrow N_{\ensuremath{\ell'}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $)=$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:max\left(M\right)_{\ensuremath{\ell}}\right)\rightarrow max\left(N\right)_{\ensuremath{\ell'}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $max($
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $)=$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow max\left(m\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $max($
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m_{\ensuremath{\ell}}\,n$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $)=$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $max\left(m\right)_{\ensuremath{\ell}}\,max\left(n\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO for example, also diagrams
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
Triangle Property
\end_layout

\begin_layout Plain Layout
\begin_inset Formula $\ensuremath{\forall{\color{red}m},{\color{red}m'}.\:{\color{red}m\Rrightarrow m'}\:\rightarrow\:{\color{red}m'}{\color{blue}\Rrightarrow max\left(m\right)}}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzcd}
\end_layout

\begin_layout Plain Layout


\backslash
mathbin{
\backslash
color{red}m} 
\backslash
tarrow[red]{r} 
\backslash
arrow[lightgray]{d} & 
\backslash
mathbin{
\backslash
color{red}m'} 
\backslash
tarrow[blue]{ld} 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
mathbin{
\backslash
color{blue}max(m)}                  &              
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzcd}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
Diamond Property
\end_layout

\begin_layout Plain Layout
\begin_inset Formula $\forall{\color{red}m},{\color{red}m'},{\color{red}m''}.\:{\color{red}m\Rrightarrow m'}\:\wedge\:{\color{red}m\Rrightarrow m''}\:\rightarrow\:{\color{red}m'}{\color{blue}\Rrightarrow max\left(m\right)}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzcd}
\end_layout

\begin_layout Plain Layout

               & {
\backslash
color{red}m} 
\backslash
tarrow[red]{rd} 
\backslash
tarrow[red]{ld} 
\backslash
arrow[lightgray]{dd} &                
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

{
\backslash
color{red}m'} 
\backslash
tarrow[blue]{rd} &                                       & {
\backslash
color{red}m''} 
\backslash
tarrow[blue]{ld} 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

               & {
\backslash
color{blue}max(m)}                                &               
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzcd}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
Confluence
\end_layout

\begin_layout Plain Layout
\begin_inset Formula $\forall{\color{red}m},{\color{red}n},{\color{red}n'}.\:{\color{red}m\Rrightarrow_{\ast}n}\:\wedge\:{\color{red}m\Rrightarrow_{\ast}n'}\:\rightarrow\:\exists{\color{blue}n'''}.\:{\color{red}n}{\color{blue}\Rrightarrow_{\ast}{\color{blue}n'''}}\:\wedge\:{\color{red}n'}{\color{blue}\Rrightarrow{\color{blue}n'''}}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzcd}
\end_layout

\begin_layout Plain Layout

% TODO look into proper subscripting of arrow heads
\end_layout

\begin_layout Plain Layout

              & {
\backslash
color{red}m} 
\backslash
tarrow[red]{rd}[label={[pos=1,inner sep=0,outer sep=0]0:${
\backslash
ast}$}]{} 
\backslash
tarrow[red]{ld}[label={[pos=1,inner sep=0,outer sep=0]0:${
\backslash
ast}$}]{} &              
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

{
\backslash
color{red}n'}  
\backslash
tarrow[blue]{rd}[label={[pos=1,inner sep=0,outer sep=0]0:${
\backslash
ast}$}]{} &                         & {
\backslash
color{red}n''} 
\backslash
tarrow[blue]{ld}[label={[pos=1,inner sep=0,outer sep=0]0:${
\backslash
ast}$}]{} 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

              & {
\backslash
color{blue}{
\backslash
color{blue}n'''}}                      &                              
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzcd}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Rewriting Diagrams
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:shape-diagrams"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $m\Rrightarrow\,max\left(m\right)$
\end_inset

 
\end_layout

\begin_layout Standard
by induction on the cases of 
\begin_inset Formula $max$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO not needed?
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
if 
\begin_inset Formula $m\Rrightarrow\,m'$
\end_inset

 then 
\begin_inset Formula $m'\Rrightarrow max\left(m\right)$
\end_inset

 
\end_layout

\begin_layout Standard
by induction on the derivation 
\begin_inset Formula $m\Rrightarrow\,m'$
\end_inset

 , with the only interesting cases are where a reduction is not taken
\end_layout

\begin_layout Itemize
in the case of 
\begin_inset Formula $\textrm{\Rrightarrow-::}$
\end_inset

 , 
\begin_inset Formula $m'\Rrightarrow max\left(m\right)$
\end_inset

 by 
\begin_inset Formula $\textrm{\Rrightarrow-::-red}$
\end_inset


\end_layout

\begin_layout Itemize
in the case of 
\begin_inset Formula $\textrm{\Rrightarrow-fun-app}$
\end_inset

 , 
\begin_inset Formula $m'\Rrightarrow max\left(m\right)$
\end_inset

 by 
\begin_inset Formula $\textrm{\Rrightarrow-fun-app-red}$
\end_inset

 
\end_layout

\begin_layout Standard
it follows that 
\end_layout

\begin_layout Standard
if 
\begin_inset Formula $m\Rrightarrow\,m'$
\end_inset

, 
\begin_inset Formula $m\Rrightarrow\,m''$
\end_inset

, implies 
\begin_inset Formula $m'\Rrightarrow\,max\left(m\right)$
\end_inset

 ,
\begin_inset Formula $m''\Rrightarrow\,max\left(m\right)$
\end_inset

 , referred to as the diamond property
\end_layout

\begin_layout Standard
since the function 
\begin_inset Formula $max$
\end_inset

 will pick a unique term.
 
\end_layout

\begin_layout Standard
the diamond property implies the confluence of 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 
\end_layout

\begin_layout Standard
by repeated application of the diamond property
\end_layout

\begin_layout Standard
it follows that 
\begin_inset Formula $\equiv$
\end_inset

 is transitive
\end_layout

\begin_layout Subsection
Context Lemmas
\end_layout

\begin_layout Subsection
Preservation
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO is typed conv, the easiest presentation?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
preservation for 
\begin_inset Formula $\Rrightarrow$
\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\Gamma\vdash m:M\quad m\Rrightarrow m'}{\Gamma\vdash m':M}
\]

\end_inset


\end_layout

\begin_layout Standard
can now be proven by induction on the typing derivation 
\begin_inset Formula $\Gamma\vdash m:M$
\end_inset

, the non trivial cases are
\end_layout

\begin_layout Itemize
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO remove forall
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\textrm{ty-::}$
\end_inset

, from induction 
\begin_inset Formula $\forall m,m'.$
\end_inset

 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $m\Rrightarrow m'$
\end_inset

 implies 
\begin_inset Formula $\Gamma\vdash m'\,:\,M$
\end_inset

, and 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit

\begin_inset Formula $\forall M,M'.$
\end_inset

 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $M\Rrightarrow M'$
\end_inset

 implies 
\begin_inset Formula $\Gamma\vdash M'\,:\,\star$
\end_inset

, there are two possible 
\begin_inset Formula $\Rrightarrow$
\end_inset

 reductions
\end_layout

\begin_deeper
\begin_layout Itemize

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\textrm{\Rrightarrow-::}$
\end_inset

, where 
\begin_inset Formula $m\Rrightarrow m'$
\end_inset

 and 
\begin_inset Formula $M\Rrightarrow M'$
\end_inset

, the derivation 
\begin_inset Formula $\Gamma\vdash m'::_{\ell'}M'$
\end_inset

 follows by 
\begin_inset Formula $\Gamma\vdash m'\,:\,M'$
\end_inset

 
\begin_inset Formula $\textrm{ty-conv}$
\end_inset

 on the inductive hypothesis 
\begin_inset Formula $\Gamma\vdash m'\,:\,M$
\end_inset

 and 
\begin_inset Formula $M'\,:\,\star$
\end_inset


\end_layout

\begin_layout Itemize

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\textrm{\Rrightarrow-::-red}$
\end_inset

, where 
\begin_inset Formula $m\Rrightarrow m'$
\end_inset

, the derivation 
\begin_inset Formula $\Gamma\vdash m'\,:\,M$
\end_inset

 follows directly from the inductive hypothesis
\end_layout

\end_deeper
\begin_layout Itemize
\begin_inset Formula $\textrm{ty-fun-ty}$
\end_inset

, from induction 
\begin_inset Formula $\forall M,M'.$
\end_inset

 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $M\Rrightarrow M'$
\end_inset

 implies 
\begin_inset Formula $\Gamma\vdash M'\,:\,\star$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
, and 
\begin_inset Formula $\forall N,N'.$
\end_inset

 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $N\Rrightarrow N'$
\end_inset

 implies 
\begin_inset Formula $\Gamma,x:M\vdash N'\,:\,\star$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
, there is only one possible 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\Rrightarrow$
\end_inset

 reduction
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $\Rrightarrow\textrm{-fun-ty}$
\end_inset

, where 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $M\Rrightarrow M'$
\end_inset

, 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit

\begin_inset Formula $N\Rrightarrow N'$
\end_inset

 and we must show 
\begin_inset Formula $\Gamma\vdash\left(x:M'\right)\rightarrow N'\,:\,\star$
\end_inset

.
 using the ...
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO just subst by parstep in ctx
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
\begin_inset Formula $\textrm{ty-fun-app}$
\end_inset

, from induction 
\begin_inset Formula $\forall m,m'.$
\end_inset

 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $m\Rrightarrow m'$
\end_inset

 implies 
\begin_inset Formula $\Gamma\vdash m'\,:\,\left(x:N\right)\rightarrow M$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
, and 
\begin_inset Formula $\forall n,n'.$
\end_inset

 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $n\Rrightarrow n'$
\end_inset

 implies 
\begin_inset Formula $\Gamma,x:M\vdash N'\,:\,\star$
\end_inset

, there are two possible 
\begin_inset Formula $\Rrightarrow$
\end_inset

 reductions
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $\Rrightarrow\textrm{-fun-ty}$
\end_inset

, where 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $M\Rrightarrow M'$
\end_inset

, 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit

\begin_inset Formula $N\Rrightarrow N'$
\end_inset

 and we must show 
\begin_inset Formula $\Gamma\vdash\left(x:M'\right)\rightarrow N'\,:\,\star$
\end_inset

.
 using the ...
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO just subst by parstep
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
\begin_inset Formula $\textrm{ty-conv}$
\end_inset

...
\end_layout

\begin_layout Standard
...
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\Gamma\vdash m\,:\,M\quad\Gamma\vdash M\,:\,\star}{\Gamma\vdash m::_{\ell}M\,:\,M}\,\textrm{ty-::}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\Gamma\vdash M\,:\,\star\quad\Gamma,x:M\vdash N\,:\,\star}{\Gamma\vdash\left(x:M\right)\rightarrow N\,:\,\star}\,\textrm{ty-fun-ty}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\Gamma\vdash m\,:\,\left(x:N\right)\rightarrow M\quad\Gamma\vdash n\,:\,N}{\Gamma\vdash m\,n\,:\,M\left[x\coloneqq n\right]}\,\textrm{ty-fun-app}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\Gamma\vdash m\,:\,M\quad M\equiv M'}{\Gamma\vdash m\,:\,M'}\,\textrm{ty-conv}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m\,:\,M}{\Gamma\vdash\mathsf{fun}\,f\,x\Rightarrow m\,:\,\left(x:N\right)\rightarrow M}\,\textrm{ty-fun}
\]

\end_inset


\end_layout

\begin_layout Standard
...
\end_layout

\begin_layout Standard
We can prove the property of Preservation
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\Gamma\vdash m:M\quad m\Rrightarrow_{\ast}m'}{\Gamma\vdash m':M}
\]

\end_inset


\end_layout

\begin_layout Subsection
Progress
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\,}{\left(\mathsf{fun}\,f\,x\Rightarrow m\right)_{\ell}v\rightsquigarrow m\left[f\coloneqq\mathsf{fun}\,f\,x\Rightarrow m,x\coloneqq v\right]}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{m\rightsquigarrow m'}{m_{\ell}\,n\rightsquigarrow m'_{\ell}\,n}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{n\rightsquigarrow n'}{v_{\ell}\,n\rightsquigarrow v_{\ell}\,n'}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{m\rightsquigarrow m'}{m::_{\ensuremath{\ell}}M\rightsquigarrow m'::_{\ensuremath{\ell}}M}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\,}{v::_{\ensuremath{\ell}}M\rightsquigarrow v}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: Note the location data makes this dangerous
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Surface Language Call-by-Value reductions
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-reduction-step"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
the following rules are admissible
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{m\rightsquigarrow m'}{m\Rrightarrow m'}
\]

\end_inset


\end_layout

\begin_layout Standard
Thus it is is preservation preserving and we can use the 
\end_layout

\begin_layout Subsection
Type Soundness
\end_layout

\begin_layout Standard
The language has type soundness, well typed terms will never 
\begin_inset Quotes eld
\end_inset

get stuck
\begin_inset Quotes erd
\end_inset

 in the surface language.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: motivate this, earlier then this section on exactly what terms should
 never be reached
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Type checking is undecidable
\end_layout

\begin_layout Standard
Given a thunk 
\begin_inset Formula $f:Unit$
\end_inset

 defined in pcf, it can be encoded into the surface system as a thunk 
\begin_inset Formula $f':Unit$
\end_inset

 , such that if f reduces to the canonical unit then 
\begin_inset Formula $f'\Rrightarrow^{*}\lambda A.\lambda a.a$
\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Formula $\vdash\star:f'\,\star\,\star$
\end_inset

 type-checks by conversion exactly when 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $f$
\end_inset

 halts
\end_layout

\begin_layout Standard
If there is a procedure to decide type checking we can decide exactly when
 any pcf function halts
\end_layout

\begin_layout Subsection
typing is non-local
\end_layout

\begin_layout Standard
TODO refer to the specific judgment
\end_layout

\begin_layout Standard
\begin_inset Formula $\lambda x.x$
\end_inset

 has many types
\end_layout

\begin_layout Standard
TODO and therefore untenable
\end_layout

\begin_layout Section
Bi-directional Surface Language
\end_layout

\begin_layout Subsection
Annotate all the vars
\end_layout

\begin_layout Standard
There are many possible way to localize the type checking process.
 We could ask that all variable be annotated at binders.
 This is ideal from a theoretical perspective this is good since it will
 be easy to put variables on context.
\end_layout

\begin_layout Standard
However note that, our proof of 
\begin_inset Formula $\lnot1_{c}\doteq_{\mathbb{N}_{c}}0_{c}$
\end_inset

 will look like
\end_layout

\begin_layout Standard
\begin_inset Formula $\lambda pr:1_{c}\doteq_{\mathbb{N}_{c}}0_{c}\Rightarrow pr\,\left(\lambda n:\left(C:\left(\mathbb{N}_{c}\rightarrow\star\right)\right)\rightarrow C\,1_{c}\rightarrow C\,0_{c}\Rightarrow n\,\star\,(\lambda-:\star\Rightarrow Unit_{c})\,\perp_{c}\right)\,tt_{c}:\lnot1_{c}\doteq_{\mathbb{N}_{c}}0_{c}$
\end_inset


\end_layout

\begin_layout Standard
This strategy requires a lot of redundant annotations.
 Luckily there's a better way, Bi-directional type checking.
\end_layout

\begin_layout Subsection
Bi-directional
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO also site teh clearer tutorial paper
\end_layout

\end_inset

 Bidirectional type-checking is a popular form of lightweight type inference,
 and strikes a good compromise between the required type annotations and
 the simplicity of the theory, allowing for localized errors (
\begin_inset CommandInset citation
LatexCommand cite
key "10.1145/3450952"
literal "false"

\end_inset

 is a good survey).
 This style of type checking usually only needs top level functions to be
 annotated
\begin_inset Foot
status open

\begin_layout Plain Layout
Even in Haskell, with full Hindley-Milner type inference, top level type
 annotations are encouraged.
\end_layout

\end_inset

.
 In fact, every example in this chapter has enough annotations to type-check
 under a bidirectional system.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO convert one to the other, emphasize locality
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{x:M\in\Gamma}{\Gamma\vdash x\overrightarrow{\,:\,}M}\operatorname{var-\overrightarrow{ty}}
\]

\end_inset


\begin_inset Formula 
\[
\frac{\Gamma\vdash}{\Gamma\vdash\star\overrightarrow{\,:\,}\star}\operatorname{\star-\overrightarrow{ty}}
\]

\end_inset


\begin_inset Formula 
\[
\frac{\Gamma\vdash m\overleftarrow{\,:\,}M\quad\Gamma\vdash M\overleftarrow{\,:\,}\star}{\Gamma\vdash m::_{\ell}M\overrightarrow{\,:\,}M}\operatorname{::-\overrightarrow{ty}}
\]

\end_inset


\begin_inset Formula 
\[
\frac{\Gamma\vdash M\overleftarrow{\,:\,}\star\quad\Gamma,x:M\vdash N\overleftarrow{\,:\,}\star}{\Gamma\vdash\left(x:M\right)\rightarrow N\overrightarrow{\,:\,}\star}\operatorname{\Pi-\overrightarrow{ty}}
\]

\end_inset


\begin_inset Formula 
\[
\frac{\Gamma\vdash m\overrightarrow{\,:\,}\left(x:N\right)\rightarrow M\quad\Gamma\vdash n\overleftarrow{\,:\,}N}{\Gamma\vdash m\,n\overrightarrow{\,:\,}M\left[x\coloneqq n\right]}\operatorname{\Pi-app-\overrightarrow{ty}}
\]

\end_inset


\begin_inset Formula 
\[
\frac{\Gamma\vdash m\overrightarrow{\,:\,}M\quad\Gamma\vdash M\equiv M':\star}{\Gamma\vdash m\overleftarrow{\,:\,}M'}\operatorname{conv-\overleftarrow{ty}}
\]

\end_inset


\begin_inset Formula 
\[
\frac{\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m\overleftarrow{\,:\,}M}{\Gamma\vdash\mathsf{fun}\,f\,x\Rightarrow m\overleftarrow{\,:\,}\left(x:N\right)\rightarrow M}\operatorname{\Pi-\mathsf{fun}-\overleftarrow{ty}}
\]

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

% also include context rules?
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Surface Language Bidirectional Typing Rules
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-bityping-rules"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% review the typing rule % a little muddled to talk about bidirectional
 type-checking and our rules
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

The surface language supports bidirectional type-checking over the pre-syntax
 with the rules in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:surface-bityping-rules"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 This is accomplished by breaking typing judgments into 2 forms: 
\end_layout

\begin_layout Itemize
Inference judgments where type information propagates out of a term, 
\begin_inset Formula $\overrightarrow{\,:\,}$
\end_inset

 in our notation.
 
\end_layout

\begin_layout Itemize
And Checking judgments where a type is checked against a term, 
\begin_inset Formula $\overleftarrow{\,:\,}$
\end_inset

 in our notation.
 
\end_layout

\begin_layout Standard
Inferences can be turned into checked judgments with an explicit equality
 check.
 This precisely limits the use of the problematic conv rule.
\end_layout

\begin_layout Subsection
If it types in the bidirectional system then it types in the TAS system
\end_layout

\begin_layout Standard
...
\end_layout

\begin_layout Subsection
If it types in the TAS system annotations can be added such that an equivalent
 term types in the bidirectional system
\end_layout

\begin_layout Standard
...
\end_layout

\begin_layout Subsection
Type-checking in the Bi-directional system is still undecidable
\end_layout

\begin_layout Standard
Type checking remains undecidable because of general recursion and type-in-type.
 However, since the user is not expected to type-check their program directly
 this should not cause any issues in practice.
 Even decidable type-checking in dependent type theory is computationally
 intractable.
 
\end_layout

\begin_layout Subsection
Bi-directional errors are local
\end_layout

\begin_layout Standard
...
\end_layout

\begin_layout Subsection
Still undecidable
\end_layout

\begin_layout Standard
Unfortunately, the system is logically unsound (every type is trivially
 inhabited with recursion), since our language attempts to be more oriented
 to programs than proofs.
 We expect this is acceptable.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO example
\end_layout

\end_inset


\end_layout

\begin_layout Section
Implementation
\end_layout

\begin_layout Standard
Implemented in Haskell.
 We have mechanized the type soundness of the type assignment system (without
 location data) in Coq.
 
\end_layout

\begin_layout Section
Related work
\end_layout

\begin_layout Subsection
Bad logics, ok programming languages?
\end_layout

\begin_layout Standard
Unsound logical systems that are acceptable programming languages go back
 to at least Church's lambda calculus which was originally intended to be
 a logical foundation for mathematics.
 In the 1970s, Martin-Lf proposed a system with Type-in-Type that was shown
 logically unsound by Girard (as described in the introduction in 
\begin_inset CommandInset citation
LatexCommand cite
key "Martin-Lof-1972"
literal "false"

\end_inset

).
 In the 1980s, Cardelli explored the domain semantics of a system with general
 recursive dependent functions and Type-in-Type
\begin_inset CommandInset citation
LatexCommand cite
key "cardelli1986polymorphic"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
The first direct proof of type soundness for a language with general recursive
 dependent functions, Type-in-Type, and dependent data that I am aware of
 came form the Trellys Project 
\begin_inset CommandInset citation
LatexCommand cite
key "sjoberg2012irrelevance"
literal "false"

\end_inset

.
 At the time their language had several additional features not included
 in my surface language.
 Additionally, my surface language uses a simpler notion of equality and
 dependent data resulting in an arguably simpler proof of type soundness.
 Later work in the Trellys Project
\begin_inset CommandInset citation
LatexCommand cite
key "casinghino2014combining,casinghino2014combiningthesis"
literal "false"

\end_inset

 used modalities to separate terminating and non-terminating fragments of
 the language, to allow both general recursion and logically sound reasoning
\begin_inset ERT
status open

\begin_layout Plain Layout

%, though the annotation burden seems high in retrospect
\end_layout

\end_inset

 .
 In general, the base language has been deeply informed by the Trellys project
\begin_inset CommandInset citation
LatexCommand cite
key "kimmell2012equational"
literal "false"

\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "sjoberg2012irrelevance"
literal "false"

\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "casinghino2014combining,casinghino2014combiningthesis"
literal "false"

\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "sjoberg2015programming"
literal "false"

\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "sjoberg2015dependently"
literal "false"

\end_inset

 and the Zombie language
\begin_inset Foot
status open

\begin_layout Plain Layout
https://github.com/sweirich/trellys
\end_layout

\end_inset

 it produced.
\end_layout

\begin_layout Standard
Several implementations support this combination of features without proofs
 of type soundness.
 Coquand presented an early bidirectional algorithm to type-check a similar
 language 
\begin_inset CommandInset citation
LatexCommand cite
key "COQUAND1996167"
literal "false"

\end_inset

.
 Cayenne 
\begin_inset CommandInset citation
LatexCommand cite
key "10.1145/289423.289451"
literal "false"

\end_inset

 is a Haskell like language that combined dependent types with Type-in-Type,
 data and non-termination.
 Agda supports general recursion and type-in-type with compiler flags.
 Idris supports similar 
\begin_inset Quotes eld
\end_inset

unsafe
\begin_inset Quotes erd
\end_inset

 features.
\end_layout

\begin_layout Standard
A similar 
\begin_inset Quotes eld
\end_inset

partial correctness
\begin_inset Quotes erd
\end_inset

 criterion for dependent languages with non-termination run with Call-by-Value
 is presented in 
\begin_inset CommandInset citation
LatexCommand cite
key "jia2010dependent"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO:  revise above
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
relation to other formal systems
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: nats+recursion make this as powerful as PCF, same issues about semantics
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
relation to other implementations
\end_layout

\begin_layout Section
TODO
\end_layout

\begin_layout Standard
discuss 
\end_layout

\begin_layout Standard
g : (f : nat -> bool) -> (fpr : (x :Nat -> IsEven x -> f x = Bool) -> Bool
\end_layout

\begin_layout Standard
g f _ = f 2
\end_layout

\begin_layout Standard
in the presence of non terminating proof functions
\end_layout

\begin_layout Standard
g : (n : Nat) -> (fpn : (x : IsEven n) -> Bool
\end_layout

\begin_layout Standard
g f _ = f 2
\end_layout

\begin_layout Standard
example of non-terminating functions being equal
\end_layout

\begin_layout Standard
what is the deal with bidirecitonal type checking?!?!
\end_layout

\begin_layout Standard
contact guy about presentations.
\end_layout

\begin_layout Standard
caveat about unsupported features
\end_layout

\begin_layout Standard
go through prevous stack overflow questions to remindmyself about past confusion.
\end_layout

\begin_layout Standard
make usre implementation is smooth around this
\end_layout

\begin_layout Standard
talk about non terminaiton
\end_layout

\begin_layout Standard
Strip Lemma
\end_layout

\begin_layout Section
unuesd
\end_layout

\begin_layout Standard
Triangle Property
\end_layout

\begin_layout Standard
\begin_inset Formula $\ensuremath{\forall{\color{red}m},{\color{red}m'}.\:{\color{red}m\Rrightarrow m'}\:\rightarrow\:{\color{red}m}{\color{blue}\Rrightarrow max\left(m\right)}\:\wedge\:{\color{red}m'}{\color{blue}\Rrightarrow max\left(m\right)}}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzcd}
\end_layout

\begin_layout Plain Layout


\backslash
mathbin{
\backslash
color{red}m} 
\backslash
tarrow[red]{r} 
\backslash
tarrow[blue]{d} & 
\backslash
mathbin{
\backslash
color{red}m'} 
\backslash
tarrow[blue]{ld} 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
mathbin{
\backslash
color{blue}max(m)}                  &              
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzcd}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $\forall{\color{red}m},{\color{red}m'},{\color{red}n}.\:{\color{red}m\Rrightarrow m'}\:\wedge\:{\color{red}m\Rrightarrow_{\ast}n}\:\rightarrow\:\exists{\color{blue}n'}.\:{\color{red}m'}{\color{blue}\Rrightarrow_{\ast}n'}\:\wedge\:{\color{red}n}{\color{blue}\Rrightarrow n'}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzcd}
\end_layout

\begin_layout Plain Layout

% TODO look into proper subscripting of arrow heads
\end_layout

\begin_layout Plain Layout

              & {
\backslash
color{red}m} 
\backslash
tarrow[red]{rd}[label={[pos=1,inner sep=0,outer sep=0]0:${
\backslash
ast}$}]{} 
\backslash
tarrow[red]{ld} &              
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

{
\backslash
color{red}m'}  
\backslash
tarrow[blue]{rd}[label={[pos=1,inner sep=0,outer sep=0]0:${
\backslash
ast}$}]{} &                         & {
\backslash
color{red}m} 
\backslash
tarrow[blue]{ld} 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

              & {
\backslash
color{blue}m'}                      &                              
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzcd}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintCited"
bibfiles "/Users/stephaniesavir/thesis/bibliography/dtest"
options "alpha"

\end_inset


\end_layout

\end_body
\end_document
