#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\begin_preamble
\usepackage{xcolor}
\usepackage{tikz-cd}
\tikzcdset{%
    triple line/.code={\tikzset{%
        double equal sign distance, % replace by double distance = 'measure' 
        double=\pgfkeysvalueof{/tikz/commutative diagrams/background color}}},
    quadruple line/.code={\tikzset{%
        double equal sign distance, % replace by double distance = 'measure'
        double=\pgfkeysvalueof{/tikz/commutative diagrams/background color}}},
    Rrightarrow/.code={\tikzcdset{triple line}\pgfsetarrows{tikzcd implies cap-tikzcd implies}},
    RRightarrow/.code={\tikzcdset{quadruple line}\pgfsetarrows{tikzcd implies cap-tikzcd implies}}
}    
\newcommand*{\tarrow}[2][]{\arrow[Rrightarrow, #1]{#2}\arrow[dash, shorten >= 0.5pt, #1]{#2}}
\newcommand*{\qarrow}[2][]{\arrow[RRightarrow, #1]{#2}\arrow[equal, double distance = 0.25pt, shorten >= 1.28pt, #1]{#2}}
\end_preamble
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize letterpaper
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 1cm
\topmargin 1cm
\rightmargin 1cm
\bottommargin 1cm
\headheight 1cm
\headsep 1cm
\footskip 1cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 2
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Chapter 2 (draft)
\end_layout

\begin_layout Part
Surface language
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%% TODO notes
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%% don't love this intro
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% overview, why
\end_layout

\end_inset


\end_layout

\begin_layout Standard
In an ideal world programmers would write perfect programs whose correctness
 is fully proven.
 The 
\series bold
Surface Language
\series default
 presented in this chapter allows for this ideal, but difficult, workflow.
 Programmers should 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

"
\end_layout

\end_inset

think
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

"
\end_layout

\end_inset

 in the surface language, and the machinery of later sections should reinforce
 an understanding of the surface type system, while being transparent to
 the programmer.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% overview, What
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The surface language presented in this chapter is a minimal dependent type
 system.
 It will serve both as foundation for further chapters.
 As much as possible, the syntax use's standard modern notation 
\begin_inset Foot
status open

\begin_layout Plain Layout
several alternative syntax exist in the literature.
 In this document the typed polymorphic identity function be written as
 
\begin_inset Formula $\lambda-\,x\Rightarrow x\ :\,\left(X:\star\right)\rightarrow X\rightarrow X$
\end_inset

.
 In 
\begin_inset CommandInset citation
LatexCommand cite
key "10.1016/0890-5401(88)90005-3"
literal "false"

\end_inset

 it might be written 
\begin_inset Formula $\left(\lambda X:\star\right)\left(\lambda x:X\right)x\ :\,\left[X:\star\right]\left[x:X\right]X$
\end_inset

, Martin Loff/Hoff (TODO PI notation) 
\end_layout

\end_inset

.
 The semantics are intended to be as simple as possible and compatible with
 other well studied intentional dependent type theories 
\begin_inset Foot
status open

\begin_layout Plain Layout
most terms in this chapter could be translated into the calculus of construction
s, or other pure type systems, (TODO actually test that these could all
 be plugged into agda with approrite flags)
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% overview, What
\end_layout

\end_inset


\end_layout

\begin_layout Standard
I deviate from a standard dependent type theory to include features to ease
 programming at the expense of correctness.
 Specifically the language allows general recursion, since general recursion
 is useful for general purpose functional programming.
 type-in-type is also supported since it simplifies the system for programmers,
 and makes the meta-theory easier when logical soundness has been abandoned.
 Despite this, type soundness is a achievable and a practical type checking
 algorithm is given.
\end_layout

\begin_layout Standard
Though similar systems have been studied over the last few decades this
 chapter aims to give a self contained presentation, along with many examples.
 The surface language has been an excellent platform to conduct research
 into full spectrum dependent type theory, and hopefully this exposition
 will be helpful introduction for other researchers.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% name the lang
\end_layout

\end_inset


\end_layout

\begin_layout Section
Surface Language Syntax
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% What syntax
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The syntax for the Surface Language is in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:surface-pre-syntax"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The syntax supports: variables, type annotations, a single type universe,
 dependent function types, dependent recursive functions, and function applicati
ons.
 Type annotations are written with two colons to differentiate it from the
 formal typing judgments that will appear more frequently in this text,
 in the implemented language a user of the programming language would use
 a single colon.
 Location data 
\begin_inset Formula $\ensuremath{\ell}$
\end_inset

 is marked at every position where a type error might occur.
 
\end_layout

\begin_layout Standard
There is no destination between types and terms in the syntax
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
terms and types are usually separated, except in the syntax of full-spectrum
 dependent type systems where separating them would require many redundant
 rules
\end_layout

\end_inset

, both are referred to as expressions.
 However, capital metavariables are used in positions that are intended
 as types, and lowercase metavariables are used when an expression is intended
 to be a term, for instance in annotation syntax.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% Metavariables that intend to quantify equivalent terms will be noted with
 primes or subsripts, 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% Metavariables that type other metavairbles will often use the same letter
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: recursive f?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="12" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="none" valignment="top" usebox="none" special="l">
\begin_inset Text

\begin_layout Plain Layout
source labels,
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\ensuremath{\ell}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
...
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $.$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
no source label
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="none" valignment="top" usebox="none" special="l">
\begin_inset Text

\begin_layout Plain Layout
type contexts,
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lozenge$
\end_inset

 | 
\begin_inset Formula $\Gamma,x:M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="none" valignment="top" usebox="none" special="l">
\begin_inset Text

\begin_layout Plain Layout
expressions,
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m,n,M,N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m::_{\ensuremath{\ell}}M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
annotation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
type universe
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:M_{\ensuremath{\ell}}\right)\rightarrow N_{\ensuremath{\ell'}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function type
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
function
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m_{\ensuremath{\ell}}\,n$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
application
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Surface Language Syntax
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-pre-syntax"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: This is almost a pure type system
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Several abbreviations are convenient when dealing with a language like this.
 These are listed in 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:surface-pre-syntax-abrev"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="5">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:M\right)\rightarrow N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
written
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $M\rightarrow N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
when 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x\notin fv\left(N\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
written
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda x\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
when 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $f\notin fv\left(m\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $...\,x\Rightarrow\lambda y\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
written
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $...\,x\,y\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
written
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
when 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x\notin fv\left(m\right)$
\end_inset

 when 
\begin_inset Formula $x$
\end_inset

 binds 
\begin_inset Formula $m$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m::_{\ensuremath{\ell}}M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
written
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m::M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
when 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\ensuremath{\ell}$
\end_inset

 is irrelevant
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:M_{\ensuremath{\ell}}\right)\rightarrow N_{\ensuremath{\ell'}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
written
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:M\right)\rightarrow N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
when 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\ensuremath{\ell}$
\end_inset

, 
\begin_inset Formula $\ensuremath{\ell}'$
\end_inset

 are irrelevant
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m_{\ensuremath{\ell}}\,n$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
written
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m_{\ensuremath{}}\,n$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
when 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\ensuremath{\ell}$
\end_inset

 is irrelevant
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
where 
\begin_inset Formula $fv$
\end_inset

 is a function that returns the set of free variables in an expression
\begin_inset Caption Standard

\begin_layout Plain Layout
Surface Language Abbreviations
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-pre-syntax-abrev"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Examples
\end_layout

\begin_layout Standard
The surface system is extremely expressive.
 Several example surface language constructions can be found in 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:surface-exemples"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 I abuse turnstile notion slightly so that examples can be indexed by other
 expressions that obey type rules.
 For instance, we can say 
\begin_inset Formula $refl_{2_{c}:\mathbb{N}_{c}}\ :\ 2_{c}\doteq_{\mathbb{N}_{c}}2_{c}$
\end_inset

 since 
\begin_inset Formula $\mathbb{N}_{c}:\star$
\end_inset

 and 
\begin_inset Formula $2_{c}:\mathbb{N}_{c}$
\end_inset

.
\end_layout

\begin_layout Standard
The surface language subsumes or encodes many classic typed lambda calculi.
 For instance all pure type systems
\begin_inset Foot
status open

\begin_layout Plain Layout
previously called 
\begin_inset Quotes eld
\end_inset

Generalized Type Systems
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset

 such as System F and the Calculus of Constructions can represent their
 terms into the Surface Language 
\begin_inset Foot
status open

\begin_layout Plain Layout
by renaming their type universes into the Surface type universe
\end_layout

\end_inset

.
 Additionally the examples from 
\begin_inset CommandInset citation
LatexCommand cite
key "cardelli1986polymorphic"
literal "false"

\end_inset

 where Cardelli has studied a similar system, can be expressed here.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="23" columns="5">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash\perp_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\left(X:\star\right)\rightarrow X$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Void, 
\begin_inset Quotes eld
\end_inset

empty
\begin_inset Quotes erd
\end_inset

 type, logical false
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash Unit_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\left(X:\star\right)\rightarrow X\rightarrow X$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Unit, logical true
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash tt_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\coloneqq\lambda-\,x\Rightarrow x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:Unit_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
trivial proposition, polymorphic identity
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash\mathbb{B}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\coloneqq\left(X:\star\right)\rightarrow X\rightarrow X\rightarrow X$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
booleans
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash true_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\coloneqq\lambda-\,then\,-\Rightarrow then$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\mathbb{B}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
boolean true
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash false_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\coloneqq\lambda-\,-\,else\Rightarrow else$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\mathbb{B}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
boolean false
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x:\mathbb{B}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash\lnot_{c}x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\coloneqq x\,\mathbb{B}_{c}\,false_{c}\,true_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\mathbb{B}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
boolean not
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x:\mathbb{B}_{c},y:\mathbb{B}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash x\,\&_{c}\,y$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\coloneqq x\,\mathbb{B}_{c}\,y\,false_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\mathbb{B}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
boolean and
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\left(X:\star\right)\rightarrow(X\rightarrow X)\rightarrow X\rightarrow X$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
natural numbers
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash0_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\lambda-\,-\,z\Rightarrow z$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash1_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\lambda-\,s\,z\Rightarrow s\,z$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash2_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\lambda-\,s\,z\Rightarrow s\left(s\,z\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash n_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\lambda-\,s\,z\Rightarrow s^{n}\,z$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x:\mathbb{N}_{c},y:\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash x+_{c}y$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\lambda X\,s\,z\Rightarrow x\,X\,s\,\left(y\,X\,s\,z\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X:\star,Y:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash X\times_{c}Y$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\left(Z:\star\right)\rightarrow(X\rightarrow Y\rightarrow Z)\rightarrow Z$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pair, logical and
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X:\star,Y:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash Either_{c}\,X\,Y$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\left(Z:\star\right)\rightarrow(X\rightarrow Z)\rightarrow(Y\rightarrow Z)\rightarrow Z$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
either, logical or
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash\lnot_{c}X$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq X\rightarrow\perp_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
logical negation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x:\mathbb{N}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash Even_{c}\,x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\mathbb{N}_{c}\,\star\,\left(\lambda x\Rightarrow\lnot_{c}x\right)\,Unit_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x$
\end_inset

 is an even number
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X:\star,Y:X\rightarrow\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash\exists_{c}x:X.Y\,x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\left(C:\star\right)\rightarrow\left((x:X)\rightarrow Y\,x\rightarrow C\right)\rightarrow C$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
dependent pair, logical exists
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X:\star,x_{1}:X,x_{2}:X$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash x_{1}\doteq_{X}x_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\left(C:\left(X\rightarrow\star\right)\right)\rightarrow C\,x_{1}\rightarrow C\,x_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Leibniz equality
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X:\star,x:X$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash refl_{x:X}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\lambda-\,cx\Rightarrow cx$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:x\doteq_{X}x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
reflexivity
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X:\star,x_{1}:X,x_{2}:X$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdash sym_{x_{1},x_{2}:X}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\lambda p\,C\Rightarrow p\left(\lambda x\Rightarrow C\,x\rightarrow C\,x_{1}\right)\,\left(\lambda x\Rightarrow x\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:x_{1}\doteq_{X}x_{2}\rightarrow x_{2}\doteq_{X}x_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
symmetry
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: suc, pred as an example of an unpleasant encoding, also citation
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: symetry, trans
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: list, vec, singleton
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: TODo footnote on Leibniz equality for alt encoding 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: apure abouse of notation allows quantifiaction from function types
 or lambda or a combintation
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Example Surface Language Programs
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-exemples"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Church encodings
\end_layout

\begin_layout Standard
Data types are expressible using Church encodings, (in the style of System
 F).
 Church encodings embed the elimination principle of a data type into continuati
ons
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: not exactly right, not just elimination, recursion is also involved
\end_layout

\end_inset

.
 For instance Boolean data is eliminated against true and false, 2 tags
 with no additional data.
 This can also be recognized as the familiar if-then-else construct.
 So 
\begin_inset Formula $\mathbb{B}_{c}$
\end_inset

 encodes the possibility of choice between 2 elements, 
\begin_inset Formula $true_{c}$
\end_inset

 picks the 
\begin_inset Quotes eld
\end_inset

then
\begin_inset Quotes erd
\end_inset

 branch, and 
\begin_inset Formula $false_{c}$
\end_inset

 picks the 
\begin_inset Quotes eld
\end_inset

else
\begin_inset Quotes erd
\end_inset

 branch.
\end_layout

\begin_layout Standard
Natural numbers
\begin_inset Foot
status open

\begin_layout Plain Layout
called 
\begin_inset Quotes eld
\end_inset

church numerals
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset

 are encodable with 2 tags, 
\begin_inset Formula $0$
\end_inset

 and successor, where successor also contains the result of the preceding
 number.
 So 
\begin_inset Formula $\mathbb{N}_{c}$
\end_inset

 encodes the possibility of choices, 
\begin_inset Formula $(A\rightarrow A)$
\end_inset

 decides how to handle the recursive result of the prior number in the successor
 case, and the 2nd argument specifies how to handle the base case of 
\begin_inset Formula $0$
\end_inset

.
 This can be viewed as a simple looping construct with temporary storage.
\end_layout

\begin_layout Standard
Parameterized data types such as pairs and the 
\begin_inset Formula $Either$
\end_inset

 type can also be encoded in this scheme.
 A pair type can be used in any way the 2 types it contains can so the definitio
n states that a pair is at least as good as the curried input to a function.
 The 
\begin_inset Formula $Either$
\end_inset

 type is handled if both possibilities are handled, which is exactly expressed
 by it's definition.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: church encoding citation
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% not necisarily convineint
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Church encodings provide a theoretically light weight way of working with
 data in minimal lambda calculus, however they are very inconvenient to
 work with.
 For instance, the predecessor function on natural numbers is not exactly
 straight forward.
 To make the system easier for programmers, data types will be added in
 chapter 4.
\end_layout

\begin_layout Subsection
Predicate encodings
\end_layout

\begin_layout Standard
In general we associate the truth value of a proposition with the inhabitation
 of a type.
 So, 
\begin_inset Formula $\perp_{c}$
\end_inset

, the 
\begin_inset Quotes eld
\end_inset

empty
\begin_inset Quotes erd
\end_inset

 type, can be considered as a false proposition.
 While 
\begin_inset Formula $Unit_{c}$
\end_inset

 can be considered a trivially true logical proposition.
\end_layout

\begin_layout Standard
Several of the church encoded data types we have seen can also be interpreted
 as logical predicates.
 For instance, the tuple type can be considered as logical and, 
\begin_inset Formula $X\times_{c}Y$
\end_inset

 can be inhabited exactly when both 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are inhabited.
 The
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
 
\begin_inset Formula $Either$
\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 type can be considered as logical or, 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit

\begin_inset Formula $Either_{c}\,X\,Y$
\end_inset

 can be inhabited exactly when either 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $X$
\end_inset

 or 
\begin_inset Formula $Y$
\end_inset

 is inhabited.
\end_layout

\begin_layout Standard
With dependent types, more interesting logical predicates can be encoded.
 For instance, we can characterize when a number is Even with 
\begin_inset Formula $Even_{c}\,x$
\end_inset

.
 We can show that 
\begin_inset Formula $2$
\end_inset

 is even by showing that 
\begin_inset Formula $Even_{c}\,2_{c}$
\end_inset

 is inhabited with with the term 
\begin_inset Formula $\lambda s\Rightarrow s\,tt_{c}$
\end_inset

 .
\end_layout

\begin_layout Standard
Other predicates are encodable in the style of Calculus of Constructions
\begin_inset CommandInset citation
LatexCommand cite
key "10.1016/0890-5401(88)90005-3"
literal "false"

\end_inset

 .
 For instance, we can encode the existential as 
\begin_inset Formula $\exists_{c}$
\end_inset

, then if we want to show 
\begin_inset Formula $\exists_{c}x:\mathbb{N}_{c}.\,Even_{c}\,x$
\end_inset

 we need to find a suitable inhabitant of that type.
 
\begin_inset Formula $0$
\end_inset

is clearly an even number, so our inhabitant would be 
\begin_inset Formula $\lambda f\Rightarrow f\,0_{c}\,tt_{c}$
\end_inset

.
 Note that the existential degenerates into the tuple if 
\begin_inset Formula $Y$
\end_inset

 does not depend on the first element.
 
\end_layout

\begin_layout Standard
One of the most potent and interesting propositions is the proposition of
 equality.
 
\begin_inset Formula $\doteq$
\end_inset

 is referred to as Leibniz equality since two terms are equal when they
 behave the same on all 
\begin_inset Quotes eld
\end_inset

observations
\begin_inset Quotes erd
\end_inset


\begin_inset Foot
status collapsed

\begin_layout Plain Layout
The identification of indiscernibles is called 
\begin_inset Quotes eld
\end_inset

Leibniz law
\begin_inset Quotes erd
\end_inset

 in philosophy.
 Leibniz assumed a metaphysical notion of identification of 
\begin_inset Quotes eld
\end_inset

substance
\begin_inset Quotes erd
\end_inset

s, not a mathematical notion of equality.
\end_layout

\end_inset

.
 We can prove 
\begin_inset Formula $\doteq$
\end_inset

 is an equivalence within the system be proving it is reflexive, symmetric,
 and transitive.
 Additionally we can prove congruence.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: 
\begin_inset Quotes eld
\end_inset

Leibniz asserted the identity of indiscernibles: two objects are equal if
 and only if they satisfy the same properties (Leibniz, 1686)
\begin_inset Quotes erd
\end_inset

 https://homepages.inf.ed.ac.uk/wadler/papers/leibniz/leibniz.pdf
\end_layout

\begin_layout Plain Layout

% section 9 ish, sort of asmed tobe true  Leibniz, G.
 (1686) Discourse on metaphysics.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: some simple non reflexive proof, though this is really hard without
 proper induction principles
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Large Eliminations
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: doulbe check large elimination def (write it here)
\end_layout

\begin_layout Plain Layout

% consistent with the notes here: https://github.com/RobertHarper/hott-notes/blob
/5339576f55a4b7f5d04734370a5117491c44b1fe/notes_week5.tex#L155
\end_layout

\begin_layout Plain Layout

% would like better explanaition
\end_layout

\end_inset


\end_layout

\begin_layout Standard
It is useful for a type to depend specifically on a term, this is called
 
\begin_inset Quotes eld
\end_inset

Large elimination
\begin_inset Quotes erd
\end_inset

 can be simulated with type-in-type.
 
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $toLogic$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\coloneqq\lambda b\Rightarrow b\,\star\,Unit_{c}\,\perp_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbb{B}_{c}\rightarrow\star$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $isPos$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\coloneqq\lambda n\Rightarrow n\,\star\,(\lambda-\Rightarrow Unit_{c})\,\perp_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $:$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbb{N}_{c}\rightarrow\star$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
For instance,
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $toLogic$
\end_inset

 can convert a 
\begin_inset Formula $\mathbb{B}_{c}$
\end_inset

 term into it's corresponding logical type, 
\begin_inset Formula $toLogic\,true_{c}\equiv Unit_{c}$
\end_inset

 while 
\begin_inset Formula $toLogic\,false_{c}\equiv\perp_{c}$
\end_inset

 .
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
The expression
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $isPos$
\end_inset

 has similar behavior, going to 
\begin_inset Formula $\perp_{c}$
\end_inset

 at 
\begin_inset Formula $0_{c}$
\end_inset

 and 
\begin_inset Formula $Unit_{c}$
\end_inset

 otherwise.
\end_layout

\begin_layout Standard
Note that such functions are not possible in the Calculus of Constructions.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: citation for CIC?
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Inequalities
\end_layout

\begin_layout Standard
Large eliminations can be used to prove inequalities that can be hard or
 impossible to express in other minimal dependent type theories such as
 the calculus of constructions.
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\lambda pr\Rightarrow pr\,\left(\lambda x\Rightarrow x\right)\,\perp_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lnot_{c}\star\doteq_{\star}\perp_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
the type universe is distinct from Logical False
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\lambda pr\Rightarrow pr\,\left(\lambda x\Rightarrow x\right)\,tt_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lnot_{c}Unit_{c}\doteq_{\star}\perp_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Logical True is distinct from Logical False
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda pr\Rightarrow pr\,toLogic\,tt_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lnot true_{c}\doteq_{\mathbb{B}_{c}}false_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
boolean true and false are distinct
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda pr\Rightarrow pr\,isPos\,tt_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lnot1_{c}\doteq_{\mathbb{N}_{c}}0_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 and 0 are distinct
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: 1st not sensible in CC
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: 2 possiblely in CC?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Note that a proof of 
\begin_inset Formula $\lnot1_{c}\doteq_{\mathbb{N}_{c}}0_{c}$
\end_inset

 is not possible in the Calculus of Constructions
\begin_inset CommandInset citation
LatexCommand cite
key "10.2307/2274575"
literal "false"

\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
Martin Hofmann excellently motivates the reasoning in 
\begin_inset CommandInset citation
LatexCommand cite
key "hofmann1997syntax"
literal "false"

\end_inset

(incorrect citation) Exercises 2.5, 2.6, 3.7, 3.25, 3.26, 3.43, 3.44
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: citation is actually for an MLTT, bleh
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: cite origional and cleaned up in M.
 Hoffman
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Recursion
\end_layout

\begin_layout Standard
Additionally, the syntax of functions builds in unrestricted recursion.
 Though not always necessary, recursion can be very helpful for writing
 programs.
 For instance, here is (an inefficient) function that calculates Fibonacci
 numbers.
\end_layout

\begin_layout Standard
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow case_{c}\,x\,0_{c}\left(\lambda px\Rightarrow case_{c}\,px\,1_{c}\left(\lambda-\Rightarrow f\left(x-_{c}1\right)+_{c}f\left(x-_{c}2\right)\right)\right)$
\end_inset


\end_layout

\begin_layout Standard
given the appropriate definitions of 
\begin_inset Formula $case_{c}$
\end_inset

, 
\begin_inset Formula $-_{c}$
\end_inset

.
\end_layout

\begin_layout Standard
Recursion can also be used to simulate induction, and this will be heavily
 relied on when data types are added in chapter 4.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: GCD, recursive types
\end_layout

\end_inset


\end_layout

\begin_layout Section
Surface Language Type Assignment System
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{{\color{gray}\Gamma\vdash}\quad x:M\in\Gamma}{\Gamma\vdash x\,:\,M}\,\textrm{ty-var}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\Gamma\vdash m\,:\,M}{\Gamma\vdash m::_{\ell}M\,:\,M}\,\textrm{ty-::}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{{\color{gray}\Gamma\vdash}}{\Gamma\vdash\star\,:\,\star}\,\textrm{ty-}\star
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\Gamma\vdash M\,:\,\star\quad\Gamma,x:M\vdash N\,:\,\star}{\Gamma\vdash\left(x:M\right)\rightarrow N\,:\,\star}\,\textrm{ty-fun-ty}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\Gamma\vdash m\,:\,\left(x:N\right)\rightarrow M\quad\Gamma\vdash n\,:\,N}{\Gamma\vdash m\,n\,:\,M\left[x\coloneqq n\right]}\,\textrm{ty-fun-app}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m\,:\,M}{\Gamma\vdash\mathsf{fun}\,f\,x\Rightarrow m\,:\,\left(x:N\right)\rightarrow M}\,\textrm{ty-fun}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\Gamma\vdash m\,:\,M\quad{\color{gray}\Gamma\vdash}M\equiv M'{\color{gray}:\star}}{\Gamma\vdash m\,:\,M'}\,\textrm{ty-conv}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: Note the location needs explanation
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Surface Language Type Assignment System
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-TAS"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The rules of the type assignment system are listed in 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:surface-TAS"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: walk through each
\end_layout

\end_inset


\end_layout

\begin_layout Standard
There is some question about how much typing information should be coupled
 to the judgment, forcing contexts to be well-formed eliminates nonsense
 situation like 
\begin_inset Formula $x:1_{c}\vdash...$
\end_inset

 by construction, but requires more fork when forming judgments that can
 be distracting.
 Since the proofs in this section can be done without forcing the context
 to be well formed, it is tempting to omit them.
 Here I have compromised by including the extra book keeping in a 
\begin_inset Formula ${\color{gray}\mathrm{grey\,font}}$
\end_inset

 that will hopefully keep the key ideas in the foreground, while still allowing
 the most powerful exposition.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% meta-theory type soundness
\end_layout

\end_inset

 From the perspective of a programming language type system the most important
 property is Type Soundness
\begin_inset Foot
status open

\begin_layout Plain Layout
also called 
\begin_inset Quotes eld
\end_inset

Type Safety
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset

.
 Type Soundness is often motivated with the slogan, 
\begin_inset Quotes eld
\end_inset

well typed programs don't get stuck (in an empty context)
\begin_inset Quotes erd
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "MILNER1978348"
literal "false"

\end_inset


\begin_inset Foot
status collapsed

\begin_layout Plain Layout
in Milner's original paper, he used 
\begin_inset Quotes eld
\end_inset

wrong
\begin_inset Quotes erd
\end_inset

 instead of stuck
\end_layout

\end_inset

.
 Given the syntax of the surface language, their is potential for a program
 to 
\begin_inset Quotes eld
\end_inset

get stuck
\begin_inset Quotes erd
\end_inset

 when an argument is given to non-function syntax.
 For example, 
\begin_inset Formula $\star\ 1_{c}$
\end_inset

 would be stuck since 
\begin_inset Formula $\star$
\end_inset

 is not a function, so it cannot compute when given the argument 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $1_{c}$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
.
 A good type system will make such unreasonable programs unreachable.
 The type assignment system presented here is type sound.
\end_layout

\begin_layout Standard
Type soundness can be shown with a progress and preservation
\begin_inset Foot
status open

\begin_layout Plain Layout
also called 
\begin_inset Quotes eld
\end_inset

Subject Reduction
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset

 style proof
\begin_inset CommandInset citation
LatexCommand cite
key "WRIGHT199438"
literal "false"

\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
most relevant textbooks outline modern forms of this proof for non-dependent
 type systems.
 For instance, part 2 of Types and programming languages, PFLA, the Chapala
 book
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

% actually a little diferent in the progress lemma
\end_layout

\end_inset

.
 The preservation lemma shows that typing information is invariant over
 evaluation
\begin_inset Foot
status open

\begin_layout Plain Layout
Similar proofs for dependent type systems can be found in Chapter 3 of 
\begin_inset CommandInset citation
LatexCommand cite
key "luo1994computation"
literal "false"

\end_inset

, ..., Section 3.1 of 
\begin_inset CommandInset citation
LatexCommand cite
key "10.1007/3-540-45413-6_27"
literal "false"

\end_inset

(including eta expansion in an implicit system),...
 
\end_layout

\end_inset

.
 While the progress lemma shows that a single step of evaluation for a well
 typed term in an empty context will not 
\begin_inset Quotes eld
\end_inset

get stuck
\begin_inset Quotes erd
\end_inset

.
 By iterating these lemmas together, it is possible to show that the type
 system avoids a specific class of bad behavior.
 This type of proof hinges on a suitable definition of the 
\begin_inset Formula $\equiv$
\end_inset

 relation.
\end_layout

\begin_layout Standard
The progress/preservation style proof requires 
\begin_inset Formula $\equiv$
\end_inset

 be
\end_layout

\begin_layout Itemize
reflexive
\end_layout

\begin_layout Itemize
symmetric
\end_layout

\begin_layout Itemize
transitive
\end_layout

\begin_layout Itemize
closed under (well typed) substitution 
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO closed under conjigation
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
preserves typing
\end_layout

\begin_layout Itemize
\begin_inset Formula $\star\cancel{\equiv}\left(x:N\right)\rightarrow M$
\end_inset

 does not associate type constructors
\end_layout

\begin_layout Standard
it further helps if 
\begin_inset Formula $\equiv$
\end_inset

 is 
\end_layout

\begin_layout Itemize
closed under normalization
\end_layout

\begin_layout Standard
A particularly simple definition of 
\begin_inset Formula $\equiv$
\end_inset

 is equating any terms that share a reduct via a system of parallel reductions
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{{\color{gray}\Gamma\vdash m:M}\ m\Rrightarrow_{\ast}\,n\quad{\color{gray}\Gamma\vdash m:M}\ m'\Rrightarrow_{\ast}\,n}{{\color{gray}\Gamma\vdash}m\equiv m'{\color{gray}:M}}\,\equiv\textrm{-Def}
\]

\end_inset


\end_layout

\begin_layout Itemize
reflexive by definition
\end_layout

\begin_layout Itemize
symmetric automatically
\end_layout

\begin_layout Itemize
transitive if 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 is confluent
\end_layout

\begin_layout Itemize
closed under substitution if 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 is closed under substitution 
\end_layout

\begin_layout Itemize
preserves types, if 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 preserves types
\end_layout

\begin_layout Itemize
\begin_inset Formula $\star\cancel{\equiv}\left(x:N\right)\rightarrow M$
\end_inset

 does not associate type constructors since 
\begin_inset Formula $\left(x:N\right)\rightarrow M\cancel{\Rrightarrow_{\ast}}\star$
\end_inset

 
\end_layout

\begin_layout Itemize
closed under normalization automatically
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\,}{x\Rrightarrow x}\,\textrm{\Rrightarrow-var}
\]

\end_inset


\begin_inset Formula 
\[
\frac{m\Rrightarrow m'}{m::_{\ensuremath{\ell}}M\Rrightarrow m'}\,\textrm{\Rrightarrow-::-red}
\]

\end_inset


\begin_inset Formula 
\[
\frac{m\Rrightarrow m'\quad M\Rrightarrow M'}{m::_{\ensuremath{\ell}}M\Rrightarrow m'::_{\ensuremath{\ensuremath{\ell}'}}M'}\,\textrm{\Rrightarrow-::}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\,}{\star\Rrightarrow\star}\,\textrm{\Rrightarrow-}\star
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{M\Rrightarrow M'\quad N\Rrightarrow N'}{\left(x:M_{\ell}\right)\rightarrow N_{\ell'}\Rrightarrow\left(x:M'_{\ensuremath{\ell}''}\right)\rightarrow N'_{\ensuremath{\ell}'''}}\,\textrm{\Rrightarrow-fun-ty}
\]

\end_inset


\begin_inset Formula 
\[
\frac{m\Rrightarrow m'\quad n\Rrightarrow n'}{\left(\mathsf{fun}\,f\,x\Rightarrow m\right)_{\ell}n\Rrightarrow m'\left[f\coloneqq\mathsf{fun}\,f\,x\Rightarrow m',x\coloneqq n'\right]}\,\textrm{\Rrightarrow-fun-app-red}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{m\Rrightarrow m'}{\mathsf{fun}\,f\,x\Rightarrow m\,\Rrightarrow\,\mathsf{fun}\,f\,x\Rightarrow m'}\,\textrm{\Rrightarrow-fun}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{m\Rrightarrow m'\quad n\Rrightarrow n'}{m_{\ell}\,n\Rrightarrow m'_{\ell'}\,n'}\,\textrm{\Rrightarrow-fun-app}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: Note the location data makes this dangerous
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Surface Language Parallel Reductions
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-reduction"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\,}{m\Rrightarrow_{\ast}m}\,\textrm{\Rrightarrow_{\ast}-refl}
\]

\end_inset


\begin_inset Formula 
\[
\frac{m\Rrightarrow_{\ast}m'\;m'\Rrightarrow m''}{m\Rrightarrow_{\ast}m''}\,\textrm{\Rrightarrow_{\ast}-trans}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO jsut transitive closure
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Transitive-Reflexive-Closure
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-reduction-1"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Parallel reductions are defined to make those properties easier to prove.
 
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO why?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
While this is a simple definition of equality and reduction, others choices
 are possible, for instance it is possible to extend the relation with contextua
l information, type information, or even explicit proofs of equality as
 in ETT.
 
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO a little too scatterd so consider revising
\end_layout

\end_inset

 It is also common to assume the properties of 
\begin_inset Formula $\equiv$
\end_inset

 hold without proof.
\end_layout

\begin_layout Subsection
Equality
\end_layout

\begin_layout Subsubsection
\begin_inset Formula $\Rrightarrow$
\end_inset

, 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

, 
\begin_inset Formula $\equiv$
\end_inset

 are reflexive
\end_layout

\begin_layout Standard
The following rule is admissible,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{m}{m\Rrightarrow\,m}\,\textrm{\Rrightarrow-refl}
\]

\end_inset


\end_layout

\begin_layout Standard
by induction on the syntax of 
\begin_inset Formula $m$
\end_inset


\end_layout

\begin_layout Standard
Recall that 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 is reflexive by definition so
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{m}{m\equiv m}\,\textrm{\equiv-refl}
\]

\end_inset


\end_layout

\begin_layout Standard
is admissible.
\end_layout

\begin_layout Subsubsection
\begin_inset Formula $\Rrightarrow$
\end_inset

, 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

, 
\begin_inset Formula $\equiv$
\end_inset

 are closed under substitutions.
\end_layout

\begin_layout Standard
The following rule is admissible for every substitution 
\begin_inset Formula $\sigma$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO define substitutions, what properties are needed over substitutions?
 
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO is this lemma needed or is it jsut to accomodate stupid binding stuff
 in coq 
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{m\Rrightarrow m'}{m\left[\sigma\right]\Rrightarrow m'\left[\sigma\right]}\,\textrm{\Rrightarrow-sub-\sigma}
\]

\end_inset


\end_layout

\begin_layout Standard
by induction on the 
\begin_inset Formula $\Rrightarrow$
\end_inset

 relation, using 
\begin_inset Formula $\textrm{\Rrightarrow-refl}$
\end_inset

 in the 
\begin_inset Formula $\textrm{\Rrightarrow-var}$
\end_inset

 case.
\end_layout

\begin_layout Standard
The following rule is admissible where 
\begin_inset Formula $\sigma$
\end_inset

, 
\begin_inset Formula $\tau$
\end_inset

 is a substitution where for every 
\begin_inset Formula $x$
\end_inset

, 
\begin_inset Formula $\sigma\left(x\right)\Rrightarrow\tau\left(x\right)$
\end_inset

, written 
\begin_inset Formula $\sigma\Rrightarrow\tau$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{m\Rrightarrow m'\quad\sigma\Rrightarrow\tau}{m\left[\sigma\right]\Rrightarrow m'\left[\tau\right]}\,\textrm{\Rrightarrow-sub}
\]

\end_inset


\end_layout

\begin_layout Standard
by induction on the 
\begin_inset Formula $\Rrightarrow$
\end_inset

 relation.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{m\Rrightarrow_{\ast}m'\quad\sigma\Rrightarrow\tau}{m\left[\sigma\right]\Rrightarrow_{\ast}\,m'\left[\tau\right]}\,\textrm{\Rrightarrow_{\ast}-sub}
\]

\end_inset


\end_layout

\begin_layout Standard
is admissible by induction on the 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 relation.
 And follows that 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{m\equiv m'\quad\sigma\Rrightarrow\tau}{m\left[\sigma\right]\equiv m'\left[\tau\right]}\,\textrm{\equiv-sub}
\]

\end_inset


\end_layout

\begin_layout Standard
is admissible.
\end_layout

\begin_layout Subsubsection
\begin_inset Formula $\Rrightarrow$
\end_inset

, 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 is confluent, 
\begin_inset Formula $\equiv$
\end_inset

 is transitive
\end_layout

\begin_layout Standard
Confluent
\begin_inset Foot
status open

\begin_layout Plain Layout
also 
\begin_inset Quotes eld
\end_inset

Church-Rosser
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
By defining normalization with parallel reductions we can show confluence
 using the methods shown in 
\begin_inset CommandInset citation
LatexCommand cite
key "TAKAHASHI1995120"
literal "false"

\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
also well presented in 
\begin_inset CommandInset citation
LatexCommand cite
key "KOKKE2020102440"
literal "false"

\end_inset


\end_layout

\end_inset

.
 First define a function 
\begin_inset Formula $max$
\end_inset

 that takes the maximum possible parallel step, such that if 
\begin_inset Formula $m\Rrightarrow\,m'$
\end_inset

 then 
\begin_inset Formula $m'\Rrightarrow\,max\left(m\right)$
\end_inset

 and 
\begin_inset Formula $m\Rrightarrow\,max\left(m\right)$
\end_inset

, referred to as the triangle property.
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="5">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $max($
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\mathsf{fun}\,f\,x\Rightarrow m\right)_{\ensuremath{\ell}}\,n$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $)=$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $max\left(m\right)\left[f\coloneqq\mathsf{fun}\,f\,x\Rightarrow max\left(m\right),x\coloneqq max\left(n\right)\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
otherwise
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $max($
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $)=$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $max($
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m::_{\ensuremath{\ell}}M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $)=$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $max\left(m\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $max($
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $)=$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $max($
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:M_{\ensuremath{\ell}}\right)\rightarrow N_{\ensuremath{\ell'}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $)=$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:max\left(M\right)_{\ensuremath{\ell}}\right)\rightarrow max\left(N\right)_{\ensuremath{\ell'}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $max($
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $)=$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow max\left(m\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $max($
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m_{\ensuremath{\ell}}\,n$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $)=$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $max\left(m\right)_{\ensuremath{\ell}}\,max\left(n\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO for example, also diagrams
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
Triangle Property
\end_layout

\begin_layout Plain Layout
\begin_inset Formula $\ensuremath{\forall{\color{red}m},{\color{red}m'}.\:{\color{red}m\Rrightarrow m'}\:\rightarrow\:{\color{red}m'}{\color{blue}\Rrightarrow max\left(m\right)}}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzcd}
\end_layout

\begin_layout Plain Layout


\backslash
mathbin{
\backslash
color{red}m} 
\backslash
tarrow[red]{r} 
\backslash
arrow[lightgray]{d} & 
\backslash
mathbin{
\backslash
color{red}m'} 
\backslash
tarrow[blue]{ld} 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
mathbin{
\backslash
color{blue}max(m)}                  &              
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzcd}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
Diamond Property
\end_layout

\begin_layout Plain Layout
\begin_inset Formula $\forall{\color{red}m},{\color{red}m'},{\color{red}m''}.\:{\color{red}m\Rrightarrow m'}\:\wedge\:{\color{red}m\Rrightarrow m''}\:\rightarrow\:{\color{red}m'}{\color{blue}\Rrightarrow max\left(m\right)}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzcd}
\end_layout

\begin_layout Plain Layout

               & {
\backslash
color{red}m} 
\backslash
tarrow[red]{rd} 
\backslash
tarrow[red]{ld} 
\backslash
arrow[lightgray]{dd} &                
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

{
\backslash
color{red}m'} 
\backslash
tarrow[blue]{rd} &                                       & {
\backslash
color{red}m''} 
\backslash
tarrow[blue]{ld} 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

               & {
\backslash
color{blue}max(m)}                                &               
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzcd}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
Confluence
\end_layout

\begin_layout Plain Layout
\begin_inset Formula $\forall{\color{red}m},{\color{red}n},{\color{red}n'}.\:{\color{red}m\Rrightarrow_{\ast}n}\:\wedge\:{\color{red}m\Rrightarrow_{\ast}n'}\:\rightarrow\:\exists{\color{blue}n'''}.\:{\color{red}n}{\color{blue}\Rrightarrow_{\ast}{\color{blue}n'''}}\:\wedge\:{\color{red}n'}{\color{blue}\Rrightarrow{\color{blue}n'''}}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzcd}
\end_layout

\begin_layout Plain Layout

% TODO look into proper subscripting of arrow heads
\end_layout

\begin_layout Plain Layout

              & {
\backslash
color{red}m} 
\backslash
tarrow[red]{rd}[label={[pos=1,inner sep=0,outer sep=0]0:${
\backslash
ast}$}]{} 
\backslash
tarrow[red]{ld}[label={[pos=1,inner sep=0,outer sep=0]0:${
\backslash
ast}$}]{} &              
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

{
\backslash
color{red}n'}  
\backslash
tarrow[blue]{rd}[label={[pos=1,inner sep=0,outer sep=0]0:${
\backslash
ast}$}]{} &                         & {
\backslash
color{red}n''} 
\backslash
tarrow[blue]{ld}[label={[pos=1,inner sep=0,outer sep=0]0:${
\backslash
ast}$}]{} 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

              & {
\backslash
color{blue}{
\backslash
color{blue}n'''}}                      &                              
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzcd}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Rewriting Diagrams
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:shape-diagrams"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $m\Rrightarrow\,max\left(m\right)$
\end_inset

 
\end_layout

\begin_layout Standard
by induction on the cases of 
\begin_inset Formula $max$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO not needed?
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
if 
\begin_inset Formula $m\Rrightarrow\,m'$
\end_inset

 then 
\begin_inset Formula $m'\Rrightarrow max\left(m\right)$
\end_inset

 
\end_layout

\begin_layout Standard
by induction on the derivation 
\begin_inset Formula $m\Rrightarrow\,m'$
\end_inset

 , with the only interesting cases are where a reduction is not taken
\end_layout

\begin_layout Itemize
in the case of 
\begin_inset Formula $\textrm{\Rrightarrow-::}$
\end_inset

 , 
\begin_inset Formula $m'\Rrightarrow max\left(m\right)$
\end_inset

 by 
\begin_inset Formula $\textrm{\Rrightarrow-::-red}$
\end_inset


\end_layout

\begin_layout Itemize
in the case of 
\begin_inset Formula $\textrm{\Rrightarrow-fun-app}$
\end_inset

 , 
\begin_inset Formula $m'\Rrightarrow max\left(m\right)$
\end_inset

 by 
\begin_inset Formula $\textrm{\Rrightarrow-fun-app-red}$
\end_inset

 
\end_layout

\begin_layout Standard
it follows that 
\end_layout

\begin_layout Standard
if 
\begin_inset Formula $m\Rrightarrow\,m'$
\end_inset

, 
\begin_inset Formula $m\Rrightarrow\,m''$
\end_inset

, implies 
\begin_inset Formula $m'\Rrightarrow\,max\left(m\right)$
\end_inset

 ,
\begin_inset Formula $m''\Rrightarrow\,max\left(m\right)$
\end_inset

 , referred to as the diamond property
\end_layout

\begin_layout Standard
since the function 
\begin_inset Formula $max$
\end_inset

 will pick a unique term.
 
\end_layout

\begin_layout Standard
the diamond property implies the confluence of 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 
\end_layout

\begin_layout Standard
by repeated application of the diamond property
\end_layout

\begin_layout Standard
it follows that 
\begin_inset Formula $\equiv$
\end_inset

 is transitive
\end_layout

\begin_layout Subsection
Context Lemmas
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%TODO proof trick by deriving on the derivation, the context can grow and
 the induction is still well founded
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Typed Substitution
\end_layout

\begin_layout Standard
For any 
\begin_inset Formula $\Gamma\vdash x:N$
\end_inset

, the following rule is admissible
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\Gamma,x:N,\Gamma'\vdash m:M}{\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash m\left[x\coloneqq n\right]:M\left[x\coloneqq n\right]}
\]

\end_inset


\end_layout

\begin_layout Standard
by induction on typing derivations
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\Gamma\vdash m\,:\,M\quad{\color{gray}\Gamma\vdash}M\equiv M'{\color{gray}:\star}}{\Gamma\vdash m\,:\,M'}\,\textrm{ty-conv}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="34" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-}\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash\star\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-}\star$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-var}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $y:M\in\Gamma$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash y:M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-var}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\vdash y:M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by weakening 
\begin_inset Foot
status open

\begin_layout Plain Layout
unproven
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $y=x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash y:N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by assumption
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\vdash y:N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by weakening 
\begin_inset Foot
status open

\begin_layout Plain Layout
unproven
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N=M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $y=x$
\end_inset

, and context lookup is unique
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\vdash y:M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $y\in\Gamma'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $y:M\in\Gamma,x:N,\Gamma'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $y:M\left[x\coloneqq n\right]\in\Gamma,\Gamma'\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash y:M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-var}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-::}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash m\left[x\coloneqq n\right]:M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash m\left[x\coloneqq n\right]::M\left[x\coloneqq n\right]\,:\,M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-::}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-ty}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash M\left[x\coloneqq n\right]\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right],y:M\left[x\coloneqq n\right]\vdash N\left[x\coloneqq n\right]\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash\left(y:M\left[x\coloneqq n\right]\right)\rightarrow N\left[x\coloneqq n\right]\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-ty}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right],f:\left(y:N\left[x\coloneqq n\right]\right)\rightarrow M\left[x\coloneqq n\right],y:N\left[x\coloneqq n\right]\vdash m\left[x\coloneqq n\right]\,:\,M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash\mathsf{fun}\,f\,x\Rightarrow m\left[x\coloneqq n\right]\,:\,\left(x:N\left[x\coloneqq n\right]\right)\rightarrow M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-app}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash p\left[x\coloneqq n\right]\,:\,P\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash m\left[x\coloneqq n\right]\,:\,\left(y:P\left[x\coloneqq n\right]\right)\rightarrow M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash m\left[x\coloneqq n\right]\,p\left[x\coloneqq n\right]\,:\,M\left[x\coloneqq n\right]\left[y\coloneqq p\left[x\coloneqq n\right]\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-app}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash m\left[x\coloneqq n\right]\,p\left[x\coloneqq n\right]\,:\,M\left[y\coloneqq p,x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash m\left[x\coloneqq n\right]:M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma,x:N,\Gamma'\vdash}M\equiv M'{\color{gray}:\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by assumption
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $M\Rrightarrow_{\ast}M''$
\end_inset

, 
\begin_inset Formula $M'\Rrightarrow_{\ast}M''$
\end_inset

, ...
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by 
\begin_inset Formula $\equiv\textrm{-Def}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $M\left[x\coloneqq n\right]\Rrightarrow_{\ast}M''\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 closed under substitution 
\begin_inset Foot
status open

\begin_layout Plain Layout
reflexive corollary
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $M'\left[x\coloneqq n\right]\Rrightarrow_{\ast}M''\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset

 closed under substitution 
\begin_inset Foot
status open

\begin_layout Plain Layout
reflexive corollary
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash}M\left[x\coloneqq n\right]\equiv M\left[x\coloneqq n\right]'{\color{gray}:\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\equiv\textrm{-Def}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,\Gamma'\left[x\coloneqq n\right]\vdash m\left[x\coloneqq n\right]:M'\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Subsubsection
Substitution by steps
\end_layout

\begin_layout Standard
The following rule is admissible
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{n\Rrightarrow_{\ast}n'\quad{\color{gray}\Gamma\vdash m\left[x\coloneqq n\right]:M}}{{\color{gray}\Gamma\vdash}m\left[x\coloneqq n\right]\equiv m\left[x\coloneqq n'\right]{\color{gray}:M}}
\]

\end_inset


\end_layout

\begin_layout Standard
since
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n\Rrightarrow_{\ast}n'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by assumption
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m\Rrightarrow_{\ast}m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by refl
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m\left[x\coloneqq n\right]\Rrightarrow_{\ast}m\left[x\coloneqq n'\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by sub by steps
\begin_inset Foot
status open

\begin_layout Plain Layout
unproven
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m\left[x\coloneqq n'\right]\Rrightarrow_{\ast}m\left[x\coloneqq n'\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by refl
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash}m\left[x\coloneqq n\right]\equiv m\left[x\coloneqq n'\right]{\color{gray}:M}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\equiv\textrm{-Def}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Subsubsection
Context Equivalence
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\ }{\lozenge\equiv\lozenge}\,\textrm{\equiv-ctx-empty}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\Gamma\equiv\Gamma'\quad{\color{gray}\Gamma\vdash}M\equiv M'{\color{gray}:\star}\quad{\color{gray}\Gamma'\vdash M':\star}}{\Gamma,x:M\equiv\Gamma',x:M'}\,\textrm{\equiv-ctx-ext}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Contextual Equivalence
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-Context-Equiv"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Context Preservation
\end_layout

\begin_layout Standard
the following rule is admissible
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\Gamma\vdash n:N\quad\Gamma\equiv\Gamma'}{\Gamma'\vdash n:N}
\]

\end_inset


\end_layout

\begin_layout Standard
by induction over typing derivations, by mutual induction with
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{{\color{gray}\Gamma\vdash}n\equiv n'{\color{gray}:N}\quad\Gamma\equiv\Gamma'}{{\color{gray}\Gamma\vdash}n\equiv n'{\color{gray}:N}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="37" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-}\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma'\vdash}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by 
\begin_inset Formula $\Gamma\equiv\Gamma'$
\end_inset

 
\begin_inset Foot
status open

\begin_layout Plain Layout
TODO
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash\star\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-}\star$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-var}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma'\vdash}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by 
\begin_inset Formula $\Gamma\equiv\Gamma'$
\end_inset

 
\begin_inset Foot
status open

\begin_layout Plain Layout
TODO
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x:M\in\Gamma$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by assumption
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x:M'\in\Gamma'$
\end_inset

, 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula ${\color{gray}\Gamma\vdash}M\equiv M'{\color{gray}:\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by 
\begin_inset Formula $\Gamma\equiv\Gamma'$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash x:M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-var}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula ${\color{gray}\Gamma\vdash}M'\equiv M{\color{gray}:\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by symmetry
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash x:M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by assumption
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash m\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash}M\equiv M'{\color{gray}:\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by assumption
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma'\vdash M\equiv M'}{\color{gray}:\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by mutual induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash m\,:\,M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-::}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash m\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m::M\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-::}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-ty}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash M\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,x:M\equiv\Gamma',x:M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
...
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma',x:M\vdash N\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction...
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash\left(x:M\right)\rightarrow N\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-ty}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by assumption
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash\left(x:N\right)\rightarrow M\,:\,\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by regularity
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma'\vdash\left(x:N\right)\rightarrow M\,:\,\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\equiv\Gamma'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by assumption
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,f:\left(x:N\right)\rightarrow M\equiv\Gamma',f:\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by context extention
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma,f:\left(x:N\right)\rightarrow M\vdash N\,:\,\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by regularity
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma',f:\left(x:N\right)\rightarrow M\vdash N\,:\,\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,f:\left(x:N\right)\rightarrow M,x:N\equiv\Gamma',f:\left(x:N\right)\rightarrow M,x:N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by context extension
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\Gamma',f:\left(x:N\right)\rightarrow M,x:N\vdash m\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash\mathsf{fun}\,f\,x\Rightarrow m\,:\,\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-app}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash m\,:\,\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash n\,:\,N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma'\vdash m\,n\,:\,M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-app}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\equiv\textrm{-Def}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash n:N}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by assumption
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma'\vdash n:N}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by mutual induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash n':N}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by assumption
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma'\vdash n':N}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by mutual induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma'\vdash n\equiv n'{\color{gray}:N}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\equiv\textrm{-Def}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Subsection
Stability(which section?)
\end_layout

\begin_layout Standard
\begin_inset Formula $\forall N,M,P.\left(x:N\right)\rightarrow M\Rrightarrow_{\ast}P\:\Rightarrow\:\exists N',M'.P=\left(x:N'\right)\rightarrow M'\land N\Rrightarrow_{\ast}N'\land M\Rrightarrow_{\ast}M'$
\end_inset


\end_layout

\begin_layout Standard
by induction on 
\begin_inset Formula $\Rrightarrow_{\ast}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow_{\ast}-refl}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P=\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by assumption
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N\Rrightarrow_{\ast}N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow_{\ast}-refl}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $M\Rrightarrow_{\ast}M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow_{\ast}-refl}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow_{\ast}-trans}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:N\right)\rightarrow M\Rrightarrow_{\ast}P'$
\end_inset

, 
\begin_inset Formula $P'\Rrightarrow P''$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by assumption
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P'=\left(x:N'\right)\rightarrow M'$
\end_inset

, 
\begin_inset Formula $N\Rrightarrow_{\ast}N'$
\end_inset

, 
\begin_inset Formula $M\Rrightarrow_{\ast}M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P''=\left(x:N''\right)\rightarrow M''$
\end_inset

, 
\begin_inset Formula $N'\Rrightarrow N''$
\end_inset

, 
\begin_inset Formula $M'\Rrightarrow M''$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by inspection, only the 
\begin_inset Formula $\textrm{\Rrightarrow-fun-ty}$
\end_inset

 rule is possible
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N\Rrightarrow_{\ast}N''$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow_{\ast}-trans}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $M\Rrightarrow_{\ast}M''$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow_{\ast}-trans}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
Therefore the following rule is admissible
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{{\color{gray}\Gamma\vdash}\left(x:N\right)\rightarrow M\equiv\left(x:N'\right)\rightarrow M'{\color{gray}:\star}}{{\color{gray}\Gamma\vdash}N\equiv N'{\color{gray}:\star}\quad{\color{gray}\Gamma,x:N'\vdash}M\equiv M'{\color{gray}:\star}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash\left(x:N\right)\rightarrow M:\star,}\quad{\color{gray}\Gamma\vdash\left(x:N'\right)\rightarrow M':\star,}\quad\left(x:N\right)\rightarrow M\Rrightarrow_{\ast}P,\quad\left(x:N'\right)\rightarrow M'\Rrightarrow_{\ast}P$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by expending the definition of 
\begin_inset Formula $\equiv$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P=\left(x:N''\right)\rightarrow M''$
\end_inset

, 
\begin_inset Formula $N\Rrightarrow_{\ast}N''$
\end_inset

, 
\begin_inset Formula $M\Rrightarrow_{\ast}M''$
\end_inset

, 
\begin_inset Formula $N'\Rrightarrow_{\ast}N''$
\end_inset

, 
\begin_inset Formula $M'\Rrightarrow_{\ast}M''$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by the lemma above
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash N:\star,}$
\end_inset

 
\begin_inset Formula ${\color{gray}\Gamma,x:N\vdash M:\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by fun-ty inversion 
\begin_inset Foot
status open

\begin_layout Plain Layout
fwd 
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash N':\star,}$
\end_inset

 
\begin_inset Formula ${\color{gray}\Gamma,x:N'\vdash M':\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by fun-ty inversion 
\begin_inset Foot
status open

\begin_layout Plain Layout
fwd 
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash}N\equiv N'{\color{gray}:\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by the definition of 
\begin_inset Formula $\equiv$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma,x:N\equiv\Gamma,x:N'}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by context refl, extended
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma,x:N'\vdash M':\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by the preservation of ctx.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma,x:N'\vdash}M\equiv M'{\color{gray}:\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by the definition of 
\begin_inset Formula $\equiv$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Subsection
Inversions(which section?)
\end_layout

\begin_layout Standard
TODO explanation
\end_layout

\begin_layout Standard
we can show this more general rule
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\Gamma\vdash\mathsf{fun}\,f\,x\Rightarrow m\,:\,P\quad{\color{gray}\Gamma\vdash}P\equiv\left(x:N\right)\rightarrow M{\color{gray}:\star}}{\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m:M}
\]

\end_inset


\end_layout

\begin_layout Standard
is admissible.
 By induction,
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="12" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,f:\left(x:N'\right)\rightarrow M',x:N'\vdash m\,:\,M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by assumption
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash}\left(x:N'\right)\rightarrow M'\equiv\left(x:N\right)\rightarrow M{\color{gray}:\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by assumption
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash}N'\equiv N{\color{gray}:\star},\quad{\color{gray}\Gamma,x:N\vdash}M'\equiv M{\color{gray}:\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by stability of fun-ty
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,f:\left(x:N'\right)\rightarrow M',x:N'\equiv\Gamma,f:\left(x:N\right)\rightarrow M,x:N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by reflexivity of 
\begin_inset Formula $\equiv$
\end_inset

 , extended with previous equalities
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m\,:\,M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by preservation of contexts
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m:M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash\mathsf{fun}\,f\,x\Rightarrow m\,:\,P'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by assumption
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash}P\equiv P'{\color{gray}:\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by assumption
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash}P'\equiv\left(x:N\right)\rightarrow M{\color{gray}:\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by assumption
\begin_inset Foot
status open

\begin_layout Plain Layout
clean up some of these assumptions?
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash}P\equiv\left(x:N\right)\rightarrow M{\color{gray}:\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by transitivity
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m:M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
other rules
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
impossible
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
the term position has the form 
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
This allows us to conclude the more strait-forward rule 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\Gamma\vdash\mathsf{fun}\,f\,x\Rightarrow m\,:\,\left(x:N\right)\rightarrow M}{\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m:M}
\]

\end_inset


\end_layout

\begin_layout Standard
by noting that 
\end_layout

\begin_layout Standard
\begin_inset Formula ${\color{gray}\Gamma\vdash}\left(x:N\right)\rightarrow M\equiv\left(x:N\right)\rightarrow M{\color{gray}:\star}$
\end_inset

, by reflexivity 
\begin_inset ERT
status open

\begin_layout Plain Layout

%gray by regularity
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Preservation
\end_layout

\begin_layout Subsubsection
\begin_inset Formula $\Rrightarrow$
\end_inset

-Preservation 
\end_layout

\begin_layout Standard
The following rule is admissible
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\Gamma\vdash m:M\quad m\Rrightarrow m'}{\Gamma\vdash m':M}
\]

\end_inset


\end_layout

\begin_layout Standard
can now be proven by induction on the typing derivation 
\begin_inset Formula $\Gamma\vdash m:M$
\end_inset

, specializing on 
\begin_inset Formula $m\Rrightarrow m'$
\end_inset

,
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="43" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-}\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow-}\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash\star\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
follows directly
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-var}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow-var}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash x\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
follows directly
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
all 
\begin_inset Formula $\Rrightarrow$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m\Rrightarrow m'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\Gamma\vdash m'\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash}M\equiv M'{\color{gray}:\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by assumption
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m'\,:\,M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-::}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow-::-red}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m\Rrightarrow m'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m'\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow-::}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m\Rrightarrow m'$
\end_inset

, 
\begin_inset Formula $M\Rrightarrow M'$
\end_inset

,
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m'\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m'::M':\,M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-::}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash M\,:\,\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by regularity 
\begin_inset Foot
status open

\begin_layout Plain Layout
not proven
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash M'\,:\,\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\begin_inset Foot
status open

\begin_layout Plain Layout
this use of induction is well founded, TODO
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash}M'\equiv M{\color{gray}:\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by promoting 
\begin_inset Formula $M\Rrightarrow M'$
\end_inset

, symmetry
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m'::M':\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-ty}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow-fun-ty}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N\Rrightarrow N'$
\end_inset

, 
\begin_inset Formula $M\Rrightarrow M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash M'\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,x:M\vdash N'\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash M:\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by assumption
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash}M\equiv M'{\color{gray}:\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by promoting 
\begin_inset Formula $M\Rrightarrow M'$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,x:M\equiv\Gamma,x:M'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by reflexivity of 
\begin_inset Formula $\equiv$
\end_inset

 , extended with 
\begin_inset Formula $M\equiv M'$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,x:M'\vdash N'\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by preservation of contexts
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash\left(x:M\right)\rightarrow N\,:\,\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-ty}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow-fun}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m\Rrightarrow m'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m'\,:\,M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash\mathsf{fun}\,f\,x\Rightarrow m'\,:\,\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-app}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow-fun-app-red}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m\Rrightarrow m'$
\end_inset

, 
\begin_inset Formula $n\Rrightarrow n'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash\mathsf{fun}\,f\,x\Rightarrow m'\,:\,\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by fun-inversion
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\Gamma\vdash n'\,:\,N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m'\left[f\coloneqq\mathsf{fun}\,f\,x\Rightarrow m',x\coloneqq n'\right]:M\left[x\coloneqq n'\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by substitutions (
\begin_inset Formula $f$
\end_inset

 is not free in 
\begin_inset Formula $M$
\end_inset

)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash n:N}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by assumption
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash}M\left[x\coloneqq n\right]\equiv M\left[x\coloneqq n'\right]{\color{gray}:\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by substitution by steps
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash}M\left[x\coloneqq n'\right]\equiv M\left[x\coloneqq n\right]{\color{gray}:\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by 
\begin_inset Formula $\equiv$
\end_inset

 symmetry
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m'\left[f\coloneqq\mathsf{fun}\,f\,x\Rightarrow m',x\coloneqq n'\right]:M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{\Rrightarrow-fun-app}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m\Rrightarrow m'$
\end_inset

, 
\begin_inset Formula $n\Rrightarrow n'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m'\,:\,\left(x:N\right)\rightarrow M$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash n'\,:\,N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by induction
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m'\,n':\,M\left[x\coloneqq n'\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-fun-app}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash n:N}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by assumption
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash}M\left[x\coloneqq n\right]\equiv M\left[x\coloneqq n'\right]{\color{gray}:\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by substitution by steps
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${\color{gray}\Gamma\vdash}M\left[x\coloneqq n'\right]\equiv M\left[x\coloneqq n\right]{\color{gray}:\star}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
by 
\begin_inset Formula $\equiv$
\end_inset

 symmetry
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma\vdash m'\left[f\coloneqq\mathsf{fun}\,f\,x\Rightarrow m',x\coloneqq n'\right]:M\left[x\coloneqq n\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{ty-conv}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Subsection
Progress
\end_layout

\begin_layout Standard
The 2nd key lemma in a progress and preservation proof is to show that,
 computation is 
\begin_inset Quotes eld
\end_inset

complete
\begin_inset Quotes erd
\end_inset

 or that a further computation be taken.
 For non dependently typed programming languages, these steps are easy to
 characterize, but for dependent types there are issues.
 If we characterize the parstep relation as the computation used in progress,
 the lemma holds in a meaningless way since we can always take a reflexive
 step.
 Thus we need a non-reflexive stepping relation, ideally one that is determinist
ic and that is a sub relation of 
\begin_inset Formula $\Rrightarrow_{*}$
\end_inset

.
 We can choose Call-by-value relation since this meets all the properties
 required, and is a standard execution strategy.
 A deterministic reflexive evaluation strategy exists.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="none" valignment="top" usebox="none" special="l">
\begin_inset Text

\begin_layout Plain Layout
values,
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
v
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Coloneqq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\star$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(x:M_{\ensuremath{\ell}}\right)\rightarrow N_{\ensuremath{\ell'}}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
|
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow m$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Surface Language Value Syntax
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-value-syntax"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Values are characterized by the sub-grammar in 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:surface-value-syntax"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 As usual, functions with any body are values.
 Additionally the Type universe is a value, and function types 
\begin_inset Foot
status open

\begin_layout Plain Layout
evaluated to whnf
\end_layout

\end_inset

 are values.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\,}{\left(\mathsf{fun}\,f\,x\Rightarrow m\right)_{\ell}v\rightsquigarrow m\left[f\coloneqq\mathsf{fun}\,f\,x\Rightarrow m,x\coloneqq v\right]}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{m\rightsquigarrow m'}{m_{\ell}\,n\rightsquigarrow m'_{\ell}\,n}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{n\rightsquigarrow n'}{v_{\ell}\,n\rightsquigarrow v_{\ell}\,n'}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{m\rightsquigarrow m'}{m::_{\ensuremath{\ell}}M\rightsquigarrow m'::_{\ensuremath{\ell}}M}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{\,}{v::_{\ensuremath{\ell}}M\rightsquigarrow v}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: Note the location data makes this dangerous
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Surface Language Call-by-Value reductions
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-reduction-step"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
A call-by-values relation is defined in 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:surface-reduction-step"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The reductions are standard for a call-by-value lambda calculus, except
 that type annotations are removed from values.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO explicitly define stuck, transition from scare quats
\end_layout

\end_inset


\end_layout

\begin_layout Standard
the following rules are admissible
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{m\rightsquigarrow m'}{m\Rrightarrow m'}
\]

\end_inset


\end_layout

\begin_layout Standard
Thus it is is preservation preserving.
\end_layout

\begin_layout Subsection
Type Soundness
\end_layout

\begin_layout Standard
The language has type soundness, well typed terms will never 
\begin_inset Quotes eld
\end_inset

get stuck
\begin_inset Quotes erd
\end_inset

 in the surface language.
 This follows by iterating the progress and preservation lemmas.
\end_layout

\begin_layout Subsection
Type checking is impractical
\end_layout

\begin_layout Standard
This type system is inherently non-local.
 No type annotations are ever required to form a derivation.
 That means it would be up to a type checking algorithm to guess the types
 of intermediate terms.
 For instance, 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\lambda f\Rightarrow & \,\\
... & f\,1_{c}\,true_{c}\\
... & f\,0_{c}\,1_{c}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
what should be deduced for the type of 
\begin_inset Formula $f$
\end_inset

? One possibility is 
\begin_inset Formula $f:\left(n:\mathbb{N}\right)\rightarrow n\,\star\,\left(\lambda-\Rightarrow\mathbb{N}_{c}\right)\,\mathbb{B}_{c}\rightarrow...$
\end_inset

.
 But there are infinitely other possibilities.
 Worse, if there is an error, it may be impossible to localize.
 To make a practical type checker we need to insist that the user include
 some type annotations.
\end_layout

\begin_layout Section
Bi-directional Surface Language
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% Annotate all the vars
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
There are many possible way to localize the type checking process.
 We could ask that all variable be annotated at binders.
 This is ideal from a theoretical perspective since it matches how type
 contexts are built up.
\end_layout

\begin_layout Standard
However note that, our proof of 
\begin_inset Formula $\lnot1_{c}\doteq_{\mathbb{N}_{c}}0_{c}$
\end_inset

 will look like
\end_layout

\begin_layout Standard
\begin_inset Formula $\lambda pr:1_{c}\doteq_{\mathbb{N}_{c}}0_{c}\Rightarrow pr\,\left(\lambda n:\left(C:\left(\mathbb{N}_{c}\rightarrow\star\right)\right)\rightarrow C\,1_{c}\rightarrow C\,0_{c}\Rightarrow n\,\star\,(\lambda-:\star\Rightarrow Unit_{c})\,\perp_{c}\right)\,tt_{c}:\lnot1_{c}\doteq_{\mathbb{N}_{c}}0_{c}$
\end_inset


\end_layout

\begin_layout Standard
Annotating every binding site requires a lot of redundant annotations.
 Luckily there's a better way, Bi-directional type checking.
\end_layout

\begin_layout Subsection
Bi-directional type checking
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO also site teh clearer tutorial paper
\end_layout

\end_inset

 Bidirectional type-checking is a popular form of lightweight type inference,
 and strikes a good compromise between the required type annotations and
 the simplicity of the theory, allowing for localized errors 
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
\begin_inset CommandInset citation
LatexCommand cite
key "christiansen2013bidirectional"
literal "false"

\end_inset

 is a good tutorial, 
\begin_inset CommandInset citation
LatexCommand cite
key "10.1145/3450952"
literal "false"

\end_inset

 is a survey
\end_layout

\end_inset

.
 In the usual bidirectional bidirectional typing scheme annotations are
 only required at the top-level, or around a lambda that is applied to an
 argument
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
more generally when an elimination reduction is possible
\end_layout

\end_inset

.
 Since programers rarely write functions that are immediately evaluated,
 this style of type checking usually only needs top level functions to be
 annotated
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Even in Haskell, with full Hindley-Milner type inference, top level type
 annotations are encouraged.
\end_layout

\end_inset

.
 In fact, every example in 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:surface-exemples"
plural "false"
caps "false"
noprefix "false"

\end_inset

 has enough annotations to type-check bidirectionally as written.
 
\end_layout

\begin_layout Standard
This is accomplished by breaking typing judgments into two forms: 
\end_layout

\begin_layout Itemize
Inference judgments where type information propagates out of a term, 
\begin_inset Formula $\overrightarrow{\,:\,}$
\end_inset

 in our notation.
 
\end_layout

\begin_layout Itemize
And Checking judgments where a type is checked against a term, 
\begin_inset Formula $\overleftarrow{\,:\,}$
\end_inset

 in our notation.
 
\end_layout

\begin_layout Standard
This allows typing information to flow from the outside in for checking
 judgments and inside out for inference judgments.
 When an inference flows into a conversion check verifies that the types
 are equal.
 This has the advantage of precisely limiting where conv rule can be used,
 since conversion checking is usually the least efficient part of type checking.
\end_layout

\begin_layout Standard
This enforced flow results in a system that localizes type information.
 If a type was inferred it was unique, so it can be used freely.
 Checking judgments localize their their check, even if the underlying term
 could support multiple types.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO convert one to the other, emphasize locality
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Formula 
\[
\frac{x:M\in\Gamma}{\Gamma\vdash x\overrightarrow{\,:\,}M}\operatorname{\overrightarrow{ty}-var}
\]

\end_inset


\begin_inset Formula 
\[
\frac{\Gamma\vdash}{\Gamma\vdash\star\overrightarrow{\,:\,}\star}\operatorname{\overrightarrow{ty}-\star}
\]

\end_inset


\begin_inset Formula 
\[
\frac{\Gamma\vdash m\overleftarrow{\,:\,}M\quad\Gamma\vdash M\overleftarrow{\,:\,}\star}{\Gamma\vdash m::_{\ell}M\overrightarrow{\,:\,}M}\operatorname{::-\overrightarrow{ty}}
\]

\end_inset


\begin_inset Formula 
\[
\frac{\Gamma\vdash M\overleftarrow{\,:\,}\star\quad\Gamma,x:M\vdash N\overleftarrow{\,:\,}\star}{\Gamma\vdash\left(x:M\right)\rightarrow N\overrightarrow{\,:\,}\star}\operatorname{\overrightarrow{ty}-fun-ty}
\]

\end_inset


\begin_inset Formula 
\[
\frac{\Gamma\vdash m\overrightarrow{\,:\,}\left(x:N\right)\rightarrow M\quad\Gamma\vdash n\overleftarrow{\,:\,}N}{\Gamma\vdash m\,n\overrightarrow{\,:\,}M\left[x\coloneqq n\right]}\operatorname{\overrightarrow{ty}-fun-app}
\]

\end_inset


\begin_inset Formula 
\[
\frac{\Gamma,f:\left(x:N\right)\rightarrow M,x:N\vdash m\overleftarrow{\,:\,}M}{\Gamma\vdash\mathsf{fun}\,f\,x\Rightarrow m\overleftarrow{\,:\,}\left(x:N\right)\rightarrow M}\operatorname{\overleftarrow{ty}-\mathsf{fun}}
\]

\end_inset


\begin_inset Formula 
\[
\frac{\Gamma\vdash m\overrightarrow{\,:\,}M\quad\Gamma\vdash M\equiv M':\star}{\Gamma\vdash m\overleftarrow{\,:\,}M'}\operatorname{\overleftarrow{ty}-conv}
\]

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

% also include context rules?
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Surface Language Bidirectional Typing Rules
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:surface-bityping-rules"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% review the typing rule 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The surface language supports bidirectional type-checking over the pre-syntax
 with the rules in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:surface-bityping-rules"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 These rules are the same as before but the information flow of typing is
 now explicit in the judgment.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% For example...
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
The bidirectional system is type sound
\end_layout

\begin_layout Standard
It is possible to prove bidirectional systems are type sound directly
\begin_inset CommandInset citation
LatexCommand cite
key "nanevski2005dependent"
literal "false"

\end_inset

, but would seem to require constraining the syntax in unrealistic ways
\begin_inset Foot
status open

\begin_layout Plain Layout
by dividing the syntax explicitly into introduction and elimination forms
\end_layout

\end_inset

.
 Alternatively we can show by mutual induction that a bidirectional typing
 judgment implies a Type assignment system typing judgment.
\end_layout

\begin_layout Itemize
if 
\begin_inset Formula $\Gamma\vdash m\overrightarrow{\,:\,}M$
\end_inset

 then 
\begin_inset Formula $\Gamma\vdash m\,:\,M$
\end_inset


\end_layout

\begin_layout Itemize
if 
\begin_inset Formula $\Gamma\vdash m\overleftarrow{\,:\,}M$
\end_inset

 then 
\begin_inset Formula $\Gamma\vdash m\,:\,M$
\end_inset


\end_layout

\begin_layout Standard
by mutual induction on the bidirectional typing derivations.
 
\end_layout

\begin_layout Subsection
The Bidirectional system is conservative
\end_layout

\begin_layout Standard
Additionally we can show that the bidirectional system does not preclude
 any computation available in the type assignment system.
 Formally
\end_layout

\begin_layout Itemize
if 
\begin_inset Formula $\Gamma\vdash m\,:\,M$
\end_inset

 then 
\begin_inset Formula $\Gamma\vdash m'\overrightarrow{\,:\,}M$
\end_inset

 , 
\begin_inset Formula $\Gamma\vdash m'\overleftarrow{\,:\,}M$
\end_inset

, and 
\begin_inset Formula $m\equiv m'$
\end_inset


\end_layout

\begin_layout Standard
by induction on the typing derivation, adding annotations at each step that
 are convertible with the original 
\begin_inset Formula $m$
\end_inset


\end_layout

\begin_layout Section
Absent Logical Properties
\end_layout

\begin_layout Standard
When type systems are considered as a logic, it is desirable that
\end_layout

\begin_layout Itemize
There exists an empty type that is uninhabited in the empty context, it
 is 
\series bold
logically sound
\series default

\begin_inset Foot
status open

\begin_layout Plain Layout
also called 
\begin_inset Quotes eld
\end_inset

consistent
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset

.
\end_layout

\begin_layout Itemize
The conversion system normalizes.
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: remove?
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Type checking is decidable.
\end_layout

\begin_layout Standard
The surface system has non of these properties
\begin_inset Foot
status open

\begin_layout Plain Layout
These properties are usually shown be showing that the computation that
 generates conversion is normalizing.
 Some proofs can be found in Chapter 4
\begin_inset CommandInset citation
LatexCommand cite
key "luo1990extended,luo1994computation"
literal "false"

\end_inset

 
\end_layout

\end_inset

.
 
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: aparently that note from Chris Casinghino is dead http://prosecco.gforge.i
nria.fr/personal/hritcu/temp/snforcc.pdf
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Logical Unsoundness
\end_layout

\begin_layout Standard
The surface language is logically unsound, every type is inhabited.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: proper example formatting
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Every type is inhabited (by recursion)
\end_layout

\begin_layout Standard
\begin_inset Formula $\mathsf{fun}\,f\,x\Rightarrow f\,x\qquad:\perp_{c}$
\end_inset


\end_layout

\begin_layout Subsubsection
Every type is inhabited (by Type-in-type)
\end_layout

\begin_layout Standard
It is possible to encode Girard's paradox, producing another source of logical
 unsoundness.
 A subtle form of recursive behavior can be built out of Gerard's paradox
\begin_inset CommandInset citation
LatexCommand cite
key "Reinhold89typecheckingis"
literal "false"

\end_inset

, but this behavior is no worse then the unrestricted recursion already
 allowed.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: cite stuff (see https://stackoverflow.com/questions/18178999/do-agda-prog
rams-necessarily-terminate), 
\end_layout

\begin_layout Plain Layout

% of course this hapens in Girard's french thesis
\end_layout

\end_inset


\end_layout

\begin_layout Standard
I am unaware of anyone accidentally encountering a falsehood from type-in-type.
 
\end_layout

\begin_layout Subsubsection
logical unsoundness
\end_layout

\begin_layout Standard
While the surface language supports proofs, not every term typed in the
 surface language is a proof.
\end_layout

\begin_layout Standard
Logical soundness seems not to matter in programming practice.
 For instance, in ML the type 
\begin_inset Formula $\mathtt{f:Int->Int}$
\end_inset

 does not imply the termination of 
\begin_inset Formula $\mathtt{f\,2}$
\end_inset

.
 While unproductive non-termination is always a bug, it seems an easy bug
 to detect and fix when it occurs.
 In mainstream languages, types help to communicate the intent of termination,
 even though termination is not guaranteed by the type system.
 Importantly, no desirable computation is prevented in order to preserve
 logical soundness.
 There will never be a way to include all the terminating computations and
 exclude all the nonterminating computations.
 A tradeoff must be made.
 Therefore, logical unsoundness seems suitable for a dependently typed programmi
ng language.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: talk about alternatives.
  cite proofs of nontermination
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The most popular ....
 Forcing logical soundness incurs a real cost...
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: could still preform checks
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Terms can still be called proofs as long as the safety of recursion and
 type-in-type are monitored externally.
 In this sense the inequalities listed are proofs, they make no use of general
 recursion and match implementations from CIC such that universe hierarchies
 could be assigned.
 External means can still verify the desired properties, an automated process
 could supply warnings when unsafe constructs are used, traditional software
 testing can be used to discover proof bugs.
 Even though the system is not logically sound, neither are informal paper
 and pencil proofs.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO: add ref to inequalities
\end_layout

\end_inset


\end_layout

\begin_layout Standard
This architecture is resilient to change.
 Where a change in the termination checking code of Coq might cause a proof
 script to no longer run, here the code will always behave in the same way.
\end_layout

\begin_layout Subsection
Type checking is undecidable
\end_layout

\begin_layout Standard
Given a thunk 
\begin_inset Formula $f:Unit$
\end_inset

 defined in pcf, it can be encoded into the surface system as a thunk 
\begin_inset Formula $f':Unit_{c}$
\end_inset

 , such that if 
\begin_inset Formula $f$
\end_inset

 reduces to the canonical 
\begin_inset Formula $Unit$
\end_inset

 then 
\begin_inset Formula $f'\Rrightarrow^{*}\lambda A.\lambda a.a$
\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Formula $\vdash\star:f'\,\star\,\star$
\end_inset

 type-checks by conversion exactly when 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $f$
\end_inset

 halts
\end_layout

\begin_layout Standard
If there is a procedure to decide type checking we can decide exactly when
 any pcf function halts.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% normalization
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Undecidability of type checking is not as bad as it sounds for several reasons.
 First, the pathological terms that cause normalization are rarely created
 on purpose.
 In the bidirectional system, conversion checks will only happen at limited
 positions, it is possible to use a counter to warn or give errors at code
 that does not convert because normalization takes too long.
 Heuristic methods of normalization seem to work well enough in practice
 even without a counter.
 It is also possible to embed proofs of conversion directly into the syntax
 as in
\begin_inset CommandInset citation
LatexCommand cite
key "sjoberg2012irrelevance"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
Many dependent type systems, such as Agda, Coq, and Lean, aspire to decidable
 type checking.
 However these systems allow extremely fast growing functions to be encoded
 (such as Ackerman's function).
 This large function can check some concrete but difficult property, (how
 many Turing machines whose code is smaller then 
\begin_inset Formula $n$
\end_inset

 halt in 
\begin_inset Formula $n$
\end_inset

 steps?).
 When this kind of computation is lifted to the type level, type checking
 is computationally infeasible.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO example
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Many mainstream type systems have undecidable.
 If a language admits a Turing complete macro or preprocessor system that
 can modify typing, this would make type checking undecidable (this would
 technically make the type system of C, C++, Scala, and Rust undecidable).
 Unless type features are considered very carefully, they can often create
 undecidable type checking (Java generics and OCaml modules, make type checking
 undecidable in those languages respectively).
 Haskell may be the most popular language with with a static type system
 that allows decidable type checking (thought it is often more convenient
 to use GHC compiler flags that make type checking undecidable).
 Even the Hindley-Milner type checking algorithm that underlies Haskell
 and ML, has a double exponential complexity, which under normal circumstances
 would be considered intractable.
\end_layout

\begin_layout Standard
In practice these theoretical concerns are not born out since the worst
 that can happen is the type checking can time-out in the compilation process.
 When this happens programmers can fix their codes, macros, or add typing
 annotations.
 Programers in conventional languages are already entrusted with almost
 unlimited power to cause harm, programs regularly delete files, read and
 modify sensitive information, and send emails.
 Relatively speaking, undecidable type checking is not a concern.
\end_layout

\begin_layout Standard
Finally, for the system descried in this thesis, users are expected to use
 the elaboration procedure defined in the next chapter that will bypass
 the type checking described here.
 That elaboration procedures is also undecidable, but only for extremely
 pathological terms.
\end_layout

\begin_layout Section
Related work
\end_layout

\begin_layout Subsection
Bad logics, ok programming languages?
\end_layout

\begin_layout Standard
Unsound logical systems that work as programming languages go back to at
 least Church's lambda calculus which was originally intended to be part
 of a foundation for mathematics
\begin_inset Foot
status open

\begin_layout Plain Layout
\begin_inset Quotes eld
\end_inset

There may, indeed, be other applications of the system than its use as a
 logic.
\begin_inset Quotes erd
\end_inset

 [Church, 1932, p.349, A Set of Postulates for the Foundation of Logic]
\end_layout

\end_inset

.
 In the 1970s, Martin-Lf proposed a system with Type-in-Type that was shown
 logically unsound by Girard (as described in the introduction in 
\begin_inset CommandInset citation
LatexCommand cite
key "Martin-Lof-1972"
literal "false"

\end_inset

).
 In the 1980s, Cardelli explored the domain semantics of a system with general
 recursive dependent functions and Type-in-Type
\begin_inset CommandInset citation
LatexCommand cite
key "cardelli1986polymorphic"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
The first direct proof of type soundness for a language with general recursive
 dependent functions, Type-in-Type, and dependent data that I am aware of
 came form the Trellys Project 
\begin_inset CommandInset citation
LatexCommand cite
key "sjoberg2012irrelevance"
literal "false"

\end_inset

.
 At the time their language had several additional features not included
 in my surface language.
 Additionally, my surface language uses a simpler notion of equality and
 dependent data resulting in an arguably simpler proof of type soundness.
 Later work in the Trellys Project
\begin_inset CommandInset citation
LatexCommand cite
key "casinghino2014combining,casinghino2014combiningthesis"
literal "false"

\end_inset

 used modalities to separate terminating and non-terminating fragments of
 the language, to allow both general recursion and logically sound reasoning
\begin_inset ERT
status open

\begin_layout Plain Layout

%, though the annotation burden seems high in retrospect
\end_layout

\end_inset

 .
 In general, the base language has been deeply informed by the Trellys project
\begin_inset CommandInset citation
LatexCommand cite
key "sjoberg2012irrelevance"
literal "false"

\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "casinghino2014combining,casinghino2014combiningthesis"
literal "false"

\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "sjoberg2015programming"
literal "false"

\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "sjoberg2015dependently"
literal "false"

\end_inset

 and the Zombie language
\begin_inset Foot
status open

\begin_layout Plain Layout
https://github.com/sweirich/trellys
\end_layout

\end_inset

 it produced.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO type in type as a well wknown shortcut, videos of Andraj, Conner
 MB saying it 
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Implementations
\end_layout

\begin_layout Standard
Several programming language implementations support this combination of
 features (though none prove type soundness).
 Pebble
\begin_inset CommandInset citation
LatexCommand cite
key "10.1007/3-540-13346-1_1"
literal "false"

\end_inset

 was a very early language with dependent types, though conversion did not
 associate alpha equivalent types 
\begin_inset Foot
status open

\begin_layout Plain Layout
according to 
\begin_inset CommandInset citation
LatexCommand cite
key "Reinhold89typecheckingis"
literal "false"

\end_inset


\end_layout

\end_inset

.
 Coquand implemented an early bidirectional algorithm to type-check a language
 with Type-in-Type
\begin_inset CommandInset citation
LatexCommand cite
key "COQUAND1996167"
literal "false"

\end_inset

.
 Cayenne 
\begin_inset CommandInset citation
LatexCommand cite
key "10.1145/289423.289451"
literal "false"

\end_inset

 is a Haskell like language that combined dependent types with Type-in-Type,
 data and non-termination.
 Agda supports general recursion and type-in-type with compiler flags.
 Idris supports similar 
\begin_inset Quotes eld
\end_inset

unsafe
\begin_inset Quotes erd
\end_inset

 features.
\end_layout

\begin_layout Subsection
Other Dependent Type Systems
\end_layout

\begin_layout Standard
There are many flavors of dependent type systems that are similar in spirt
 to the language presented here, but maintain logical soundness at the expense
 of computation.
 
\end_layout

\begin_layout Standard
The Calculus of Constructions (CC, CoC)
\begin_inset CommandInset citation
LatexCommand cite
key "10.1016/0890-5401(88)90005-3"
literal "false"

\end_inset

 is one of the first minimal dependent type systems.
 It contains shockingly few rules, but can express a wide variety of constructio
ns via parametric encodings.
 The systems does not allow type in type, instead type
\begin_inset Foot
status open

\begin_layout Plain Layout
sometimes called 
\begin_inset Quotes eld
\end_inset

prop
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset

 lives in a larger universe 
\begin_inset Formula $\star:\Square$
\end_inset

, where 
\begin_inset Formula $\Square$
\end_inset

 is not considered a type.
 Even though the Calculus of Constructions does not allow type-in-type is
 it is still 
\series bold
impredicative 
\series default
in the sense that function types can quantify over 
\begin_inset Formula $\star$
\end_inset

 while still being int 
\begin_inset Formula $\star$
\end_inset

.
 For instance, the polymorphic identity 
\begin_inset Formula $(X:\star)\rightarrow X\rightarrow X$
\end_inset

 has type 
\begin_inset Formula $\star$
\end_inset

 so the polymorphic identity can be applied to itself.
 From the perspective of the surface language this impredictivity is modest,
 but still causes issues in the presence of classical logical assumptions.
 Many of the examples form this chapter are adapted from examples that appeared
 along with the Calculus of Constructions.
\end_layout

\begin_layout Standard
Several other systems were developed that directly extended or modify the
 Calculus of Constructions.
 The Extended Calculus of Constructions (ECC)
\begin_inset CommandInset citation
LatexCommand cite
key "luo1990extended,luo1994computation"
literal "false"

\end_inset

, extends the calculus of constructions with a predicative hierarchy of
 universes and dependent pair types.
 The Implicit Calculus of Constructions (ICC)
\begin_inset CommandInset citation
LatexCommand cite
key "10.1007/3-540-45413-6_27,10.1007/978-3-540-78499-9_26"
literal "false"

\end_inset

 presents an extrinsic typing system
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Sometimes called 
\begin_inset Quotes eld
\end_inset

Curry-style
\begin_inset Quotes erd
\end_inset

, in contrast to intrinsic systems which are sometimes called 
\begin_inset Quotes eld
\end_inset

Church-style
\begin_inset Quotes erd
\end_inset

.
\end_layout

\end_inset

, unlike the Type Assignment System presented in this chapter, the Implicit
 Calculus of Constructions allows implicit qualification over (also a hierarchy
 of universes, and a universe of 
\begin_inset Quotes eld
\end_inset

sets
\begin_inset Quotes erd
\end_inset

).
 Other extensions to the Calculus of Constructions that are primarily concerned
 with data (UCC, CIC) will be reviewed in chapter 4.
\end_layout

\begin_layout Standard
The lambda cube is a system fo viewing 8 typed lambda caluli in relation
 to each other.
 Presuming terms should always depend on terms, there are 3 additional dimension
s of dependency: term depending on types, types dependent on types, and
 types depending on terms.
 The simply typed lambda calculus has only term dependency.
 System F allows Types to depend on types.
 The Calculus of Constructions has all forms of dependency
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Recommended reading Chapter 14 
\begin_inset CommandInset citation
LatexCommand cite
key "sorensen2006lectures"
literal "false"

\end_inset


\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
Pure Type Systems(PTS) generalize the lambda cube to allow any number of
 type universe with any forms of dependency.
 Notably this includes the system with1 type universe where type-in-type.
 Universe hierarchies can also be embedded in a PTS.
 The system described in this chapter is almost a PTS, except that it contains
 unrestricted recursion and the method of type annotation is different.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO bresumably Barndrct was the first one to put it in a cube
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO citations for PTS: (Terlouw, 1989; Berardi, 1988; Barendregt, 1991,
 1992; Jutting, McKinna, and Pollack, 1994; McKinna and Pollack, 1993; Pollack,
 1994).
 Acording to TAPL
\end_layout

\end_inset


\end_layout

\begin_layout Standard
As previously mentioned Martin Lof Type Theory (MTLL) 
\begin_inset CommandInset citation
LatexCommand cite
key "Martin-Lof-1972"
literal "false"

\end_inset

 is one of the oldest frameworks for dependent type systems.
 MTLL designed to be open, so that new constructs can be added with the
 appropriate introduction elimination and typing rules.
 The base system comes with a predicative hierarchy of universes, and at
 least dependently typed functions and a propositional equality type.
 The system has two flavors characterized by it's handling of definitional
 equality: if types are only identified by convertibility (as ever system
 described so far) it is called Intentional Type Theory (ITT).
 If the system allows proofs of equality to associate types, it is called
 Extensional Type Theory.
 Since MTLL is open ended the Calculus of Constructions can be added to
 it as a subsystem
\begin_inset CommandInset citation
LatexCommand cite
key "aspinall2004dependent,hofmann1997extensional"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO go back to Russle?
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO sloving universe constraints
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% avoid data heave presentations (LIKE UTT, CIC) until CH4
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% TODO read through the inro of https://link.springer.com/book/10.1007/978-1-4471-0
963-1#toc when was it published? what is the relation to his thesis? Is
 chapter 1 https://www.tcs.ifi.lmu.de/mitarbeiter/martin-hofmann/pdfs/syntaxandseman
ticsof-dependenttypes.pdf worth skiming theough eiterh way 
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintCited"
bibfiles "/Users/stephaniesavir/thesis/bibliography/dtest"
options "alpha"

\end_inset


\end_layout

\begin_layout Section
TODO
\end_layout

\begin_layout Itemize
remove location date from this section entirely!
\end_layout

\begin_layout Itemize
fully esperate ctx well formedness judgments
\end_layout

\begin_layout Itemize
include references from https://www.lix.polytechnique.fr/~vsiles/papers/PTSATR.pdf
\end_layout

\begin_layout Itemize
discuss 
\end_layout

\begin_deeper
\begin_layout Itemize
g : (f : nat -> bool) -> (fpr : (x :Nat -> IsEven x -> f x = Bool) -> Bool
\end_layout

\begin_layout Itemize
g f _ = f 2
\end_layout

\end_deeper
\begin_layout Itemize
in the presence of non terminating proof functions
\end_layout

\begin_deeper
\begin_layout Itemize
g : (n : Nat) -> (fpn : (x : IsEven n) -> Bool
\end_layout

\begin_layout Itemize
g f _ = f 2
\end_layout

\end_deeper
\begin_layout Itemize
example of non-terminating functions being equal
\end_layout

\begin_layout Itemize
what is the deal with bidirecitonal type checking?!?!
\end_layout

\begin_layout Itemize
caveat about unsupported features
\end_layout

\begin_layout Itemize
go through previous stack overflow questions to remindmyself about past
 confusion.
\end_layout

\begin_layout Itemize
make usre implementation is smooth around this
\end_layout

\begin_layout Itemize
talk about non-terminaiton
\end_layout

\begin_layout Itemize
write up style guide
\end_layout

\begin_layout Section
unused
\end_layout

\begin_layout Standard
Triangle Property
\end_layout

\begin_layout Standard
\begin_inset Formula $\ensuremath{\forall{\color{red}m},{\color{red}m'}.\:{\color{red}m\Rrightarrow m'}\:\rightarrow\:{\color{red}m}{\color{blue}\Rrightarrow max\left(m\right)}\:\wedge\:{\color{red}m'}{\color{blue}\Rrightarrow max\left(m\right)}}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzcd}
\end_layout

\begin_layout Plain Layout


\backslash
mathbin{
\backslash
color{red}m} 
\backslash
tarrow[red]{r} 
\backslash
tarrow[blue]{d} & 
\backslash
mathbin{
\backslash
color{red}m'} 
\backslash
tarrow[blue]{ld} 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
mathbin{
\backslash
color{blue}max(m)}                  &              
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzcd}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $\forall{\color{red}m},{\color{red}m'},{\color{red}n}.\:{\color{red}m\Rrightarrow m'}\:\wedge\:{\color{red}m\Rrightarrow_{\ast}n}\:\rightarrow\:\exists{\color{blue}n'}.\:{\color{red}m'}{\color{blue}\Rrightarrow_{\ast}n'}\:\wedge\:{\color{red}n}{\color{blue}\Rrightarrow n'}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzcd}
\end_layout

\begin_layout Plain Layout

% TODO look into proper subscripting of arrow heads
\end_layout

\begin_layout Plain Layout

              & {
\backslash
color{red}m} 
\backslash
tarrow[red]{rd}[label={[pos=1,inner sep=0,outer sep=0]0:${
\backslash
ast}$}]{} 
\backslash
tarrow[red]{ld} &              
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

{
\backslash
color{red}m'}  
\backslash
tarrow[blue]{rd}[label={[pos=1,inner sep=0,outer sep=0]0:${
\backslash
ast}$}]{} &                         & {
\backslash
color{red}m} 
\backslash
tarrow[blue]{ld} 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

              & {
\backslash
color{blue}m'}                      &                              
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzcd}
\end_layout

\end_inset


\end_layout

\end_body
\end_document
